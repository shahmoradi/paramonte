<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="">
<meta name="keywords" content=" multivariate Gaussian normal MVN example sampling ParaDRAM Fortran">
<title>Sampling a Multivariate Normal (MVN) distribution | ParaMonte: Parallel Monte Carlo Library</title>
<link rel="stylesheet" href="https://www.cdslab.org/paramonte/generic/1/css/prismOkaidia.css">
<script src="https://www.cdslab.org/paramonte/generic/1/js/prismOkaidia.js"></script>
<!--
<link rel="stylesheet" href="https://www.cdslab.org/paramonte/generic/1/css/syntax.css">
-->
<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" type="text/css" href="https://www.cdslab.org/paramonte/generic/1/css/bootstrap.min.css">



<link rel="stylesheet" href="https://www.cdslab.org/paramonte/generic/1/css/customstyles.css">
<link rel="stylesheet" href="https://www.cdslab.org/paramonte/generic/1/css/boxshadowproperties.css">
<!-- most color styles are extracted out to here -->
<link rel="stylesheet" href="https://www.cdslab.org/paramonte/generic/1/css/theme-cdslab.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="https://www.cdslab.org/paramonte/generic/1/js/jquery.navgoco.min.js"></script>
<!-- make sidebar non-accordion -->
<script src="https://www.cdslab.org/paramonte/generic/1/js/lockScrollBarPosition.js"></script>
<!-- make sidebar non-accordion -->
<script type="text/javascript">
    $(document).ready(function() {
        $('.sidenav').navgoco({
              accordion: false,
              caret: '<span class="caret"></span>',
              openClass: 'open',
              save: true,
              cookie: {
                  name: 'navgoco',
                  expires: false,
                  path: '/'
              },
              slide: {
                  duration: 400,
                  easing: 'swing'
              }
          });
    });
</script>
<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<!-- Anchor.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.2.0/anchor.min.js"></script>
<!--
-->
<script src="https://www.cdslab.org/paramonte/generic/1/js/toc.js"></script>
<script src="https://www.cdslab.org/paramonte/generic/1/js/customscripts.js"></script>
<link rel="shortcut icon" href="https://www.cdslab.org/paramonte/generic/1/images/favicon.ico">
<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->
<link rel="alternate" type="application/rss+xml" title="" href="https://www.cdslab.org/paramonte/generic/1/feed.xml">

<script async src="https://www.googletagmanager.com/gtag/js?id=G-J6JB9XNG83"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-J6JB9XNG83');
</script>

    <script>
        $(document).ready(function() {
            // Initialize navgoco with default options
            $("#mysidebar").navgoco({
                caretHtml: '',
                accordion: true,
                openClass: 'active', // open
                save: false, // leave false or nav highlighting doesn't work right
                cookie: {
                    name: 'navgoco',
                    expires: false,
                    path: '/'
                },
                slide: {
                    duration: 400,
                    easing: 'swing'
                }
            });
            $("#collapseAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', false);
            });
            $("#expandAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', true);
            });
        });
    </script>
    <script>
        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        })
    </script>
    <script>
        $(document).ready(function() {
            $("#tg-sb-link").click(function() {
                $("#tg-sb-sidebar").toggle();
                $("#tg-sb-content").toggleClass('col-md-9');
                $("#tg-sb-content").toggleClass('col-md-12');
                $("#tg-sb-icon").toggleClass('fa-toggle-on');
                $("#tg-sb-icon").toggleClass('fa-toggle-off');
            });
        });
    </script>
    
    </head>
    <body>
        <!-- Navigation -->
<nav class="navbar navbar-inverse navbar-static-top">
    <div id="sticky" class="container topnavlinks">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="fa fa-book fa-lg navbar-brand" href="https://www.cdslab.org/paramonte/generic/1/index.html">&nbsp;<span class="projectTitle"> ParaMonte 1</span></a>
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <!-- toggle sidebar button -->
                <li><a id="tg-sb-link" href="#"><i id="tg-sb-icon" class="fa fa-toggle-on"></i> Nav</a></li>
                <!-- entries without drop-downs appear here -->
                
                
                
                    
                        
                            <li><a href="https://github.com/cdslaborg/paramonte" target="_blank" rel="noopener">GitHub</a></li>
                        
                    
                        
                            <li><a href="https://www.mathworks.com/matlabcentral/fileexchange/78946-paramonte" target="_blank" rel="noopener">MathWorks</a></li>
                        
                    
                        
                            <li><a href="https://pypi.org/project/paramonte/" target="_blank" rel="noopener">PyPI</a></li>
                        
                    
                
                <!-- entries with drop-downs appear here -->
                <!-- conditional logic to control which topnav appears for the audience defined in the configuration file.-->
                
                    
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">CDSLab<b class="caret"></b></a>
                            <ul class="dropdown-menu">
                                
                                
                                <li><a href="https://www.cdslab.org/#about" target="_blank" rel="noopener">About</a></li>
                                
                                
                                
                                <li><a href="https://www.cdslab.org/people" target="_blank" rel="noopener">People</a></li>
                                
                                
                                
                                <li><a href="https://www.cdslab.org/research" target="_blank" rel="noopener">Research</a></li>
                                
                                
                            </ul>
                        </li>
                    
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">Tutorials<b class="caret"></b></a>
                            <ul class="dropdown-menu">
                                
                                
                                <li><a href="https://www.cdslab.org/matlab/" target="_blank" rel="noopener">MATLAB Programming</a></li>
                                
                                
                                
                                <li><a href="https://www.cdslab.org/python/" target="_blank" rel="noopener">Python Programming</a></li>
                                
                                
                            </ul>
                        </li>
                    
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">History<b class="caret"></b></a>
                            <ul class="dropdown-menu">
                                
                                
                                <li><a href="https://www.cdslab.org/paramonte/generic/latest" target="_blank" rel="noopener">latest</a></li>
                                
                                
                                
                                <li><a href="https://www.cdslab.org/paramonte/generic/1" target="_blank" rel="noopener">version 1</a></li>
                                
                                
                            </ul>
                        </li>
                    
                
                
                <!--comment out this block if you want to hide search-->
                <li>
                    <!--start search-->
                    <div id="search-demo-container">
                        <input type="text" id="search-input" placeholder="keyword search...">
                        <ul id="results-container"></ul>
                    </div>
                    <script src="https://www.cdslab.org/paramonte/generic/1/js/jekyll-search.js" type="text/javascript"></script>
                    <script type="text/javascript">
                            SimpleJekyllSearch.init({
                                searchInput: document.getElementById('search-input'),
                                resultsContainer: document.getElementById('results-container'),
                                dataSource: "https://www.cdslab.org/paramonte/generic/1/search.json",
                                searchResultTemplate: '<li><a href="https://www.cdslab.org/paramonte/generic/1{url}" title="Sampling a Multivariate Normal (MVN) distribution">{title}</a></li>',
                    noResultsText: 'No results found.',
                            limit: 10,
                            fuzzy: true,
                    })
                    </script>
                    <!--end search-->
                </li>
            </ul>
        </div>
        </div>
        <!-- /.container -->
</nav>

        <!-- Page Content -->
        <div class="container">
            <div id="main">
                <!-- Content Row -->
                <div class="row">
                    
                    
                        <!-- Sidebar Column -->
                        <div class="col-md-3" id="tg-sb-sidebar">
                            
<ul id="mysidebar" class="sidenav">
    <!--
    -->
    <li class="sidebarTitle"> </li>
    
        
            
                <li>
                    <a title="Overview" href="#"><b>Overview</b></a>
                    <ul>
                        
                                
                                    
                                        <li><a title="Preface" href="https://www.cdslab.org/paramonte/generic/1/overview/preface/">Preface</a></li>
                                    
                                    
                                
                        
                                
                                    
                                        <li><a title="ParaMonte kernel release notes" href="https://www.cdslab.org/paramonte/generic/1/overview/paramonte-kernel-release-notes/">ParaMonte kernel release notes</a></li>
                                    
                                    
                                
                        
                                
                                    
                                        <li><a title="ParaMonte MATLAB release notes" href="https://www.cdslab.org/paramonte/generic/1/overview/paramonte-matlab-release-notes/">ParaMonte MATLAB release notes</a></li>
                                    
                                    
                                
                        
                                
                                    
                                        <li><a title="ParaMonte Python release notes" href="https://www.cdslab.org/paramonte/generic/1/overview/paramonte-python-release-notes/">ParaMonte Python release notes</a></li>
                                    
                                    
                                
                        
                    </ul>
                </li>
            
        
            
                <li>
                    <a title="Installation" href="#"><b>Installation</b></a>
                    <ul>
                        
                                
                                    
                                        <li><a title="ParaMonte pre-installation notes" href="https://www.cdslab.org/paramonte/generic/1/installation/readme/">ParaMonte pre-installation notes</a></li>
                                    
                                    
                                
                        
                                
                                    
                                        <li><a title="ParaMonte C/C++/Fortran - Windows" href="https://www.cdslab.org/paramonte/generic/1/installation/windows/">ParaMonte C/C++/Fortran - Windows</a></li>
                                    
                                    
                                
                        
                                
                                    
                                        <li><a title="ParaMonte C/C++/Fortran - macOS" href="https://www.cdslab.org/paramonte/generic/1/installation/macos/">ParaMonte C/C++/Fortran - macOS</a></li>
                                    
                                    
                                
                        
                                
                                    
                                        <li><a title="ParaMonte C/C++/Fortran - Linux" href="https://www.cdslab.org/paramonte/generic/1/installation/linux/">ParaMonte C/C++/Fortran - Linux</a></li>
                                    
                                    
                                
                        
                                
                                    
                                        <li><a title="ParaMonte MATLAB" href="https://www.cdslab.org/paramonte/generic/1/installation/matlab/">ParaMonte MATLAB</a></li>
                                    
                                    
                                
                        
                                
                                    
                                        <li><a title="ParaMonte Python" href="https://www.cdslab.org/paramonte/generic/1/installation/python/">ParaMonte Python</a></li>
                                    
                                    
                                
                        
                    </ul>
                </li>
            
        
            
                <li>
                    <a title="API documentation" href="#"><b>API documentation</b></a>
                    <ul>
                        
                                
                                    
                                        <li><a title="ParaMonte Python API" href="https://www.cdslab.org/paramonte/generic/1/api/python/autoapi/paramonte/">ParaMonte Python API</a></li>
                                    
                                    
                                
                        
                                
                                    
                                        <li><a title="ParaMonte MATLAB API" href="https://www.cdslab.org/paramonte/generic/1/api/matlab/">ParaMonte MATLAB API</a></li>
                                    
                                    
                                
                        
                    </ul>
                </li>
            
        
            
                <li>
                    <a title="Usage - ParaDRAM sampler" href="#"><b>Usage - ParaDRAM sampler</b></a>
                    <ul>
                        
                                
                                    
                                        <li><a title="ParaDRAM quick start" href="https://www.cdslab.org/paramonte/generic/1/usage/paradram/interface/">ParaDRAM quick start</a></li>
                                    
                                    
                                
                        
                                
                                    
                                        <li><a title="ParaDRAM optional input file" href="https://www.cdslab.org/paramonte/generic/1/usage/paradram/input/">ParaDRAM optional input file</a></li>
                                    
                                    
                                
                        
                                
                                    
                                        <li><a title="ParaDRAM simulation specifications" href="https://www.cdslab.org/paramonte/generic/1/usage/paradram/specifications/">ParaDRAM simulation specifications</a></li>
                                    
                                    
                                
                        
                                
                                    
                                        <li><a title="ParaDRAM simulation output files" href="https://www.cdslab.org/paramonte/generic/1/usage/paradram/output/">ParaDRAM simulation output files</a></li>
                                    
                                    
                                
                        
                                
                                    
                                        <li><a title="ParaDRAM simulation restart" href="https://www.cdslab.org/paramonte/generic/1/usage/paradram/restart/">ParaDRAM simulation restart</a></li>
                                    
                                    
                                
                        
                                
                                    
                                        <li><a title="ParaDRAM parallelization tips" href="https://www.cdslab.org/paramonte/generic/1/usage/paradram/parallelization/">ParaDRAM parallelization tips</a></li>
                                    
                                    
                                
                        
                    </ul>
                </li>
            
        
            
                <li>
                    <a title="Building ParaMonte application" href="#"><b>Building ParaMonte application</b></a>
                    <ul>
                        
                                
                                    
                                        <li><a title="Building ParaMonte C application" href="https://www.cdslab.org/paramonte/generic/1/build/c/">Building ParaMonte C application</a></li>
                                    
                                    
                                
                        
                                
                                    
                                        <li><a title="Building ParaMonte C++ application" href="https://www.cdslab.org/paramonte/generic/1/build/cpp/">Building ParaMonte C++ application</a></li>
                                    
                                    
                                
                        
                                
                                    
                                        <li><a title="Building ParaMonte Fortran application" href="https://www.cdslab.org/paramonte/generic/1/build/fortran/">Building ParaMonte Fortran application</a></li>
                                    
                                    
                                
                        
                    </ul>
                </li>
            
        
            
                <li>
                    <a title="Running ParaMonte application" href="#"><b>Running ParaMonte application</b></a>
                    <ul>
                        
                                
                                    
                                        <li><a title="Running C/C++/Fortran application" href="https://www.cdslab.org/paramonte/generic/1/run/default/">Running C/C++/Fortran application</a></li>
                                    
                                    
                                
                        
                                
                                    
                                        <li><a title="Running MATLAB application" href="https://www.cdslab.org/paramonte/generic/1/run/matlab/">Running MATLAB application</a></li>
                                    
                                    
                                
                        
                                
                                    
                                        <li><a title="Running Python application" href="https://www.cdslab.org/paramonte/generic/1/run/python/">Running Python application</a></li>
                                    
                                    
                                
                        
                    </ul>
                </li>
            
        
            
                <li>
                    <a title="C examples" href="#"><b>C examples</b></a>
                    <ul>
                        
                                
                                    
                                        <li><a title="Sampling a Multivariate Normal distribution" href="https://www.cdslab.org/paramonte/generic/1/examples/c/mvn/">Sampling a Multivariate Normal distribution</a></li>
                                    
                                    
                                
                        
                    </ul>
                </li>
            
        
            
                <li>
                    <a title="C++ examples" href="#"><b>C++ examples</b></a>
                    <ul>
                        
                                
                                    
                                        <li><a title="Sampling a Multivariate Normal distribution" href="https://www.cdslab.org/paramonte/generic/1/examples/cpp/mvn/">Sampling a Multivariate Normal distribution</a></li>
                                    
                                    
                                
                        
                    </ul>
                </li>
            
        
            
                <li>
                    <a title="Fortran examples" href="#"><b>Fortran examples</b></a>
                    <ul>
                        
                                
                                    
                                        <li class="active"><a title="Sampling a Multivariate Normal distribution" href="https://www.cdslab.org/paramonte/generic/1/examples/fortran/mvn/">Sampling a Multivariate Normal distribution</a></li>
                                    
                                    
                                
                        
                    </ul>
                </li>
            
        
            
                <li>
                    <a title="MATLAB examples" href="#"><b>MATLAB examples</b></a>
                    <ul>
                        
                                
                                    
                                        <li><a title="MATLAB Live Scripts" href="https://www.cdslab.org/paramonte/generic/1/examples/matlab/mlx/">MATLAB Live Scripts</a></li>
                                    
                                    
                                
                        
                                
                                    
                                        <li><a title="Post-processing existing simulations" href="https://www.cdslab.org/paramonte/generic/1/examples/matlab/postprocess/">Post-processing existing simulations</a></li>
                                    
                                    
                                
                        
                    </ul>
                </li>
            
        
            
                <li>
                    <a title="Python examples" href="#"><b>Python examples</b></a>
                    <ul>
                        
                                
                                    
                                        <li><a title="Jupyter Notebooks" href="https://www.cdslab.org/paramonte/generic/1/examples/python/jupyter/">Jupyter Notebooks</a></li>
                                    
                                    
                                
                        
                                
                                    
                                        <li><a title="Post-processing existing simulations" href="https://www.cdslab.org/paramonte/generic/1/examples/python/postprocess/">Post-processing existing simulations</a></li>
                                    
                                    
                                
                        
                    </ul>
                </li>
            
        
            
                <li>
                    <a title="Code Coverage Reports" href="#"><b>Code Coverage Reports</b></a>
                    <ul>
                        
                                
                                    
                                        <li><a title="Guidelines" href="https://www.cdslab.org/paramonte/generic/1/codecov/">Guidelines</a></li>
                                    
                                    
                                
                        
                    </ul>
                </li>
            
        
            
                <li>
                    <a title="Contributing to ParaMonte" href="#"><b>Contributing to ParaMonte</b></a>
                    <ul>
                        
                                
                                    
                                        <li><a title="Reporting defects" href="https://www.cdslab.org/paramonte/generic/1/contributing/defects">Reporting defects</a></li>
                                    
                                    
                                
                        
                                
                                    
                                        <li><a title="Requesting enhancements" href="https://www.cdslab.org/paramonte/generic/1/contributing/enhancements">Requesting enhancements</a></li>
                                    
                                    
                                
                        
                                
                                    
                                        <li><a title="Development guidelines - general" href="https://www.cdslab.org/paramonte/generic/1/contributing/development/general/">Development guidelines - general</a></li>
                                    
                                    
                                
                        
                                
                                    
                                        <li><a title="Development guidelines - kernel" href="https://www.cdslab.org/paramonte/generic/1/contributing/development/kernel/">Development guidelines - kernel</a></li>
                                    
                                    
                                
                        
                    </ul>
                </li>
            
        
            
                <li>
                    <a title="Troubleshooting" href="#"><b>Troubleshooting</b></a>
                    <ul>
                        
                                
                                    
                                        <li><a title="Enhancement-requests and bug-reports" href="https://www.cdslab.org/paramonte/generic/1/troubleshooting/issues/">Enhancement-requests and bug-reports</a></li>
                                    
                                    
                                
                        
                                
                                    
                                        <li><a title="-bash: Permission denied" href="https://www.cdslab.org/paramonte/generic/1/troubleshooting/bash-permission-denied/">-bash: Permission denied</a></li>
                                    
                                    
                                
                        
                                
                                    
                                        <li><a title="bash: matlab: command not found" href="https://www.cdslab.org/paramonte/generic/1/troubleshooting/bash-matlab-command-not-found/">bash: matlab: command not found</a></li>
                                    
                                    
                                
                        
                                
                                    
                                        <li><a title="catastrophic error: cannot open source file" href="https://www.cdslab.org/paramonte/generic/1/troubleshooting/catastrophic-error-cannot-open-source-file/">catastrophic error: cannot open source file</a></li>
                                    
                                    
                                
                        
                                
                                    
                                        <li><a title="Catastrophic error: could not set locale" href="https://www.cdslab.org/paramonte/generic/1/troubleshooting/catastrophic-error-could-not-set-locale/">Catastrophic error: could not set locale</a></li>
                                    
                                    
                                
                        
                                
                                    
                                        <li><a title="xcrun: error: unable to find utility "clang"" href="https://www.cdslab.org/paramonte/generic/1/troubleshooting/xcrun-error-unable-to-find-utility-clang/">xcrun: error: unable to find utility "clang"</a></li>
                                    
                                    
                                
                        
                                
                                    
                                        <li><a title="changing directory on Windows CMD" href="https://www.cdslab.org/paramonte/generic/1/troubleshooting/windows-drive-change/">changing directory on Windows CMD</a></li>
                                    
                                    
                                
                        
                                
                                    
                                        <li><a title="error while loading shared libraries" href="https://www.cdslab.org/paramonte/generic/1/troubleshooting/error-while-loading-shared-libraries/">error while loading shared libraries</a></li>
                                    
                                    
                                
                        
                                
                                    
                                        <li><a title="finding the MPI libraries on Windows" href="https://www.cdslab.org/paramonte/generic/1/troubleshooting/finding-mpi-libraries-on-windows/">finding the MPI libraries on Windows</a></li>
                                    
                                    
                                
                        
                                
                                    
                                        <li><a title="Fortran runtime error: End of file" href="https://www.cdslab.org/paramonte/generic/1/troubleshooting/fortran-runtime-error-end-of-file/">Fortran runtime error: End of file</a></li>
                                    
                                    
                                
                        
                                
                                    
                                        <li><a title="libgfortran not found" href="https://www.cdslab.org/paramonte/generic/1/troubleshooting/libgfortran-not-found/">libgfortran not found</a></li>
                                    
                                    
                                
                        
                                
                                    
                                        <li><a title="macOS: developer cannot be verified" href="https://www.cdslab.org/paramonte/generic/1/troubleshooting/macos-developer-cannot-be-verified/">macOS: developer cannot be verified</a></li>
                                    
                                    
                                
                        
                                
                                    
                                        <li><a title="Python: could not find module" href="https://www.cdslab.org/paramonte/generic/1/troubleshooting/python-could-not-find-module/">Python: could not find module</a></li>
                                    
                                    
                                
                        
                                
                                    
                                        <li><a title="Python: module object is not callable" href="https://www.cdslab.org/paramonte/generic/1/troubleshooting/python-module-object-is-not-callable/">Python: module object is not callable</a></li>
                                    
                                    
                                
                        
                                
                                    
                                        <li><a title="Python: segmentation-fault error" href="https://www.cdslab.org/paramonte/generic/1/troubleshooting/python-segmentation-fault/">Python: segmentation-fault error</a></li>
                                    
                                    
                                
                        
                    </ul>
                </li>
            
        
    
    <!-- if you aren't using the accordion, uncomment this block:
    -->
    <p class="external">
        <a href="#" id="collapseAll">Collapse All</a> | <a href="#" id="expandAll">Expand All</a>
    </p>
</ul>
<!--
This highlights the active parent class in the navgoco sidebar. 
This is critical so that the parent expands when you're viewing a page.
This must appear below the sidebar code above.
Otherwise, if placed inside customscripts.js,
the script runs before the sidebar code runs and the class never gets inserted.
-->
<script>$("li.active").parents('li').toggleClass("active");</script>

                        </div>
                        
                    
                    <!-- Content Column -->
                    <div class="col-md-9" id="tg-sb-content">
                        <div class="post-header">
   <h1 class="post-title-main">Sampling a Multivariate Normal (MVN) distribution</h1>
</div>

<div class="post-content">
    
    
    
        <br>
        
<script>
    $( document ).ready(function() {
        // Handler for .ready() called.
        $('#toc').toc({ minimumHeaders: 0 
                      , listType: 'ol'
                      , showSpeed: 0
                      , headers: 'h2,h3,h4,h5,h6'
        });
        /* the following offset helps account for the space taken up by the floating toolbar. */
        $('#toc').on('click', 'a', function() {
            var target = $(this.getAttribute('href')), scroll_target = target.offset().top$(window).scrollTop(scroll_target - 10);
            return false
        })
    });
</script>

<div id="toc"></div>

    
    
    
<div id="toc"></div>

<h2 id="the-mathematical-objective-function">The mathematical objective function</h2>

<p>Suppose we want to sample random vectors</p>

\[\mathbf{x}=[x_1,x_2,x_3,x_4] ~~,\]

<p>from a 4-dimensional <a href="https://en.wikipedia.org/wiki/Multivariate_normal_distribution" target="_blank">Multivariate Normal (MVN) Probability Density Function (PDF)</a>,</p>

\[\mathrm{PDF}_\mathrm{MVN} \equiv \pi ( \mathbf{x} ~|~ \mu, \Sigma) = 
(2\pi)^{-\frac{k}{2}}
\sqrt{|\Sigma|}
\exp\bigg( -\frac{1}{2} (\mathbf{x}-\mu)^\mathrm{T}\Sigma^{-1}(\mathbf{x}-\mu) \bigg) ~~,\]

<p>that has a mean vector,</p>

\[\mu = [0,0,0,0]\]

<p>with a covariance matrix,</p>

\[\Sigma = 
\begin{bmatrix}
1.0 &amp; 0.5 &amp; 0.5 &amp; 0.5 \\
0.5 &amp; 1.0 &amp; 0.5 &amp; 0.5 \\
0.5 &amp; 0.5 &amp; 1.0 &amp; 0.5 \\
0.5 &amp; 0.5 &amp; 0.5 &amp; 1.0 
\end{bmatrix}\]

<p>This will serve as our mathematical objective function. Clearly, all of the four dimensions of this MVN are correlated with each other with a Pearson’s correlation coefficient of $0.5$.</p>

<h3 id="working-with-the-natural-logarithm-of-the-objective-function">Working with the natural logarithm of the objective function</h3>

<p>In general, since probabilities are often tiny numbers, we’d want to always work with their natural logarithms in the world of computers to avoid unwanted overflow or underflow of numbers, which can crash our simulations. To highlight the importance of taking the natural logarithms of all input objective functions to the ParaMonte routines, we always name them like <code>getLogFunc()</code>.</p>

<div class="alert alert-warning" role="alert"><i class="fa fa-warning"></i> <b>Important:</b> 
All ParaMonte routines assume that the user-provided objective functions return the natural logarithms of the actual values of the objective functions.
</div>

<h2 id="implementing-the-objective-function-in-fortran">Implementing the objective function in Fortran</h2>

<p>Here is a minimalistic implementation of the 4-D multivariate normal distribution objective function in Fortran, which can also be downloaded as <a href="https://raw.githubusercontent.com/cdslaborg/paramonte/main/example/mvn/Fortran/logfunc.f90" target="_blank">logfunc.f90</a>.</p>

<div class="language-fortran highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">!%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span><span class="w">
</span><span class="c1">!%  </span><span class="w">
</span><span class="c1">!%  Description:</span><span class="w">
</span><span class="c1">!%      +   Return the natural logarithm of an ndim-dimensional Multivariate Normal (MVN) </span><span class="w">
</span><span class="c1">!%          probability density function (PDF) with the Mean and Covariance Matrix as defined below.</span><span class="w">
</span><span class="c1">!%          Reference: https://en.wikipedia.org/wiki/Multivariate_normal_distribution</span><span class="w">
</span><span class="c1">!%  Input:</span><span class="w">
</span><span class="c1">!%      +   ndim:       The number of dimensions of the domain of the objective function.</span><span class="w">
</span><span class="c1">!%      +   point:      The input 64-bit real-valued vector of length ndim, </span><span class="w">
</span><span class="c1">!%                      at which the natural logarithm of objective function is computed.</span><span class="w">
</span><span class="c1">!%  Output:</span><span class="w">
</span><span class="c1">!%      +   logFunc:    A 64-bit real scalar number representing the natural logarithm of the objective function.</span><span class="w">
</span><span class="c1">!%  Author:</span><span class="w">
</span><span class="c1">!%      +   Computational Data Science Lab, Monday 9:03 AM, May 16 2016, ICES, UT Austin</span><span class="w">
</span><span class="c1">!%  Visit:</span><span class="w">
</span><span class="c1">!%      +   https://www.cdslab.org/paramonte</span><span class="w">
</span><span class="c1">!%</span><span class="w">
</span><span class="c1">!%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span><span class="w">

</span><span class="k">module</span><span class="w"> </span><span class="n">LogFunc_mod</span><span class="w">

    </span><span class="k">use</span><span class="w"> </span><span class="n">paramonte</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">IK</span><span class="p">,</span><span class="w"> </span><span class="n">RK</span><span class="w">

    </span><span class="k">implicit</span><span class="w"> </span><span class="k">none</span><span class="w">

    </span><span class="c1">! The number of dimensions of the domain of the objective function</span><span class="w">

    </span><span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w">  </span><span class="p">::</span><span class="w"> </span><span class="n">NDIM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4_IK</span><span class="w">

    </span><span class="c1">! The mean vector of the MVN</span><span class="w">

    </span><span class="kt">real</span><span class="p">(</span><span class="n">RK</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w">     </span><span class="p">::</span><span class="w"> </span><span class="n">MEAN</span><span class="p">(</span><span class="n">NDIM</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">0._RK</span><span class="p">,</span><span class="w"> </span><span class="mf">0._RK</span><span class="p">,</span><span class="w"> </span><span class="mf">0._RK</span><span class="p">,</span><span class="w"> </span><span class="mf">0._RK</span><span class="p">]</span><span class="w">

    </span><span class="c1">! The coefficient of the Multivariate Normal Distribution: log(1/sqrt(2*Pi)^ndim)</span><span class="w">

    </span><span class="kt">real</span><span class="p">(</span><span class="n">RK</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w">     </span><span class="p">::</span><span class="w"> </span><span class="n">LOG_INVERSE_SQRT_TWO_PI</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">log</span><span class="p">(</span><span class="mf">1._RK</span><span class="p">/</span><span class="nb">sqrt</span><span class="p">(</span><span class="mf">2._RK</span><span class="o">*</span><span class="nb">acos</span><span class="p">(</span><span class="mf">-1._RK</span><span class="p">)))</span><span class="w">

    </span><span class="c1">! The covariance matrix of the MVN</span><span class="w">

    </span><span class="kt">real</span><span class="p">(</span><span class="n">RK</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w">     </span><span class="p">::</span><span class="w"> </span><span class="n">COVMAT</span><span class="p">(</span><span class="n">NDIM</span><span class="p">,</span><span class="n">NDIM</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="nb">reshape</span><span class="p">([</span><span class="w"> </span><span class="mf">1.0_RK</span><span class="p">,</span><span class="mf">0.5_RK</span><span class="p">,</span><span class="mf">0.5_RK</span><span class="p">,</span><span class="mf">0.5_RK</span><span class="w"> </span><span class="p">&amp;</span><span class="w">
                                                            </span><span class="p">,</span><span class="w"> </span><span class="mf">0.5_RK</span><span class="p">,</span><span class="mf">1.0_RK</span><span class="p">,</span><span class="mf">0.5_RK</span><span class="p">,</span><span class="mf">0.5_RK</span><span class="w"> </span><span class="p">&amp;</span><span class="w">
                                                            </span><span class="p">,</span><span class="w"> </span><span class="mf">0.5_RK</span><span class="p">,</span><span class="mf">0.5_RK</span><span class="p">,</span><span class="mf">1.0_RK</span><span class="p">,</span><span class="mf">0.5_RK</span><span class="w"> </span><span class="p">&amp;</span><span class="w">
                                                            </span><span class="p">,</span><span class="w"> </span><span class="mf">0.5_RK</span><span class="p">,</span><span class="mf">0.5_RK</span><span class="p">,</span><span class="mf">0.5_RK</span><span class="p">,</span><span class="mf">1.0_RK</span><span class="w"> </span><span class="p">],</span><span class="w"> </span><span class="nb">shape</span><span class="o">=</span><span class="nb">shape</span><span class="p">(</span><span class="n">COVMAT</span><span class="p">))</span><span class="w">

    </span><span class="c1">! The inverse covariance matrix of the MVN</span><span class="w">

    </span><span class="kt">real</span><span class="p">(</span><span class="n">RK</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w">     </span><span class="p">::</span><span class="w"> </span><span class="n">INVCOVMAT</span><span class="p">(</span><span class="n">NDIM</span><span class="p">,</span><span class="n">NDIM</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">reshape</span><span class="p">(</span><span class="w">  </span><span class="p">[</span><span class="w"> </span><span class="mf">+1.6_RK</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.4_RK</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.4_RK</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.4_RK</span><span class="w"> </span><span class="p">&amp;</span><span class="w">
                                                                </span><span class="p">,</span><span class="w"> </span><span class="mf">-0.4_RK</span><span class="p">,</span><span class="w"> </span><span class="mf">+1.6_RK</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.4_RK</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.4_RK</span><span class="w"> </span><span class="p">&amp;</span><span class="w">
                                                                </span><span class="p">,</span><span class="w"> </span><span class="mf">-0.4_RK</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.4_RK</span><span class="p">,</span><span class="w"> </span><span class="mf">+1.6_RK</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.4_RK</span><span class="w"> </span><span class="p">&amp;</span><span class="w">
                                                                </span><span class="p">,</span><span class="w"> </span><span class="mf">-0.4_RK</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.4_RK</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.4_RK</span><span class="p">,</span><span class="w"> </span><span class="mf">+1.6_RK</span><span class="w"> </span><span class="p">],</span><span class="w"> </span><span class="nb">shape</span><span class="o">=</span><span class="nb">shape</span><span class="p">(</span><span class="n">INVCOVMAT</span><span class="p">))</span><span class="w">

    </span><span class="c1">! The logarithm of square root of the determinant of the inverse covariance matrix of the Multivariate Normal Distribution </span><span class="w">

    </span><span class="kt">real</span><span class="p">(</span><span class="n">RK</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w">     </span><span class="p">::</span><span class="w"> </span><span class="n">LOG_SQRT_DET_INV_COV</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.581575404902840_RK</span><span class="w">

    </span><span class="c1">! MVN_COEF</span><span class="w">

    </span><span class="kt">real</span><span class="p">(</span><span class="n">RK</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w">     </span><span class="p">::</span><span class="w"> </span><span class="n">MVN_COEF</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NDIM</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">LOG_INVERSE_SQRT_TWO_PI</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">LOG_SQRT_DET_INV_COV</span><span class="w">

</span><span class="k">contains</span><span class="w">

    </span><span class="k">function</span><span class="w"> </span><span class="n">getLogFunc</span><span class="p">(</span><span class="n">ndim</span><span class="p">,</span><span class="n">Point</span><span class="p">)</span><span class="w"> </span><span class="k">result</span><span class="p">(</span><span class="n">logFunc</span><span class="p">)</span><span class="w">
        </span><span class="c1">! Return the negative natural logarithm of MVN distribution evaluated at the input vector point.</span><span class="w">
        </span><span class="k">implicit</span><span class="w"> </span><span class="k">none</span><span class="w">
        </span><span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="k">in</span><span class="p">)</span><span class="w"> </span><span class="p">::</span><span class="w"> </span><span class="n">ndim</span><span class="w">
        </span><span class="kt">real</span><span class="p">(</span><span class="n">RK</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="k">in</span><span class="p">)</span><span class="w">    </span><span class="p">::</span><span class="w"> </span><span class="n">Point</span><span class="p">(</span><span class="n">ndim</span><span class="p">)</span><span class="w">
        </span><span class="kt">real</span><span class="p">(</span><span class="n">RK</span><span class="p">)</span><span class="w">                </span><span class="p">::</span><span class="w"> </span><span class="n">NormedPoint</span><span class="p">(</span><span class="n">ndim</span><span class="p">)</span><span class="w">
        </span><span class="kt">real</span><span class="p">(</span><span class="n">RK</span><span class="p">)</span><span class="w">                </span><span class="p">::</span><span class="w"> </span><span class="n">logFunc</span><span class="w">
        </span><span class="n">NormedPoint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Point</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">MEAN</span><span class="w">
        </span><span class="n">logFunc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MVN_COEF</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">0.5_RK</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">dot_product</span><span class="p">(</span><span class="n">NormedPoint</span><span class="p">,</span><span class="nb">matmul</span><span class="p">(</span><span class="n">INVCOVMAT</span><span class="p">,</span><span class="n">NormedPoint</span><span class="p">))</span><span class="w"> </span><span class="p">)</span><span class="w">
    </span><span class="k">end</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="n">getLogFunc</span><span class="w">

</span><span class="k">end</span><span class="w"> </span><span class="k">module</span><span class="w"> </span><span class="n">LogFunc_mod</span><span class="w">

</span><span class="c1">!%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span><span class="w">

</span></code></pre></div></div>

<p><br /></p>

<h2 id="calling-the-paramonte-samplers">Calling the ParaMonte samplers</h2>

<p>Suppose we want to randomly sample the above objective function via the <strong>D</strong>elayed-<strong>R</strong>ejection <strong>A</strong>daptive <strong>M</strong>etropolis-Hastings <strong>M</strong>arkov Chain Monte Carlo sampler of ParaMonte (the <strong>ParaDRAM</strong> sampler).</p>

<p>Depending on whether you have already built the ParaMonte library from scratch on your system or you intend to use the prebuilt ParaMonte libraries, as well as the compiler you are using to build your application, there are two interfaces to the ParaDRAM sampler. These two interfaces are separated via the compiler preprocessor flag <code>IS_COMPATIBLE_COMPILER</code> in the <a href="https://raw.githubusercontent.com/cdslaborg/paramonte/main/example/main.f90" target="_blank">main.f90</a> code below,</p>

<div class="language-fortran highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">!%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span><span class="w">
</span><span class="c1">!%  </span><span class="w">
</span><span class="c1">!%  Description:</span><span class="w">
</span><span class="c1">!%      +   Run the Monte Carlo sampler of the ParaMonte library given the input log-target density function `getLogFunc()`.</span><span class="w">
</span><span class="c1">!%  Output:</span><span class="w">
</span><span class="c1">!%      +   The simulation output files.</span><span class="w">
</span><span class="c1">!%  Author:</span><span class="w">
</span><span class="c1">!%      +   Computational Data Science Lab, Monday 9:03 AM, May 16 2016, ICES, UT Austin</span><span class="w">
</span><span class="c1">!%  Visit:</span><span class="w">
</span><span class="c1">!%      +   https://www.cdslab.org/paramonte</span><span class="w">
</span><span class="c1">!%</span><span class="w">
</span><span class="c1">!%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span><span class="w">

</span><span class="c1">!   Keep in mind that Fortran is case-insensitive, except for character values and string values. </span><span class="w">
</span><span class="c1">!   So, feel free to use upper-case or lower-case for the Fortran syntax and entity names.</span><span class="w">
</span><span class="c1">!   The ParaMonte library uses camelCase convention for variable naming.</span><span class="w">

</span><span class="cp">#if defined IS_COMPATIBLE_COMPILER</span><span class="w">

    </span><span class="k">program</span><span class="w"> </span><span class="n">main</span><span class="w">

    </span><span class="c1">! This is the Object-Oriented-Programming (OOP) style interface to the ParaMonte routines.</span><span class="w">
    </span><span class="c1">! This is more flexible but less portable, as its compilation requires the same compiler </span><span class="w">
    </span><span class="c1">! brand and version with which the ParaMonte library has been built.</span><span class="w">

    </span><span class="k">use</span><span class="w"> </span><span class="n">paramonte</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">ParaDRAM</span><span class="p">,</span><span class="w"> </span><span class="n">IK</span><span class="w">
    </span><span class="k">use</span><span class="w"> </span><span class="n">LogFunc_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">getLogFunc</span><span class="p">,</span><span class="w"> </span><span class="n">NDIM</span><span class="w">

    </span><span class="k">implicit</span><span class="w"> </span><span class="k">none</span><span class="w">
    </span><span class="k">type</span><span class="p">(</span><span class="n">ParaDRAM</span><span class="p">)</span><span class="w"> </span><span class="p">::</span><span class="w"> </span><span class="n">pmpd</span><span class="w">

    </span><span class="k">call</span><span class="w"> </span><span class="n">pmpd</span><span class="o">%</span><span class="n">runSampler</span><span class="p">(</span><span class="w"> </span><span class="n">ndim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NDIM</span><span class="w"> </span><span class="p">&amp;</span><span class="w">
                        </span><span class="p">,</span><span class="w"> </span><span class="n">getLogFunc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getLogFunc</span><span class="w"> </span><span class="p">&amp;</span><span class="w">
                        </span><span class="p">,</span><span class="w"> </span><span class="n">inputFile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"./paramonte.in"</span><span class="w"> </span><span class="p">&amp;</span><span class="w">    </span><span class="c1">! this is optional argument</span><span class="w">
                        </span><span class="c1">! You can also specify simulation specifications as input arguments, like </span><span class="w">
                        </span><span class="c1">! the following. This is possible only from the OOP interface to ParaDRAM.</span><span class="w">
                        </span><span class="p">,</span><span class="w"> </span><span class="n">greedyAdaptationCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0_IK</span><span class="w"> </span><span class="p">&amp;</span><span class="w">    </span><span class="c1">! this is optional argument</span><span class="w">
                        </span><span class="p">,</span><span class="w"> </span><span class="n">description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"an example run"</span><span class="w"> </span><span class="p">&amp;</span><span class="w">  </span><span class="c1">! this is optional argument</span><span class="w">
                        </span><span class="c1">! More optional arguments can appear here. </span><span class="w">
                        </span><span class="c1">! See the ParaDRAM routine's list of input arguments.</span><span class="w">
                        </span><span class="p">)</span><span class="w">

    </span><span class="k">end</span><span class="w"> </span><span class="k">program</span><span class="w"> </span><span class="n">main</span><span class="w">

</span><span class="cp">#else</span><span class="w">

    </span><span class="c1">! This is the default simple procedural interface to the ParaMonte routines.</span><span class="w">
    </span><span class="c1">! The first two arguments to the sampler routines are mandatory.</span><span class="w">
    </span><span class="c1">! The inputFile argument is optional.</span><span class="w">

    </span><span class="k">program</span><span class="w"> </span><span class="n">main</span><span class="w">

    </span><span class="k">use</span><span class="w"> </span><span class="n">paramonte</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">runParaDRAM</span><span class="w">
    </span><span class="k">use</span><span class="w"> </span><span class="n">LogFunc_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">getLogFunc</span><span class="p">,</span><span class="w"> </span><span class="n">NDIM</span><span class="w">

    </span><span class="k">implicit</span><span class="w"> </span><span class="k">none</span><span class="w">

    </span><span class="k">call</span><span class="w"> </span><span class="n">runParaDRAM</span><span class="p">(</span><span class="w"> </span><span class="n">NDIM</span><span class="w"> </span><span class="p">&amp;</span><span class="w">
                    </span><span class="p">,</span><span class="w"> </span><span class="n">getLogFunc</span><span class="w"> </span><span class="p">&amp;</span><span class="w">
                    </span><span class="p">,</span><span class="w"> </span><span class="s2">"./paramonte.in"</span><span class="w"> </span><span class="p">&amp;</span><span class="w"> </span><span class="c1">! this is optional argument</span><span class="w">
                    </span><span class="p">)</span><span class="w">

    </span><span class="k">end</span><span class="w"> </span><span class="k">program</span><span class="w"> </span><span class="n">main</span><span class="w">

</span><span class="cp">#endif</span><span class="w">

</span><span class="c1">!%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span><span class="w">
</span></code></pre></div></div>

<p>Therefore, if you intend to use the Object-Oriented Programming (OOP) calling interface, you will have to define and pass the preprocessor flag <code>IS_COMPATIBLE_COMPILER</code> at compile-time to your compiler (to be discussed later). If this flag is not defined at compile-time, the compiler will automatically use the latter procedural-style calling method enclosed between <code>#else</code> and <code>#endif</code> Fortran preprocessor directives in the main code above.</p>

<h3 id="calling-the-paramonte-samplers-the-signature-module-file">Calling the ParaMonte samplers: The signature module file</h3>

<p>Here is the contents of the Fortran <code>paramonte.90</code> <a href="https://raw.githubusercontent.com/cdslaborg/paramonte/main/src/interface/Fortran/paramonte.f90" target="_blank">signature module file</a> for the ParaMonte library routines,</p>

<div class="language-fortran highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span><span class="w">
</span><span class="c1">!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span><span class="w">
</span><span class="c1">!!!!</span><span class="w">
</span><span class="c1">!!!!   MIT License</span><span class="w">
</span><span class="c1">!!!!</span><span class="w">
</span><span class="c1">!!!!   ParaMonte: plain powerful parallel Monte Carlo library.</span><span class="w">
</span><span class="c1">!!!!</span><span class="w">
</span><span class="c1">!!!!   Copyright (C) 2012-present, The Computational Data Science Lab</span><span class="w">
</span><span class="c1">!!!!</span><span class="w">
</span><span class="c1">!!!!   This file is part of the ParaMonte library.</span><span class="w">
</span><span class="c1">!!!!</span><span class="w">
</span><span class="c1">!!!!   Permission is hereby granted, free of charge, to any person obtaining a </span><span class="w">
</span><span class="c1">!!!!   copy of this software and associated documentation files (the "Software"), </span><span class="w">
</span><span class="c1">!!!!   to deal in the Software without restriction, including without limitation </span><span class="w">
</span><span class="c1">!!!!   the rights to use, copy, modify, merge, publish, distribute, sublicense, </span><span class="w">
</span><span class="c1">!!!!   and/or sell copies of the Software, and to permit persons to whom the </span><span class="w">
</span><span class="c1">!!!!   Software is furnished to do so, subject to the following conditions:</span><span class="w">
</span><span class="c1">!!!!</span><span class="w">
</span><span class="c1">!!!!   The above copyright notice and this permission notice shall be </span><span class="w">
</span><span class="c1">!!!!   included in all copies or substantial portions of the Software.</span><span class="w">
</span><span class="c1">!!!!</span><span class="w">
</span><span class="c1">!!!!   THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, </span><span class="w">
</span><span class="c1">!!!!   EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF </span><span class="w">
</span><span class="c1">!!!!   MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. </span><span class="w">
</span><span class="c1">!!!!   IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, </span><span class="w">
</span><span class="c1">!!!!   DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR </span><span class="w">
</span><span class="c1">!!!!   OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE </span><span class="w">
</span><span class="c1">!!!!   OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.</span><span class="w">
</span><span class="c1">!!!!</span><span class="w">
</span><span class="c1">!!!!   ACKNOWLEDGMENT</span><span class="w">
</span><span class="c1">!!!!</span><span class="w">
</span><span class="c1">!!!!   ParaMonte is an honor-ware and its currency is acknowledgment and citations.</span><span class="w">
</span><span class="c1">!!!!   As per the ParaMonte library license agreement terms, if you use any parts of </span><span class="w">
</span><span class="c1">!!!!   this library for any purposes, kindly acknowledge the use of ParaMonte in your </span><span class="w">
</span><span class="c1">!!!!   work (education/research/industry/development/...) by citing the ParaMonte </span><span class="w">
</span><span class="c1">!!!!   library as described on this page:</span><span class="w">
</span><span class="c1">!!!!</span><span class="w">
</span><span class="c1">!!!!       https://github.com/cdslaborg/paramonte/blob/main/ACKNOWLEDGMENT.md</span><span class="w">
</span><span class="c1">!!!!</span><span class="w">
</span><span class="c1">!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span><span class="w">
</span><span class="c1">!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span><span class="w">
</span><span class="c1">!  </span><span class="w">
</span><span class="c1">!  Description:</span><span class="w">
</span><span class="c1">!       - The Fortran module source file containing the prototypes of the ParaMonte library routines to be called from Fortran.</span><span class="w">
</span><span class="c1">!  Prototypes:</span><span class="w">
</span><span class="c1">!       - runParaDRAM   : The procedural interface to the ParaDRAM sampler routine. This is the basic default interface.</span><span class="w">
</span><span class="c1">!       - ParaDRAM_type : The ParaDRAM sampler class (derived type).</span><span class="w">
</span><span class="c1">!       - ParaDRAM      : An alias for ParaDRAM_type().</span><span class="w">
</span><span class="c1">!  Author:</span><span class="w">
</span><span class="c1">!       - Computational Data Science Lab, Monday 9:03 AM, May 16 2016, ICES, UT Austin</span><span class="w">
</span><span class="c1">!</span><span class="w">
</span><span class="c1">!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span><span class="w">

</span><span class="k">module</span><span class="w"> </span><span class="n">paramonte</span><span class="w">

    </span><span class="c1">! ParaMonte default integer, real, and complex kinds are defined by IK, RK, and CK below.</span><span class="w">
    </span><span class="c1">! Use IK and RK from this module for integer and real kind specifications in your Fortran codes</span><span class="w">
    </span><span class="c1">! to ensure the highest level of consistency with the integer and real kinds of the ParaMonte library.</span><span class="w">

</span><span class="cp">#if defined IS_COMPATIBLE_COMPILER</span><span class="w">

    </span><span class="c1">! Use the identifiers here to access the Object-Oriented interface to the ParaMonte routines.</span><span class="w">
    </span><span class="c1">! To enable the object-oriented interface, you must pass the IS_COMPATIBLE_COMPILER </span><span class="w">
    </span><span class="c1">! preprocessor flag to the compiler at the time of compiling this module.</span><span class="w">

    </span><span class="k">use</span><span class="w"> </span><span class="n">ParaDRAM_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">IK</span><span class="p">,</span><span class="w"> </span><span class="n">RK</span><span class="p">,</span><span class="w"> </span><span class="n">CK</span><span class="w">
    </span><span class="k">use</span><span class="w"> </span><span class="n">ParaDRAM_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">getLogFunc_proc</span><span class="w">
    </span><span class="k">use</span><span class="w"> </span><span class="n">ParaDRAM_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">getLogFunc_interface</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">getLogFunc_proc</span><span class="w">
    </span><span class="k">use</span><span class="w"> </span><span class="n">ParaDRAM_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">ParaDRAM</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">ParaDRAM_type</span><span class="w">
    </span><span class="k">use</span><span class="w"> </span><span class="n">ParaDRAM_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">ParaDRAM_type</span><span class="w">

</span><span class="cp">#else</span><span class="w">

    </span><span class="c1">! This is the procedural interface to the ParaDRAM sampler routine of the ParaMonte library.</span><span class="w">
    </span><span class="c1">! By default, if the preprocessor flag IS_COMPATIBLE_COMPILER is not passed to the compiler,</span><span class="w">
    </span><span class="c1">! the following procedural interfaces will be used, depending on the choice of Fortran compiler.</span><span class="w">

    </span><span class="k">use</span><span class="p">,</span><span class="w"> </span><span class="k">intrinsic</span><span class="w"> </span><span class="p">::</span><span class="w"> </span><span class="n">iso_fortran_env</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">IK</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">int32</span><span class="p">,</span><span class="w"> </span><span class="n">RK</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">real64</span><span class="w">
    </span><span class="k">implicit</span><span class="w"> </span><span class="k">none</span><span class="w">
    </span><span class="k">public</span><span class="w"> </span><span class="p">::</span><span class="w"> </span><span class="n">runParaDRAM</span><span class="p">,</span><span class="w"> </span><span class="n">getLogFunc_proc</span><span class="w">

    </span><span class="c1">! The Fortran objective function interface (getLogFunc). Here, `proc` stands for the procedure interface.</span><span class="w">

    </span><span class="k">abstract</span><span class="w"> </span><span class="k">interface</span><span class="w">
        </span><span class="k">function</span><span class="w"> </span><span class="n">getLogFunc_proc</span><span class="p">(</span><span class="n">ndim</span><span class="p">,</span><span class="n">Point</span><span class="p">)</span><span class="w"> </span><span class="k">result</span><span class="p">(</span><span class="n">logFunc</span><span class="p">)</span><span class="w">
            </span><span class="k">import</span><span class="w"> </span><span class="p">::</span><span class="w"> </span><span class="n">IK</span><span class="p">,</span><span class="w"> </span><span class="n">RK</span><span class="w">
            </span><span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="k">in</span><span class="p">)</span><span class="w">    </span><span class="p">::</span><span class="w"> </span><span class="n">ndim</span><span class="w">
            </span><span class="kt">real</span><span class="p">(</span><span class="n">RK</span><span class="p">)</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="k">in</span><span class="p">)</span><span class="w">    </span><span class="p">::</span><span class="w"> </span><span class="n">Point</span><span class="p">(</span><span class="n">ndim</span><span class="p">)</span><span class="w">
            </span><span class="kt">real</span><span class="p">(</span><span class="n">RK</span><span class="p">)</span><span class="w">                    </span><span class="p">::</span><span class="w"> </span><span class="n">logFunc</span><span class="w">
        </span><span class="k">end</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="n">getLogFunc_proc</span><span class="w">
    </span><span class="k">end</span><span class="w"> </span><span class="k">interface</span><span class="w">

</span><span class="cp">#if defined __WIN64__ &amp;&amp; __GFORTRAN__</span><span class="w">

    </span><span class="c1">! NOTE: __WIN64__ is not automatically predefined by GNU Fortran compiler.</span><span class="w">
    </span><span class="c1">! NOTE: The onus is on the user to define __WIN64__ at the time of compiling this code.</span><span class="w">

    </span><span class="c1">! This is the procedural interface to the ParaDRAM sampler routine of the ParaMonte library, </span><span class="w">
    </span><span class="c1">! to be used by the GNU Fortran compiler in combination with the ParaMonte library prebuilt </span><span class="w">
    </span><span class="c1">! via the Intel compiler suite on Windows. This particular separate interface exists here </span><span class="w">
    </span><span class="c1">! because of the fundamental symbol exporting convention differences of the GNU and Intel </span><span class="w">
    </span><span class="c1">! Fortran compilers, with Intel making all symbols uppercase, while GNU making all </span><span class="w">
    </span><span class="c1">! symbols lowercase. </span><span class="w">

    </span><span class="k">abstract</span><span class="w"> </span><span class="k">interface</span><span class="w">
        </span><span class="c1">! C-style Fortran interface for the the objective function</span><span class="w">
        </span><span class="c1">! This is to be used only to bind the ParaMonte library compiled by the </span><span class="w">
        </span><span class="c1">! Intel Compilers with Fortran applications compiled with GNU compilers on Windows.</span><span class="w">
        </span><span class="k">function</span><span class="w"> </span><span class="n">getLogFuncIntelGNU_proc</span><span class="p">(</span><span class="n">ndim</span><span class="p">,</span><span class="n">Point</span><span class="p">)</span><span class="w"> </span><span class="k">result</span><span class="p">(</span><span class="n">logFunc</span><span class="p">)</span><span class="w"> </span><span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="w">
            </span><span class="k">import</span><span class="w"> </span><span class="p">::</span><span class="w"> </span><span class="n">IK</span><span class="p">,</span><span class="w"> </span><span class="n">RK</span><span class="w">
            </span><span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="k">in</span><span class="p">)</span><span class="w">         </span><span class="p">::</span><span class="w"> </span><span class="n">ndim</span><span class="w">
            </span><span class="kt">real</span><span class="p">(</span><span class="n">RK</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="k">in</span><span class="p">)</span><span class="w">            </span><span class="p">::</span><span class="w"> </span><span class="n">Point</span><span class="p">(</span><span class="n">ndim</span><span class="p">)</span><span class="w">
            </span><span class="kt">real</span><span class="p">(</span><span class="n">RK</span><span class="p">)</span><span class="w">                        </span><span class="p">::</span><span class="w"> </span><span class="n">logFunc</span><span class="w">
        </span><span class="k">end</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="n">getLogFuncIntelGNU_proc</span><span class="w">
    </span><span class="k">end</span><span class="w"> </span><span class="k">interface</span><span class="w">

    </span><span class="k">interface</span><span class="w">
        </span><span class="k">subroutine</span><span class="w"> </span><span class="n">runParaDRAMIntelGNU</span><span class="w">  </span><span class="p">(</span><span class="w"> </span><span class="n">ndim</span><span class="w">                  </span><span class="p">&amp;</span><span class="w">
                                        </span><span class="p">,</span><span class="w"> </span><span class="n">getLogFuncIntelGNU</span><span class="w">    </span><span class="p">&amp;</span><span class="w">
                                        </span><span class="p">,</span><span class="w"> </span><span class="n">inputFileVec</span><span class="w">          </span><span class="p">&amp;</span><span class="w">
                                        </span><span class="p">,</span><span class="w"> </span><span class="n">inputFileLen</span><span class="w">          </span><span class="p">&amp;</span><span class="w">
                                        </span><span class="p">)</span><span class="w"> </span><span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"runParaDRAMIntelGNU"</span><span class="p">)</span><span class="w">
            </span><span class="k">import</span><span class="w"> </span><span class="p">::</span><span class="w"> </span><span class="n">IK</span><span class="p">,</span><span class="w"> </span><span class="n">getLogFuncIntelGNU_proc</span><span class="w">
            </span><span class="k">implicit</span><span class="w"> </span><span class="k">none</span><span class="w">
            </span><span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="k">in</span><span class="p">)</span><span class="w">                </span><span class="p">::</span><span class="w"> </span><span class="n">ndim</span><span class="w">
            </span><span class="k">procedure</span><span class="p">(</span><span class="n">getLogFuncIntelGNU_proc</span><span class="p">)</span><span class="w">      </span><span class="p">::</span><span class="w"> </span><span class="n">getLogFuncIntelGNU</span><span class="w">
            </span><span class="kt">character</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="k">in</span><span class="p">)</span><span class="w">  </span><span class="p">::</span><span class="w"> </span><span class="n">inputFileVec</span><span class="w">
            </span><span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="k">in</span><span class="p">)</span><span class="w">                </span><span class="p">::</span><span class="w"> </span><span class="n">inputFileLen</span><span class="w">
        </span><span class="k">end</span><span class="w"> </span><span class="k">subroutine</span><span class="w"> </span><span class="n">runParaDRAMIntelGNU</span><span class="w">
    </span><span class="k">end</span><span class="w"> </span><span class="k">interface</span><span class="w">

</span><span class="k">contains</span><span class="w">

    </span><span class="k">subroutine</span><span class="w"> </span><span class="n">runParaDRAM</span><span class="w">  </span><span class="p">(</span><span class="w"> </span><span class="n">ndim</span><span class="w">          </span><span class="p">&amp;</span><span class="w">
                            </span><span class="p">,</span><span class="w"> </span><span class="n">getLogFunc</span><span class="w">    </span><span class="p">&amp;</span><span class="w">
                            </span><span class="p">,</span><span class="w"> </span><span class="n">inputFile</span><span class="w">     </span><span class="p">&amp;</span><span class="w">
                            </span><span class="p">)</span><span class="w">
        </span><span class="k">implicit</span><span class="w"> </span><span class="k">none</span><span class="w">
        </span><span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="k">in</span><span class="p">)</span><span class="w">            </span><span class="p">::</span><span class="w"> </span><span class="n">ndim</span><span class="w">
        </span><span class="k">procedure</span><span class="p">(</span><span class="n">getLogFunc_proc</span><span class="p">)</span><span class="w">          </span><span class="p">::</span><span class="w"> </span><span class="n">getLogFunc</span><span class="w">
        </span><span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="k">in</span><span class="p">),</span><span class="w"> </span><span class="k">optional</span><span class="w">  </span><span class="p">::</span><span class="w"> </span><span class="n">inputFile</span><span class="w">
        </span><span class="kt">character</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w">                        </span><span class="p">::</span><span class="w"> </span><span class="n">inputFileVec</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span><span class="w"> </span><span class="c1">! (kind=c_char)</span><span class="w">
        </span><span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">)</span><span class="w">                         </span><span class="p">::</span><span class="w"> </span><span class="n">inputFileLen</span><span class="w">
        </span><span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">)</span><span class="w">                         </span><span class="p">::</span><span class="w"> </span><span class="n">i</span><span class="w">
        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">inputFile</span><span class="p">))</span><span class="w"> </span><span class="k">then</span><span class="w">
            </span><span class="n">inputFileLen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="n">inputFile</span><span class="p">)</span><span class="w">
            </span><span class="k">do</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">inputFileLen</span><span class="w">
                </span><span class="n">inputFileVec</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">inputFile</span><span class="p">(</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="p">)</span><span class="w">
            </span><span class="k">end</span><span class="w"> </span><span class="k">do</span><span class="w">
        </span><span class="k">else</span><span class="w">
            </span><span class="n">inputFileLen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w">
        </span><span class="k">end</span><span class="w"> </span><span class="k">if</span><span class="w">
        </span><span class="k">call</span><span class="w"> </span><span class="n">runParaDRAMIntelGNU</span><span class="p">(</span><span class="w"> </span><span class="n">ndim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ndim</span><span class="w"> </span><span class="p">&amp;</span><span class="w"> </span><span class="c1">! int(ndim, kind=CIK) &amp;</span><span class="w">
                                </span><span class="p">,</span><span class="w"> </span><span class="n">getLogFuncIntelGNU</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getLogFuncIntelGNU</span><span class="w"> </span><span class="p">&amp;</span><span class="w">
                                </span><span class="p">,</span><span class="w"> </span><span class="n">inputFileVec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">inputFileVec</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">inputFileLen</span><span class="p">)</span><span class="w"> </span><span class="p">&amp;</span><span class="w">
                                </span><span class="p">,</span><span class="w"> </span><span class="n">inputFileLen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">inputFileLen</span><span class="w"> </span><span class="p">&amp;</span><span class="w">
                                </span><span class="p">)</span><span class="w">
    </span><span class="k">contains</span><span class="w">
        </span><span class="k">function</span><span class="w"> </span><span class="n">getLogFuncIntelGNU</span><span class="p">(</span><span class="n">ndim</span><span class="p">,</span><span class="n">Point</span><span class="p">)</span><span class="w"> </span><span class="k">result</span><span class="p">(</span><span class="n">logFunc</span><span class="p">)</span><span class="w"> </span><span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="w">
            </span><span class="c1">! The C-style Fortran objective function wrapper.</span><span class="w">
            </span><span class="k">implicit</span><span class="w"> </span><span class="k">none</span><span class="w">
            </span><span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="k">in</span><span class="p">)</span><span class="w">    </span><span class="p">::</span><span class="w"> </span><span class="n">ndim</span><span class="w">
            </span><span class="kt">real</span><span class="p">(</span><span class="n">RK</span><span class="p">)</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="k">in</span><span class="p">)</span><span class="w">    </span><span class="p">::</span><span class="w"> </span><span class="n">Point</span><span class="p">(</span><span class="n">ndim</span><span class="p">)</span><span class="w">
            </span><span class="kt">real</span><span class="p">(</span><span class="n">RK</span><span class="p">)</span><span class="w">                    </span><span class="p">::</span><span class="w"> </span><span class="n">logFunc</span><span class="w">
            </span><span class="n">logFunc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getLogFunc</span><span class="p">(</span><span class="n">ndim</span><span class="p">,</span><span class="n">Point</span><span class="p">)</span><span class="w">
        </span><span class="k">end</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="n">getLogFuncIntelGNU</span><span class="w">
    </span><span class="k">end</span><span class="w"> </span><span class="k">subroutine</span><span class="w"> </span><span class="n">runParaDRAM</span><span class="w">

</span><span class="cp">#else</span><span class="w">

    </span><span class="k">interface</span><span class="w">
        </span><span class="k">subroutine</span><span class="w"> </span><span class="n">runParaDRAM</span><span class="w">  </span><span class="p">(</span><span class="w"> </span><span class="n">ndim</span><span class="w">          </span><span class="p">&amp;</span><span class="w">
                                </span><span class="p">,</span><span class="w"> </span><span class="n">getLogFunc</span><span class="w">    </span><span class="p">&amp;</span><span class="w">
                                </span><span class="p">,</span><span class="w"> </span><span class="n">inputFile</span><span class="w">     </span><span class="p">&amp;</span><span class="w">
                                </span><span class="p">)</span><span class="w">
            </span><span class="k">import</span><span class="w"> </span><span class="p">::</span><span class="w"> </span><span class="n">IK</span><span class="p">,</span><span class="w"> </span><span class="n">getLogFunc_proc</span><span class="w">
            </span><span class="k">implicit</span><span class="w"> </span><span class="k">none</span><span class="w">
            </span><span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="k">in</span><span class="p">)</span><span class="w">            </span><span class="p">::</span><span class="w"> </span><span class="n">ndim</span><span class="w">
            </span><span class="k">procedure</span><span class="p">(</span><span class="n">getLogFunc_proc</span><span class="p">)</span><span class="w">          </span><span class="p">::</span><span class="w"> </span><span class="n">getLogFunc</span><span class="w">
            </span><span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="k">in</span><span class="p">),</span><span class="w"> </span><span class="k">optional</span><span class="w">  </span><span class="p">::</span><span class="w"> </span><span class="n">inputFile</span><span class="w">
        </span><span class="k">end</span><span class="w"> </span><span class="k">subroutine</span><span class="w"> </span><span class="n">runParaDRAM</span><span class="w">
    </span><span class="k">end</span><span class="w"> </span><span class="k">interface</span><span class="w">

</span><span class="cp">#endif</span><span class="w">

</span><span class="cp">#endif</span><span class="w">

</span><span class="k">end</span><span class="w"> </span><span class="k">module</span><span class="w"> </span><span class="n">paramonte</span><span class="w">
</span></code></pre></div></div>

<p>Again, note that there are two interfaces to the ParaMonte library routines, separated via the compiler preprocessor flag <code>IS_COMPATIBLE_COMPILER</code> in the signature module file.</p>

<p>In the following sections, we will describe which interface is suitable for what circumstances.</p>

<h3 id="calling-the-paramonte-samplers-the-modern-object-oriented-style">Calling the ParaMonte samplers: The modern object-oriented style</h3>

<p>The Object-Oriented-Programing (OOP) style interface is the parts of the codes in the above that are enclosed by the <code>IS_COMPATIBLE_COMPILER</code> preprocessor flag. The OOP interface can be used only if,</p>

<ol>
  <li>you have built the ParaMonte library from scratch on your system using a Fortran compiler installed on your system (ideally, the Intel <code>ifort</code> Fortran compiler), or,</li>
  <li>you intend to use the prebuilt ParaMonte libraries which can be downloaded from the <a href="https://github.com/cdslaborg/paramonte/releases/v1.5.1" target="_blank">ParaMonte release page on GitHub</a>, but you promise that you are using a compatible compiler to compile your example. Typically this means using the <a href="https://github.com/cdslaborg/paramonte/blob/main/CHANGES.md" target="_blank">same compiler/library suite and version</a> that has been used to build ParaMonte.</li>
</ol>

<p>If one of the above two scenarios describes your situation, then you can safely use the OOP-style interface (enclosed between the two preprocessor directives <code>#if defined IS_COMPATIBLE_COMPILER</code> and <code>#else</code>) in the above code.</p>

<div class="alert alert-success" role="alert"><i class="fa fa-check-square-o"></i> <b>Tip:</b> As you may have noticed in the above main code, one advantage of the object-oriented style is that upon finishing the simulation, all simulation properties and results are stored in a single object (e.g., <strong><code>pmpd</code></strong> in the above program) which belongs to the <a href="https://github.com/cdslaborg/paramonte/blob/main/src/kernel/ParaXXXX_mod.inc.f90" target="_blank">ParaDRAM_type</a> class. This information can be then readily used and processed for other purposes within your simulation at runtime.</div>

<p>Using this modern Fortran style, you can also provide optional arguments at the time of calling the ParaMonte routines. For example, the variables <code>chainSize</code>, <code>adaptiveUpdateCount</code>, …, specified in the OOP-style interface of the <code>runSampler()</code> method in the above code would overwrite any values for the corresponding variables specified taken from the <a href="https://raw.githubusercontent.com/cdslaborg/paramonte/main/example/mvn/input/paramonte.in" target="_blank">input file</a>: <code>./paramonte.in</code> (unless you set the input specification variable <a href="../../../usage/paradram/specifications/#inputfilehaspriority" target="_blank">inputFileHasPriority</a> to <code>true</code> from within the input file).</p>

<p>In addition to being able to assign simulation specifications from within an input file, the current major release the ParaMonte library also enables the assignment of all simulation specifications from the Fortran Object-Oriented interface to the ParaMonte sampler routines (except the input specification variable <a href="../../../usage/paradram/specifications/#inputfilehaspriority" target="_blank">inputFileHasPriority</a> which is always available only from within the input file).</p>

<div class="alert alert-info" role="alert"><i class="fa fa-info-circle"></i> <b>Note:</b> You can view the full object-oriented interface of the <strong><code>runSampler()</code></strong> method of the <strong><code>ParaDRAM_type</code></strong> sampler class in <a href="https://github.com/cdslaborg/paramonte/blob/main/src/kernel/ParaXXXX_mod.inc.f90" target="_blank">ParaDRAM_mod.inc.f90</a>.</div>

<h3 id="calling-the-paramonte-samplers-the-old-less-flexible-but-more-portable-style">Calling the ParaMonte samplers: The old, less flexible, but more portable style</h3>

<p>If you intend to use the prebuilt ParaMonte libraries to build your application (or for some reason, you are building your example with a compiler other than the one you used for building the ParaMonte library), then the modern object-oriented style of calling ParaMonte routines described in the previous section may not work for you. This is mainly due to the potential mismatch between the existing symbols in the ParaMonte library and the symbols that your different compiler expects to see in the ParaMonte library.</p>

<p>In such a case, you can use the simpler procedural Fortran interface to the ParaMonte library routines as shown in the above main code, enclosed between <code>#else</code> and <code>#endif</code> Fortran preprocessor directives. You can view the <code>runParaDRAM()</code> sampler routine’s interface in the signature module file <code>paramonte.f90</code> shown in the previous sections in the above.</p>

<div class="alert alert-info" role="alert"><i class="fa fa-info-circle"></i> <b>Note:</b> Although, the procedural interface provides more portability, there is, in general, no guarantee that this procedural interface compiled by a certain compiler would match an example main code compiled with a different compiler. However, as of today, the procedural interface to the ParaMonte library routines is interoperable between the Intel and GNU Fortran compilers. This means that <strong>you can link your main procedural-interface codes compiled via the GNU Fortran compiler against the ParaMonte libraries prebuilt via the Intel Fortran compiler, and vice versa</strong>. While this is true at the moment, the situation may change in the future releases of the two compilers (although it seems unlikely).</div>

<h3 id="calling-the-paramonte-samplers-the-input-file">Calling the ParaMonte samplers: The input file</h3>

<p>We will store the simulation specifications in a separate external input file whose path <code>"./paramonte.in"</code> is given by the variable <code>inputFile</code> in the main code above. See <a href="../../../../usage/paradram/interface" target="_blank">this page</a> for a detailed description of the structure and convention rules of the input files. Also, see <a href="../../../../usage/paradram/specifications" target="_blank">this page</a> for detailed descriptions of the simulation specifications of the ParaDRAM sampler.</p>

<div class="alert alert-success" role="alert"><i class="fa fa-check-square-o"></i> <b>Tip:</b> Note that the entire contents of the input file is optional. If not provided, all simulation variables will be assigned appropriate default values. Nevertheless, in some cases the user may need to provide further information about the simulation via the input simulation variables to help the ParaMonte routines yield better performance or more accurate results.</div>

<div class="alert alert-success" role="alert"><i class="fa fa-check-square-o"></i> <b>Tip:</b> You can also pass the entire contents of the input file as a string value to the input variable <code>inputFile</code> of the ParaMonte routines, instead of passing the-path-to-this-input-file.</div>

<p>Here is the contents of this <code>paramonte.in</code> input file,</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>!%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
!%  
!%  Description:
!%      +   Run the Monte Carlo sampler of the ParaMonte library given the input log-target density function `getLogFunc()`.
!%  Output:
!%      +   The simulation output files.
!%  Author:
!%      +   Computational Data Science Lab, Monday 9:03 AM, May 16 2016, ICES, UT Austin
!%  Visit:
!%      +   https://www.cdslab.org/paramonte
!%
!%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
!
!   USAGE:
!
!       --  Comments must begin with an exclamation mark (!).
!       --  Comments can appear anywhere on an empty line or, after a value assignment.
!       --  All variable assignments are optional and can be commented out. In such cases, appropriate default values will be assigned.
!       --  Use ParaDRAM namelist (group) name to group a set of ParaDRAM simulation specification variables.
!       --  The order of the input variables in the namelist groups is irrelevant and unimportant.
!       --  Variables can be defined multiple times, but only the last definition will be considered as input.
!       --  All variable names are case insensitive. However, for clarity, this software follows the camelCase code-writing practice.
!       --  String values must be enclosed with either single or double quotation marks.
!       --  Logical values are case-insensitive and can be either .true., true, or t for a TRUE value, and .false., false, or f for a FALSE value.
!       --  All vectors and arrays in the input file begin with index 1. This is following the convention of 
!           the majority of science-oriented programming languages: Fortran, Julia, Mathematica, MATLAB, and R.
!
!      For comprehensive guidelines on the input file organization and rules, visit: 
!   
!           https://www.cdslab.org/paramonte/notes/usage/paradram/input/
!   
!      To see detailed descriptions of each of variables, visit:
!   
!           https://www.cdslab.org/paramonte/notes/usage/paradram/specifications/
!

&amp;ParaDRAM

    ! Base specifications

    description                         = "
This\n
    is a\n
        multi-line\n
            description."                                   ! strings must be enclosed with "" or '' and can be continued on multiple lines.
                                                            ! No comments within strings are allowed.
   !outputColumnWidth                   = 25                ! this is an example of a variable that is commented out and 
                                                            ! therefore, its value won't be read by the sampler routine.
                                                            ! To pass it to the routine, simply remove the ! mark at 
                                                            ! the beginning of the line.
    outputRealPrecision                 = 17
   !outputDelimiter                     = ","
    outputFileName                      = "./out/"          ! the last forward-slash character indicates that this 
                                                            ! is the folder where the output files will have to stored.
                                                            ! However, since no output filename prefix has been specified,
                                                            ! the output filenames will be assigned a randomly-generated prefix.
   !sampleSize                          = 111
    randomSeed                          = 2136275,
    chainFileFormat                     = "compact"
    variableNameList                    = "variable1"       ! Notice the missing fourth variable name here. 
                                        , "variable2"       ! Any missing variable name will be automatically assigned an appropriate name. 
                                        , "variable3"
    domainLowerLimitVec                 = 4*-1.e300         ! repetition pattern rules apply again here. 4 dimensions =&gt; 4-element vector of values.
    domainUpperLimitVec                 = 4*1.e300          ! repetition pattern rules apply again here. 4 dimensions =&gt; 4-element vector of values.
    parallelizationModel                = "single chain"    ! "singleChain" would also work. Similarly, "multichain", "multi chain", or "multiChain".
   !targetAcceptanceRate                = 0.23e0
    progressReportPeriod                = 1000
    maxNumDomainCheckToWarn             = 100
    maxNumDomainCheckToStop             = 1000
    restartFileFormat                   = "binary"
    overwriteRequested                  = true              ! FALSE, false, .false., .f., and f would be also all valid logical values representing False
    silentModeRequested                 = false             ! FALSE, false, .false., .f., and f would be also all valid logical values representing False
   !mpiFinalizeRequested                = true              ! TRUE, true, .true., .t., and t would be also all valid logical values representing True

    ! MCMC specifications

    chainSize                           = 30000
    startPointVec                       = 4*1.e0            ! four values of 1.e0 are specified here by the repetition pattern symbol *
   !sampleRefinementCount               = 10
    sampleRefinementMethod              = "BatchMeans"
    randomStartPointDomainLowerLimitVec = 4*-100.e0         ! repetition pattern rules apply again here. 4 dimensions =&gt; 4-element vector of values.
    randomStartPointDomainUpperLimitVec = 4*100.0           ! repetition pattern rules apply again here. 4 dimensions =&gt; 4-element vector of values.
    randomStartPointRequested           = false

    ! DRAM specifications

    scaleFactor                         = "2*0.5*Gelman"    ! The asterisk here means multiplication since it is enclosed within quotation marks.
    proposalModel                       = "normal"          ! or "uniform" as you wish.
    adaptiveUpdateCount                 = 10000000
    adaptiveUpdatePeriod                = 35
    greedyAdaptationCount               = 0
   !delayedRejectionCount               = 5
   !delayedRejectionScaleFactorVec      = 5*1.
   !burninAdaptationMeasure             = 1.
   !proposalStartStdVec                 = 4*1.0             ! repetition pattern rules apply again here. 4 dimensions =&gt; 4-element vector of values.
   !proposalStartCorMat                 =   1,0,0,0,        ! 2-dimensional correlation-matrix definition, although it is commented out and won't be read.
   !                                        0,1,0,0,
   !                                        0,0,1,0,
   !                                        0,0,0,1,
   !proposalStartCovMat                 =   100,0,0,0,
   !                                        0,100,0,0,
   !                                        0,0,100,0,
   !                                        0,0,0,100,

/

</code></pre></div></div>

<p><br /></p>

<h2 id="compiling-and-linking-to-generate-the-executable">Compiling and linking to generate the executable</h2>

<p>Now, follow <a href="../../../build/fortran/" target="_blank">the instructions on this page</a> on how to build your Fortran example for serial and parallel simulations on the Operating System (OS) of you choice: <code>Windows</code>, <code>Linux</code>, or <code>macOS</code> / <code>Darwin</code>.</p>

<p><br /></p>

<h2 id="running-the-paramonte-simulations">Running the ParaMonte simulations</h2>

<p>Once you have built your application, running the simulation is as simple as calling the generated executable on the command-prompt for serial applications, or invoking the MPI/Coarray launcher on the command-prompt for MPI/Coarray parallel simulations.  Follow <a href="../../../run/default/" target="_blank">the instructions and tips on this page</a> on how to run your Fortran example on either <code>Windows</code>, <code>Linux</code>, or <code>macOS</code> / <code>Darwin</code> Operating System (OS), on either a single processor or in parallel, on multiple processors or clusters of nodes of processors.</p>

<div class="alert alert-success" role="alert"><i class="fa fa-check-square-o"></i> <b>Tip: </b>
If you linking your applications (on <b>Linux</b> or <b>macOS</b>) against a <b>shared</b> build of the ParaMonte library, you may encounter runtime errors similar in nature to the following,  
<pre>
main.exe: <b>error while loading shared libraries</b>: libparamonte_c_linux_x64_gnu_release_shared_heap.so: <b>cannot open shared object file: No such file or directory</b>
</pre>
Such an error message imply that the shared runtime library mentioned in the error message is missing from the known search paths to application. To resolve such runtime errors, you will have to add the path to the required runtime shared library to your Bash environmental variable <b><code>LD_LIBRARY_PATH</code></b>. For example, the following will prepend the current directory to the list of paths for the runtime library search.  

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">export </span><span class="nv">LD_LIBRARY_PATH</span><span class="o">=</span>.:<span class="nv">$LD_LIBRARY_PATH</span></code></pre></figure>


</div>

<h3 id="running-the-paramonte-simulations-on-a-single-processor">Running the ParaMonte simulations on a single processor</h3>

<p>If the executable <code>main.exe</code> has been built for serial simulations (using one processor), simply call the executable on the command line. The calling method is identical on all three Operating Systems: Windows, Linux, and Darwin (macOS). Here is an example call on Windows OS,</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>D:\example&gt;main.exe

************************************************************************************************************************************
************************************************************************************************************************************
****                                                                                                                            ****
****                                                                                                                            ****
****                                                         ParaMonte                                                          ****
****                                                       Version 1.0.0                                                        ****
****                                                        May 23 2018                                                         ****
****                                                                                                                            ****
****                                                   Department of Physics                                                    ****
****                                              Computational &amp; Data Science Lab                                              ****
****                                          Data Science Program, College of Science                                          ****
****                                            The University of Texas at Arlington                                            ****
****                                                                                                                            ****
****                                                  originally developed at                                                   ****
****                                                                                                                            ****
****                                                 Multiscale Modeling Group                                                  ****
****                                          Center for Computational Oncology (CCO)                                           ****
****                                 Oden Institute for Computational Engineering and Sciences                                  ****
****                               Department of Aerospace Engineering and Engineering Mechanics                                ****
****                                     Department of Neurology, Dell-Seton Medical School                                     ****
****                                            Department of Biomedical Engineering                                            ****
****                                             The University of Texas at Austin                                              ****
****                                                                                                                            ****
****                                   For questions and further information, please contact:                                   ****
****                                                                                                                            ****
****                                                      Amir Shahmoradi                                                       ****
****                                                                                                                            ****
****                                                   shahmoradi@utexas.edu                                                    ****
****                                                  amir.shahmoradi@uta.edu                                                   ****
****                                                   ashahmoradi@gmail.com                                                    ****
****                                                                                                                            ****
****                                                       cdslab.org/pm                                                        ****
****                                                                                                                            ****
****                                             https://www.cdslab.org/paramonte/                                              ****
****                                                                                                                            ****
****                                                                                                                            ****
************************************************************************************************************************************
************************************************************************************************************************************



************************************************************************************************************************************
****                                                                                                                            ****
****                                              Setting up ParaDRAM environment                                               ****
****                                                                                                                            ****
************************************************************************************************************************************


        ParaDRAM - NOTE: Variable outputFileName detected among the input variables to ParaDRAM:
        ParaDRAM - NOTE: ./out/
        ParaDRAM - NOTE:
        ParaDRAM - NOTE: Absolute path to the current working directory:
        ParaDRAM - NOTE: D:\example
        ParaDRAM - NOTE:
        ParaDRAM - NOTE: Generating the requested directory for ParaDRAM output files:
        ParaDRAM - NOTE: .\out\
        ParaDRAM - NOTE:
        ParaDRAM - NOTE: No user-input filename prefix for ParaDRAM output files detected.
        ParaDRAM - NOTE: Generating appropriate filenames for ParaDRAM output files from the current date and time...
        ParaDRAM - NOTE:
        ParaDRAM - NOTE: ParaDRAM output files will be prefixed with:
        ParaDRAM - NOTE: .\out\ParaDRAM_run_20200322_002335_512



        ParaDRAM - NOTE: Searching for previous runs of ParaDRAM...



        ParaDRAM - NOTE: No pre-existing ParaDRAM run detected.
        ParaDRAM - NOTE: Starting a fresh ParaDRAM run...



        ParaDRAM - NOTE: Generating the output report file:
        ParaDRAM - NOTE: .\out\ParaDRAM_run_20200322_002335_512_process_1_report.txt



        ParaDRAM - NOTE: Please see the output report and progress files for further realtime simulation details.



                         Accepted/Total Func. Call   Dynamic/Overall Acc. Rate   Elapsed/Remained Time [s]
                         =========================   =========================   =========================
                                    30000 / 130490              0.179 / 0.2291              2.2880 / 0.000



        ParaDRAM - NOTE: Computing the Markov chain's statistical properties...



        ParaDRAM - NOTE: Computing the final decorrelated sample size...



        ParaDRAM - NOTE: Generating the output sample file:
        ParaDRAM - NOTE: .\out\ParaDRAM_run_20200322_002335_512_process_1_sample.txt



        ParaDRAM - NOTE: Computing the output sample's statistical properties...





        ParaDRAM - NOTE: Mission Accomplished.
</code></pre></div></div>

<h3 id="running-the-paramonte-simulations-in-parallel-on-multiple-processors">Running the ParaMonte simulations in parallel on multiple processors</h3>

<p>If the executable <code>main.exe</code> has been built for MPI-enabled parallel simulations (on multiple processors), you will need to invoke the MPI launcher to start the simulation.</p>

<ul>
  <li><strong>On Windows</strong><br />
For parallel simulations on a single node (of multiple processors), for example on a single computer, the command typically looks like the following,
    <div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mpiexec -localonly -n 3 main.exe
</code></pre></div>    </div>
    <p>where the flag <code>-localonly</code> ensures the simulation is run only on a single node. This option avoids the invocation of the Hydra service which would require prior registration. The flag <code>-n 3</code> assigns three MPI tasks to three physical processors for the simulation. To run your simulation on a cluster of nodes, follow <a href="https://software.intel.com/en-us/mpi-developer-reference-windows-global-options" target="_blank">the guidelines and instructions provided by the Intel MPI library development team</a>.</p>
  </li>
  <li><strong>On Linux / Darwin (Mac)</strong><br />
The MPI launcher command for parallel simulations on Linux and Darwin are identical and look very similar to the Windows command (except for the flag <code>-localonly</code> which is not needed),
    <div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mpiexec -n 3 main.exe
</code></pre></div>    </div>
    <p>where the flag <code>-n 3</code> assigns three MPI tasks to three physical processors for the simulation.</p>
  </li>
</ul>

<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation-circle"></i> <b>Warning:</b> Do not specify more MPI tasks than the available number of physical processors on your system. If there are fewer physical processors available on the machine than the requested MPI tasks, some processors will be assigned more than one MPI tasks. This will significantly degrade the performance of your simulation and will potentially eliminate any benefits gained from running your simulation in parallel. For example, if you are running a parallel simulation on a quad-core laptop (with four physical processors), then the maximum number of MPI tasks should not go beyond 4 under any circumstances.</div>

<p>For example, the following command will launch the simulation on 3 processors on a Windows OS,</p>
<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>D:\example&gt;mpiexec -localonly -n 3 main.exe

************************************************************************************************************************************
************************************************************************************************************************************
****                                                                                                                            ****
****                                                                                                                            ****
****                                                         ParaMonte                                                          ****
****                                                       Version 1.0.0                                                        ****
****                                                        May 23 2018                                                         ****
****                                                                                                                            ****
****                                                   Department of Physics                                                    ****
****                                              Computational &amp; Data Science Lab                                              ****
****                                          Data Science Program, College of Science                                          ****
****                                            The University of Texas at Arlington                                            ****
****                                                                                                                            ****
****                                                  originally developed at                                                   ****
****                                                                                                                            ****
****                                                 Multiscale Modeling Group                                                  ****
****                                          Center for Computational Oncology (CCO)                                           ****
****                                 Oden Institute for Computational Engineering and Sciences                                  ****
****                               Department of Aerospace Engineering and Engineering Mechanics                                ****
****                                     Department of Neurology, Dell-Seton Medical School                                     ****
****                                            Department of Biomedical Engineering                                            ****
****                                             The University of Texas at Austin                                              ****
****                                                                                                                            ****
****                                   For questions and further information, please contact:                                   ****
****                                                                                                                            ****
****                                                      Amir Shahmoradi                                                       ****
****                                                                                                                            ****
****                                                   shahmoradi@utexas.edu                                                    ****
****                                                  amir.shahmoradi@uta.edu                                                   ****
****                                                   ashahmoradi@gmail.com                                                    ****
****                                                                                                                            ****
****                                                       cdslab.org/pm                                                        ****
****                                                                                                                            ****
****                                             https://www.cdslab.org/paramonte/                                              ****
****                                                                                                                            ****
****                                                                                                                            ****
************************************************************************************************************************************
************************************************************************************************************************************



************************************************************************************************************************************
****                                                                                                                            ****
****                                              Setting up ParaDRAM environment                                               ****
****                                                                                                                            ****
************************************************************************************************************************************


        ParaDRAM - NOTE: Variable outputFileName detected among the input variables to ParaDRAM:
        ParaDRAM - NOTE: ./out/
        ParaDRAM - NOTE:
        ParaDRAM - NOTE: Absolute path to the current working directory:
        ParaDRAM - NOTE: D:\example
        ParaDRAM - NOTE:
        ParaDRAM - NOTE: Generating the requested directory for ParaDRAM output files:
        ParaDRAM - NOTE: .\out\
        ParaDRAM - NOTE:
        ParaDRAM - NOTE: No user-input filename prefix for ParaDRAM output files detected.
        ParaDRAM - NOTE: Generating appropriate filenames for ParaDRAM output files from the current date and time...
        ParaDRAM - NOTE:
        ParaDRAM - NOTE: ParaDRAM output files will be prefixed with:
        ParaDRAM - NOTE: .\out\ParaDRAM_run_20200321_193047_392



        ParaDRAM - NOTE: Searching for previous runs of ParaDRAM...



        ParaDRAM - NOTE: No pre-existing ParaDRAM run detected.
        ParaDRAM - NOTE: Starting a fresh ParaDRAM run...



        ParaDRAM - NOTE: Generating the output report file:
        ParaDRAM - NOTE: .\out\ParaDRAM_run_20200321_193047_392_process_1_report.txt



        ParaDRAM - NOTE: Please see the output report and progress files for further realtime simulation details.



                         Accepted/Total Func. Call   Dynamic/Overall Acc. Rate   Elapsed/Remained Time [s]
                         =========================   =========================   =========================
                                    30000 / 130260              0.200 / 0.2298              1.3140 / 0.000



        ParaDRAM - NOTE: The time cost of calling the user-provided objective function must be at least 52.5143 times more
        ParaDRAM - NOTE: (that is, ~24.6651 microseconds) to see any performance benefits from singlechain parallelization
        ParaDRAM - NOTE: model for this simulation. Consider simulating in the serial mode in the future (if used within the
        ParaDRAM - NOTE: same computing environment and with the same configuration as used here).



        ParaDRAM - NOTE: Computing the Markov chain's statistical properties...



        ParaDRAM - NOTE: Computing the final decorrelated sample size...



        ParaDRAM - NOTE: Generating the output sample file:
        ParaDRAM - NOTE: .\out\ParaDRAM_run_20200321_193047_392_process_1_sample.txt



        ParaDRAM - NOTE: Computing the output sample's statistical properties...





        ParaDRAM - NOTE: Mission Accomplished.
</code></pre></div></div>
<p>You may have noticed the following note in the above simulation output,</p>
<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>        ParaDRAM - NOTE: The time cost of calling the user-provided objective function must be at least 52.5143 times more
        ParaDRAM - NOTE: (that is, ~24.6651 microseconds) to see any performance benefits from singlechain parallelization
        ParaDRAM - NOTE: model for this simulation. Consider simulating in the serial mode in the future (if used within the
        ParaDRAM - NOTE: same computing environment and with the same configuration as used here).
</code></pre></div></div>
<p>This indicates that the simulation in parallel does not lead to any efficiency gain. Given the computer specifications on which the above simulation is performed (a decently powerful computer), this may not be surprising. Based on the CPU power and inter-processor communication costs, our example simulation in the above seems to be a good candidate for serial simulations instead.</p>

<div class="alert alert-success" role="alert"><i class="fa fa-check-square-o"></i> <b>Tip: </b>

The optimal number of processors for parallel simulations can vary widely from one MPI-implementation, processor architecture, and simulation problem to another. For large-scale simulations, it is therefore advisable that you run a small simulation for a limited number of samples that can be specified by the appropriate input simulation variable in the input file  (e.g., <b><code>chainSize=2000</code></b> for MCMC simulations performed via ParaDRAM sampler). In general, the number of sampled points should be small enough to finish the test-simulation in a few minutes. Then, check the contents of the output file for this small simulation that has the suffix <b><code>_report.txt</code></b> and look up the part corresponding to the following simulation information near the bottom of the file,

<figure class="highlight"><pre><code class="language-text" data-lang="text">Average time cost of inter-process communications per used (accepted or rejected or delayed-rejection) function call, in seconds:
2.446639524998980E-005
 
 
Average pure time cost of each function call, in seconds:
4.696832225884184E-007
 
 
Number of processes (images):
3
 
 
Estimated maximum speedup gained via singlechain parallelization model compared to serial mode:
1.904244758247332E-002
 
 
Predicted optimal number of physical computing processes for singlechain parallelization model, given the current MCMC sampling efficiency:
1
 
 
Predicted optimal maximum speedup gained via singlechain parallelization model, given the current MCMC sampling efficiency:
1.00000000000000
 
        ParaDRAM - NOTE: The time cost of calling the user-provided objective function must be at least 52.5143 times more 
        ParaDRAM - NOTE: (that is, ~24.6651 microseconds) to see any performance benefits from singlechain parallelization 
        ParaDRAM - NOTE: model for this simulation. Consider simulating in the serial mode in the future (if used within the 
        ParaDRAM - NOTE: same computing environment and with the same configuration as used here).
 
 
Predicted absolute optimal number of physical computing processes for singlechain parallelization model, under any MCMC sampling efficiency:
1
 
 
Predicted absolute optimal maximum speedup gained via singlechain parallelization model, under any MCMC sampling efficiency:
1.00000000000000
 
        ParaDRAM - NOTE: This simulation will likely NOT benefit from any additional computing processor beyond the predicted 
        ParaDRAM - NOTE: absolute optimal number, 1, in the above. This is true for any value of MCMC sampling efficiency.</code></pre></figure>
  
<b>At least two numbers</b> in the information provided in the above box <b>merit your attention</b> before you go ahead to set up your full-production simulation:<br />
<b>1. The predicted optimal number of physical computing processes</b> gives the simulation's best estimate for the optimal number of processes that could give you the highest speed-up, <i>given the current sampling efficiency of your sampler</i>. This is important because if your sampler's efficiency is high, then much of the work will be performed by only the very few first processors and all the work done by the rest of processors is wasted. Therefore, if you believe that your sampler's efficiency in the production mode will remain at the same level as in the test run, you may want to set the number of MPI tasks equal to the <i>predicted optimal number</i> by your test simulation.<br />
<b>2. The predicted absolute optimal number of physical computing processes</b> gives the simulation's best estimate for the absolute-maximum number of processes that could give you the highest speed-up, <i>for any conceivable sampling efficiency of your sampler</i>. You may want to make sure that whatever number of processors you request for your production simulation, it would not go beyond this number as it will gradually become detrimental to your simulation's overall performance. Beyond this predicted absolute processor count, the cost of inter-processor communications gradually becomes comparable and eventually more than any time-savings that could be earned by simulating in parallel.<br />
Keep in mind that these predictions for the optimal number of processors are only estimates and can vary widely depending on the runtime setup of your simulation, or the topology of the inter-processor network and communications.

</div>

<h3 id="final-notes">Final notes</h3>

<p><strong>Mission accomplished</strong>. We have now used the adaptive Markov chain sampler routine of the ParaMonte library to generate random numbers from our objective function of interest. This simulation will generate five files in a folder named <code>./out/</code> in the current directory, each of which contains some specific information about the simulation. The purpose of each file is indicated by the suffix at the end of its name: <code>_chain</code>, <code>_sample</code>, <code>_report</code>, <code>_progress</code>, <code>_restart</code>. If <code>multichain</code> parallelism is requested via the input simulation specification variable <code>parallelizationModel = 'multiChain'</code>, then there will be five simulation output files generated for each processor separately and independently of each other. This is as if we have simulated several independent but simultaneous ParaDRAM simulations of our objective function. More details about the contents of each of the ParaDRAM simulation output files can be found on <a href="../../../usage/paradram/output/" target="_blank">this page</a>.</p>

<div class="alert alert-success" role="alert"><i class="fa fa-check-square-o"></i> <b>Tip: </b>
Self-contained examples with Multivariate Normal Distribution as the objective function are available on the <a href="https://github.com/cdslaborg/paramonte/releases/v1.5.1" target="_blank">the release page of the ParaMonte library on GitHub</a>. These examples come with build-scripts for both Windows and Linux/macOS that can seamlessly build them for you by simply calling the scripts. Depending on the programming language of your choice and your system's architecture, these self-contained examples minimally require a C/C++/Fortran compiler (e.g., Intel Parallel Studio <b>&#8805; 2019.1.1</b> or Microsoft C/C++ compiler <b>&#8805; 2019</b> on Windows, or GNU C/C++/Fortran compilers <b>&#8805; 8.4</b> on Unix-like Operating Systems). If you follow the installation instructions of the ParaMonte library, then all of these build requirements will be automatically installed on your system.
</div>

<h2 id="post-processing-the-paramonte-simulation-results">Post-processing the ParaMonte simulation results</h2>

<p>The post-processing of the output files generated by the ParaMonte routines can be nicely and quickly done via either the <a href="../../../examples/python/postprocess/" target="_blank">ParaMonte Python library</a> or the <a href="../../../examples/matlab/postprocess/" target="_blank">ParaMonte MATLAB library</a>.</p>

<p><br /></p>

<div class="bs-callout bs-callout-danger">If you have any questions about the topics discussed on this page, feel free to ask in the comment section below, or <a href="https://github.com/cdslaborg/paramonte/issues/new/choose" target="_blank">raise an issue</a> on the GitHub page of the library, or reach out to <a href="../../../overview/preface/#who-are-the-paramonte-authors-and-developers" target="_blank">the ParaMonte library authors</a>.</div>

<p><br /></p>


    
    
        
    <div style="margin-top:3rem">
        <div id="disqus_thread"></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'paramonte'; // required: replace example with your forum shortname
    
            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function() {
                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    </div>


    
</div>
<hr class="shaded"/>
<footer>
    <div class="row">
        <div class="social-icons">

    
    <span class="social-icon">
        <a href="https://facebook.com/cdslab" target="_blank">
            <span class="fa-stack fa-lg">
                
                
<i class="fa fa-circle-thin fa-stack-2x"></i>
                <i class="fa fa-facebook fa-stack-xs"></i>
            </span>
        </a>
    </span>
    

    
    <span class="social-icon">
        <a href="https://github.com/cdslaborg" target="_blank">
            <span class="fa-stack fa-lg">
                
<i class="fa fa-circle-thin fa-stack-2x"></i>
                <i class="fa fa-github fa-stack-xs"></i>
            </span>
        </a>
    </span>
    

    

    
    <span class="social-icon">
        <a href="https://instagram.com/cdslaborg" target="_blank">
            <span class="fa-stack fa-lg">
                
<i class="fa fa-circle-thin fa-stack-2x"></i>
                <i class="fa fa-instagram fa-stack-xs"></i>
            </span>
        </a>
    </span>
    

    
    <span class="social-icon">
        <a href="https://medium.com/cdslab" target="_blank">
            <span class="fa-stack fa-lg">
                
<i class="fa fa-circle-thin fa-stack-2x"></i>
                <i class="fa fa-medium fa-stack-xs"></i>
                <!--
                -->
            </span>
        </a>
    </span>
    

    
    <span class="social-icon">
        <a href="https://twitter.com/cdslaborg" target="_blank">
            <span class="fa-stack fa-lg">
                
<i class="fa fa-circle-thin fa-stack-2x"></i>
                <i class="fa fa-twitter fa-stack-xs"></i>
            </span>
        </a>
    </span>
    

</div>

        <div class="col-lg-12 footer">
            &copy;2024 <a href="https://www.cdslab.org" target="_blank">Computational Data Science Lab</a><br />
            Last updated on April 8, 2024<br/>
            
        <p>
            <a href="https://www.cdslab.org" target="_blank"><img class="footerlogo" src="https://www.cdslab.org/paramonte/generic/1/images/logo.png" }}" alt="cdslab.org" /></a>
            <!-- hitwebcounter Code START -->

<div style="text-align:right; float: none; width: 100%; font-size:0.9em; margin-top: -15px">
    <img src="https://hitwebcounter.com/counter/counter.php?page=7807987&style=0007&nbdigits=8&type=page&initCount=155531" title="Free Counter" Alt="web counter"   border="0" />
    <br>
    <span style="color: #ffffff;">
        <script type="text/javascript">
            var sc_project=12178963;
            var sc_invisible=0;
            var sc_security="e0dfe0f9";
            var sc_text=3;
            var scJsHost = "https://";
            document.write("<sc"+"ript type='text/javascript' src='" +
            scJsHost+
            "statcounter.com/counter/counter.js'></"+"script>");
        </script>
    </span>
</div>
        </p>
        </div>
    </div>
    <!--Mathjax LaTeX engine-->
    
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script>
        MathJax.Hub.Config({
            config: ["MMLorHTML.js"],
            extensions: ["tex2jax.js","TeX/AMSmath.js","TeX/AMSsymbols.js"],
            jax: ["input/TeX"],
            tex2jax: {
                inlineMath: [ ['$','$'], ["\\(","\\)"] ],
                displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
                processEscapes: false
            },
            TeX: {
                TagSide: "right",
                TagIndent: ".8em",
                MultLineWidth: "85%",
                equationNumbers: {
                autoNumber: "AMS",
                },
                unicode: {
                fonts: "STIXGeneral,'Arial Unicode MS'" 
                }
            },
            showProcessingMessages: false
        });
    </script>
    <style TYPE="text/css">
        code.has-jax {font: inherit; font-size: 100%; background: inherit; border: inherit;}
    </style>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            tex2jax: {
                inlineMath: [['$','$'], ['\\(','\\)']],
                skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'] // removed 'code' entry
            }
        });
        MathJax.Hub.Queue(function() {
            var all = MathJax.Hub.getAllJax(), i;
            for(i = 0; i < all.length; i += 1) {
                all[i].SourceElement().parentNode.className += ' has-jax';
            }
        });
    </script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
</footer>

                    </div>
                    <!-- /.row -->
                </div>
                <!-- /.container -->
            </div>
            <!-- /#main -->
        </div>
        
    </body>
    
</html>
