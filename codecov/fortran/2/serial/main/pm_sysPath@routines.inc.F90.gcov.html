<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>LCOV - ParaMonte 2.0.0 :: Serial Fortran - Code Coverage Report - main/pm_sysPath@routines.inc.F90</title>
  <link rel="stylesheet" type="text/css" href="../gcov.css">
</head>

<body>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="title"><a href="https://www.cdslab.org/paramonte/fortran/2" target="_blank"><img alt="https://www.cdslab.org/paramonte/fortran/2" src="https://raw.githubusercontent.com/cdslaborg/paramonte/16e8fc2abd6a4263c9f6ee25f7a9f45435443688/img/banner.png"/></a></td></tr>
    <tr><td class="ruler"><img src="../glass.png" width=3 height=3 alt=""></td></tr>

    <tr>
      <td width="100%">
        <table cellpadding=1 border=0 width="100%">
          <tr>
            <td width="10%" class="headerItem">Current view:</td>
            <td width="35%" class="headerValue"><a href="../index.html">top level</a> - <a href="index.html">main</a> - pm_sysPath@routines.inc.F90<span style="font-size: 80%;"> (source / <a href="pm_sysPath@routines.inc.F90.func-sort-c.html">functions</a>)</span></td>
            <td width="5%"></td>
            <td width="15%"></td>
            <td width="10%" class="headerCovTableHead">Hit</td>
            <td width="10%" class="headerCovTableHead">Total</td>
            <td width="15%" class="headerCovTableHead">Coverage</td>
          </tr>
          <tr>
            <td class="headerItem">Test:</td>
            <td class="headerValue">ParaMonte 2.0.0 :: Serial Fortran - Code Coverage Report</td>
            <td></td>
            <td class="headerItem">Lines:</td>
            <td class="headerCovTableEntry">343</td>
            <td class="headerCovTableEntry">536</td>
            <td class="headerCovTableEntryLo">64.0 %</td>
          </tr>
          <tr>
            <td class="headerItem">Date:</td>
            <td class="headerValue">2024-04-08 03:18:57</td>
            <td></td>
            <td class="headerItem">Functions:</td>
            <td class="headerCovTableEntry">1</td>
            <td class="headerCovTableEntry">1</td>
            <td class="headerCovTableEntryHi">100.0 %</td>
          </tr>
          <tr>
            <td class="headerItem">Legend:</td>
            <td class="headerValueLeg">            Lines:
            <span class="coverLegendCov">hit</span>
            <span class="coverLegendNoCov">not hit</span>
</td>
            <td></td>
          </tr>
          <tr><td><img src="../glass.png" width=3 height=3 alt=""></td></tr>
        </table>
      </td>
    </tr>

    <tr><td class="ruler"><img src="../glass.png" width=3 height=3 alt=""></td></tr>
  </table>

  <table cellpadding=0 cellspacing=0 border=0>
    <tr>
      <td><br></td>
    </tr>
    <tr>
      <td>
<pre class="sourceHeading">          Line data    Source code</pre>
<pre class="source">
<a name="1"><span class="lineNum">       1 </span>            : !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</a>
<a name="2"><span class="lineNum">       2 </span>            : !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</a>
<a name="3"><span class="lineNum">       3 </span>            : !!!!                                                                                                                            !!!!</a>
<a name="4"><span class="lineNum">       4 </span>            : !!!!    ParaMonte: Parallel Monte Carlo and Machine Learning Library.                                                           !!!!</a>
<a name="5"><span class="lineNum">       5 </span>            : !!!!                                                                                                                            !!!!</a>
<a name="6"><span class="lineNum">       6 </span>            : !!!!    Copyright (C) 2012-present, The Computational Data Science Lab                                                          !!!!</a>
<a name="7"><span class="lineNum">       7 </span>            : !!!!                                                                                                                            !!!!</a>
<a name="8"><span class="lineNum">       8 </span>            : !!!!    This file is part of the ParaMonte library.                                                                             !!!!</a>
<a name="9"><span class="lineNum">       9 </span>            : !!!!                                                                                                                            !!!!</a>
<a name="10"><span class="lineNum">      10 </span>            : !!!!    LICENSE                                                                                                                 !!!!</a>
<a name="11"><span class="lineNum">      11 </span>            : !!!!                                                                                                                            !!!!</a>
<a name="12"><span class="lineNum">      12 </span>            : !!!!       https://github.com/cdslaborg/paramonte/blob/main/LICENSE.md                                                          !!!!</a>
<a name="13"><span class="lineNum">      13 </span>            : !!!!                                                                                                                            !!!!</a>
<a name="14"><span class="lineNum">      14 </span>            : !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</a>
<a name="15"><span class="lineNum">      15 </span>            : !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</a>
<a name="16"><span class="lineNum">      16 </span>            : </a>
<a name="17"><span class="lineNum">      17 </span>            : !&gt;  \brief</a>
<a name="18"><span class="lineNum">      18 </span>            : !&gt;  This module contains implementations of the procedures in [pm_sysPath](@ref pm_sysPath).</a>
<a name="19"><span class="lineNum">      19 </span>            : !&gt;</a>
<a name="20"><span class="lineNum">      20 </span>            : !&gt;  \finmain</a>
<a name="21"><span class="lineNum">      21 </span>            : !&gt;</a>
<a name="22"><span class="lineNum">      22 </span>            : !&gt;  \author</a>
<a name="23"><span class="lineNum">      23 </span>            : !&gt;  \FatemehBagheri, Wednesday 12:20 AM, October 13, 2021, Dallas, TX</a>
<a name="24"><span class="lineNum">      24 </span>            : </a>
<a name="25"><span class="lineNum">      25 </span>            : !%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</a>
<a name="26"><span class="lineNum">      26 </span>            : </a>
<a name="27"><span class="lineNum">      27 </span>            : #if     INTEL_ENABLED &amp;&amp; WINDOWS_ENABLED</a>
<a name="28"><span class="lineNum">      28 </span>            : #define SHARED, shared</a>
<a name="29"><span class="lineNum">      29 </span>            : #else</a>
<a name="30"><span class="lineNum">      30 </span>            : #define SHARED</a>
<a name="31"><span class="lineNum">      31 </span>            : #endif</a>
<a name="32"><span class="lineNum">      32 </span>            :         !%%%%%%%%%%%%</a>
<a name="33"><span class="lineNum">      33 </span>            : #if     isDir_ENABLED</a>
<a name="34"><span class="lineNum">      34 </span>            :         !%%%%%%%%%%%%</a>
<a name="35"><span class="lineNum">      35 </span>            : </a>
<a name="36"><span class="lineNum">      36 </span>            :         character(*,SKC), parameter :: DSP = DIR_SEP_POSIX</a>
<a name="37"><span class="lineNum">      37 </span>            :         character(*,SKC), parameter :: DSW = DIR_SEP_WINDOWS</a>
<a name="38"><span class="lineNum">      38 </span>            : #if     INTEL_ENABLED &amp;&amp; DD_ENABLED</a>
<a name="39"><span class="lineNum">      39 </span>            :         inquire(directory = path, exist = pathIsDir)</a>
<a name="40"><span class="lineNum">      40 </span>            : #elif   INTEL_ENABLED &amp;&amp; II_ENABLED</a>
<a name="41"><span class="lineNum">      41 </span>            :         if (present(iomsg)) then</a>
<a name="42"><span class="lineNum">      42 </span>            :             inquire(directory = path, exist = pathIsDir, iostat = iostat, iomsg = iomsg)</a>
<a name="43"><span class="lineNum">      43 </span>            :         else</a>
<a name="44"><span class="lineNum">      44 </span>            :             inquire(directory = path, exist = pathIsDir, iostat = iostat)</a>
<a name="45"><span class="lineNum">      45 </span>            :         end if</a>
<a name="46"><span class="lineNum">      46 </span>            : #elif   GNU_ENABLED &amp;&amp; DD_ENABLED</a>
<a name="47"><span class="lineNum">      47 </span><span class="lineCov">        623 :         inquire(file = path//DSP, exist = pathIsDir)</span></a>
<a name="48"><span class="lineNum">      48 </span><span class="lineCov">        623 :         if (.not. pathIsDir) then</span></a>
<a name="49"><span class="lineNum">      49 </span><span class="lineCov">        279 :             inquire(file = path//DSW, exist = pathIsDir)</span></a>
<a name="50"><span class="lineNum">      50 </span>            :         end if</a>
<a name="51"><span class="lineNum">      51 </span>            : #elif   GNU_ENABLED &amp;&amp; II_ENABLED</a>
<a name="52"><span class="lineNum">      52 </span><span class="lineCov">       2993 :         if (present(iomsg)) then</span></a>
<a name="53"><span class="lineNum">      53 </span><span class="lineCov">       1549 :             inquire(file = path//DSP, exist = pathIsDir, iostat = iostat, iomsg = iomsg)</span></a>
<a name="54"><span class="lineNum">      54 </span>            :         else</a>
<a name="55"><span class="lineNum">      55 </span><span class="lineCov">       1444 :             inquire(file = path//DSP, exist = pathIsDir, iostat = iostat)</span></a>
<a name="56"><span class="lineNum">      56 </span>            :         end if</a>
<a name="57"><span class="lineNum">      57 </span>            : #elif   DD_ENABLED || II_ENABLED</a>
<a name="58"><span class="lineNum">      58 </span>            :         character(len(c_null_char),SKC), parameter :: NULL_CHAR = c_null_char</a>
<a name="59"><span class="lineNum">      59 </span>            :         character(len(path) + 1, c_char) :: pathc</a>
<a name="60"><span class="lineNum">      60 </span>            :         interface</a>
<a name="61"><span class="lineNum">      61 </span>            :             function pm_sys_isdirc(pathc) result(itis) bind(C, name = &quot;pm_sys_isdirc&quot;)</a>
<a name="62"><span class="lineNum">      62 </span>            :                 import :: c_int32_t, c_char</a>
<a name="63"><span class="lineNum">      63 </span>            :                 character(1, c_char), intent(in) :: pathc(*)</a>
<a name="64"><span class="lineNum">      64 </span>            :                 integer(c_int32_t) :: itis</a>
<a name="65"><span class="lineNum">      65 </span>            :             end function</a>
<a name="66"><span class="lineNum">      66 </span>            :         end interface</a>
<a name="67"><span class="lineNum">      67 </span>            :         pathc = path//NULL_CHAR</a>
<a name="68"><span class="lineNum">      68 </span>            :         pathIsDir = logical(pm_sys_isdirc(pathc) == 1_c_int32_t, LK)</a>
<a name="69"><span class="lineNum">      69 </span>            : #else</a>
<a name="70"><span class="lineNum">      70 </span>            : #error  &quot;Unrecognized interface.&quot;</a>
<a name="71"><span class="lineNum">      71 </span>            : #endif</a>
<a name="72"><span class="lineNum">      72 </span>            : </a>
<a name="73"><span class="lineNum">      73 </span>            :         !%%%%%%%%%%%%%</a>
<a name="74"><span class="lineNum">      74 </span>            : #elif   isFile_ENABLED</a>
<a name="75"><span class="lineNum">      75 </span>            :         !%%%%%%%%%%%%%</a>
<a name="76"><span class="lineNum">      76 </span>            : </a>
<a name="77"><span class="lineNum">      77 </span>            : #if     DD_ENABLED</a>
<a name="78"><span class="lineNum">      78 </span><span class="lineCov">        399 :         inquire(file = path, exist = pathIsFile)</span></a>
<a name="79"><span class="lineNum">      79 </span>            : #elif   II_ENABLED</a>
<a name="80"><span class="lineNum">      80 </span><span class="lineCov">       2381 :         if (present(iomsg)) then</span></a>
<a name="81"><span class="lineNum">      81 </span><span class="lineCov">       1177 :             inquire(file = path, exist = pathIsFile, iostat = iostat, iomsg = iomsg)</span></a>
<a name="82"><span class="lineNum">      82 </span>            :         else</a>
<a name="83"><span class="lineNum">      83 </span><span class="lineCov">       1204 :             inquire(file = path, exist = pathIsFile, iostat = iostat)</span></a>
<a name="84"><span class="lineNum">      84 </span>            :         end if</a>
<a name="85"><span class="lineNum">      85 </span><span class="lineCov">       2381 :         if (iostat /= 0_IK) return</span></a>
<a name="86"><span class="lineNum">      86 </span>            : #else</a>
<a name="87"><span class="lineNum">      87 </span>            : #error  &quot;Unrecognized interface.&quot;</a>
<a name="88"><span class="lineNum">      88 </span>            : #endif</a>
<a name="89"><span class="lineNum">      89 </span>            : #if     !INTEL_ENABLED</a>
<a name="90"><span class="lineNum">      90 </span><span class="lineCov">       2780 :         if (pathIsFile) then</span></a>
<a name="91"><span class="lineNum">      91 </span>            : #if         DD_ENABLED</a>
<a name="92"><span class="lineNum">      92 </span><span class="lineCov">        212 :             pathIsFile = .not. isDir(path)</span></a>
<a name="93"><span class="lineNum">      93 </span>            : #elif       II_ENABLED</a>
<a name="94"><span class="lineNum">      94 </span><span class="lineCov">       4768 :             pathIsFile = .not. isDir(path, iostat, iomsg)</span></a>
<a name="95"><span class="lineNum">      95 </span>            : #endif</a>
<a name="96"><span class="lineNum">      96 </span>            :         end if</a>
<a name="97"><span class="lineNum">      97 </span>            : #endif</a>
<a name="98"><span class="lineNum">      98 </span>            : </a>
<a name="99"><span class="lineNum">      99 </span>            :         !%%%%%%%%%%%%%%%</a>
<a name="100"><span class="lineNum">     100 </span>            : #elif   isExtant_ENABLED</a>
<a name="101"><span class="lineNum">     101 </span>            :         !%%%%%%%%%%%%%%%</a>
<a name="102"><span class="lineNum">     102 </span>            : </a>
<a name="103"><span class="lineNum">     103 </span>            : #if     DD_ENABLED</a>
<a name="104"><span class="lineNum">     104 </span><span class="lineCov">         40 :         extant = isFile(path)</span></a>
<a name="105"><span class="lineNum">     105 </span><span class="lineCov">         40 :         if (.not. extant) extant = isDir(path)</span></a>
<a name="106"><span class="lineNum">     106 </span>            : #elif   II_ENABLED</a>
<a name="107"><span class="lineNum">     107 </span><span class="lineCov">       4789 :         extant = isFile(path, iostat, iomsg)</span></a>
<a name="108"><span class="lineNum">     108 </span><span class="lineCov">       2381 :         if (.not. extant) extant = isDir(path, iostat, iomsg)</span></a>
<a name="109"><span class="lineNum">     109 </span>            : #else</a>
<a name="110"><span class="lineNum">     110 </span>            : #error  &quot;Unrecognized interface.&quot;</a>
<a name="111"><span class="lineNum">     111 </span>            : #endif</a>
<a name="112"><span class="lineNum">     112 </span>            : !#if     DD_ENABLED</a>
<a name="113"><span class="lineNum">     113 </span>            : !        inquire(file = path, exist = extant)</a>
<a name="114"><span class="lineNum">     114 </span>            : !#elif   II_ENABLED</a>
<a name="115"><span class="lineNum">     115 </span>            : !        if (present(iomsg)) then</a>
<a name="116"><span class="lineNum">     116 </span>            : !            inquire(file = path, exist = extant, iostat = iostat, iomsg = iomsg)</a>
<a name="117"><span class="lineNum">     117 </span>            : !        else</a>
<a name="118"><span class="lineNum">     118 </span>            : !            inquire(file = path, exist = extant, iostat = iostat)</a>
<a name="119"><span class="lineNum">     119 </span>            : !        end if</a>
<a name="120"><span class="lineNum">     120 </span>            : !        if (iostat /= 0_IK) return</a>
<a name="121"><span class="lineNum">     121 </span>            : !#else</a>
<a name="122"><span class="lineNum">     122 </span>            : !#error  &quot;Unrecognized interface.&quot;</a>
<a name="123"><span class="lineNum">     123 </span>            : !#endif</a>
<a name="124"><span class="lineNum">     124 </span>            : !#if     !INTEL_ENABLED</a>
<a name="125"><span class="lineNum">     125 </span>            : !        if (.not. extant) then</a>
<a name="126"><span class="lineNum">     126 </span>            : !#if         DD_ENABLED</a>
<a name="127"><span class="lineNum">     127 </span>            : !            extant = isDir(path)</a>
<a name="128"><span class="lineNum">     128 </span>            : !#elif       II_ENABLED</a>
<a name="129"><span class="lineNum">     129 </span>            : !            extant = isDir(path, iostat, iomsg)</a>
<a name="130"><span class="lineNum">     130 </span>            : !#endif</a>
<a name="131"><span class="lineNum">     131 </span>            : !        end if</a>
<a name="132"><span class="lineNum">     132 </span>            : !#endif</a>
<a name="133"><span class="lineNum">     133 </span>            : </a>
<a name="134"><span class="lineNum">     134 </span>            :         !%%%%%%%%%%%%%%%%%</a>
<a name="135"><span class="lineNum">     135 </span>            : #elif   getDirName_ENABLED</a>
<a name="136"><span class="lineNum">     136 </span>            :         !%%%%%%%%%%%%%%%%%</a>
<a name="137"><span class="lineNum">     137 </span>            : </a>
<a name="138"><span class="lineNum">     138 </span>            :         integer(IK) :: index</a>
<a name="139"><span class="lineNum">     139 </span>            : #if     Def_ENABLED</a>
<a name="140"><span class="lineNum">     140 </span><span class="lineCov">        205 :         index = getIndexDirName(path, dirsep)</span></a>
<a name="141"><span class="lineNum">     141 </span><span class="lineCov">        205 :         if (0_IK &lt; index) then</span></a>
<a name="142"><span class="lineNum">     142 </span><span class="lineCov">        118 :             dirname = path(1_IK : index)</span></a>
<a name="143"><span class="lineNum">     143 </span>            :         else</a>
<a name="144"><span class="lineNum">     144 </span><span class="lineCov">         87 :             dirname = SKC_&quot;.&quot;</span></a>
<a name="145"><span class="lineNum">     145 </span>            :         end if</a>
<a name="146"><span class="lineNum">     146 </span>            : #elif   PM_ENABLED</a>
<a name="147"><span class="lineNum">     147 </span><span class="lineCov">        177 :         index = getIndexDirName(path, dirsep, style)</span></a>
<a name="148"><span class="lineNum">     148 </span><span class="lineCov">        177 :         dirname = path(1_IK : index)</span></a>
<a name="149"><span class="lineNum">     149 </span>            : #else</a>
<a name="150"><span class="lineNum">     150 </span>            : #error  &quot;Unrecognized interface.&quot;</a>
<a name="151"><span class="lineNum">     151 </span>            : #endif</a>
<a name="152"><span class="lineNum">     152 </span>            : </a>
<a name="153"><span class="lineNum">     153 </span>            :         !%%%%%%%%%%%%%%%%%%</a>
<a name="154"><span class="lineNum">     154 </span>            : #elif   getBaseName_ENABLED</a>
<a name="155"><span class="lineNum">     155 </span>            :         !%%%%%%%%%%%%%%%%%%</a>
<a name="156"><span class="lineNum">     156 </span>            : </a>
<a name="157"><span class="lineNum">     157 </span>            : #if     Def_ENABLED</a>
<a name="158"><span class="lineNum">     158 </span><span class="lineCov">        164 :         if (1_IK &lt; len(path, IK)) then</span></a>
<a name="159"><span class="lineNum">     159 </span>            :             block</a>
<a name="160"><span class="lineNum">     160 </span>            :                 integer(IK) :: offset</a>
<a name="161"><span class="lineNum">     161 </span>            :                 ! remove trailing directory separator duplicates.</a>
<a name="162"><span class="lineNum">     162 </span>            :                 offset = len(path, IK)</a>
<a name="163"><span class="lineNum">     163 </span><span class="lineCov">        136 :                 if (len(dirsep, IK) == 1_IK) then</span></a>
<a name="164"><span class="lineNum">     164 </span><span class="lineCov">         52 :                     do</span></a>
<a name="165"><span class="lineNum">     165 </span><span class="lineCov">        120 :                         if (offset &lt; 2_IK) exit</span></a>
<a name="166"><span class="lineNum">     166 </span><span class="lineCov">        108 :                         if (dirsep /= path(offset : offset)) exit</span></a>
<a name="167"><span class="lineNum">     167 </span><span class="lineCov">        108 :                         offset = offset - 1_IK</span></a>
<a name="168"><span class="lineNum">     168 </span>            :                     end do</a>
<a name="169"><span class="lineNum">     169 </span>            :                 else</a>
<a name="170"><span class="lineNum">     170 </span><span class="lineCov">         44 :                     do</span></a>
<a name="171"><span class="lineNum">     171 </span><span class="lineCov">        112 :                         if (offset &lt; 2_IK) exit</span></a>
<a name="172"><span class="lineNum">     172 </span><span class="lineCov">        100 :                         if (index(dirsep, path(offset : offset), kind = IK) == 0_IK) exit</span></a>
<a name="173"><span class="lineNum">     173 </span><span class="lineCov">        112 :                         offset = offset - 1_IK</span></a>
<a name="174"><span class="lineNum">     174 </span>            :                     end do</a>
<a name="175"><span class="lineNum">     175 </span>            :                 end if</a>
<a name="176"><span class="lineNum">     176 </span><span class="lineCov">        136 :                 basename = path(getIndexBaseName(path(1 : offset), dirsep) : offset)</span></a>
<a name="177"><span class="lineNum">     177 </span>            :             end block</a>
<a name="178"><span class="lineNum">     178 </span>            :         else</a>
<a name="179"><span class="lineNum">     179 </span><span class="lineCov">         28 :             basename = path</span></a>
<a name="180"><span class="lineNum">     180 </span>            :         end if</a>
<a name="181"><span class="lineNum">     181 </span>            : #elif   PM_ENABLED</a>
<a name="182"><span class="lineNum">     182 </span><span class="lineCov">        176 :         basename = path(getIndexBaseName(path, dirsep, style) :)</span></a>
<a name="183"><span class="lineNum">     183 </span>            : #else</a>
<a name="184"><span class="lineNum">     184 </span>            : #error  &quot;Unrecognized interface.&quot;</a>
<a name="185"><span class="lineNum">     185 </span>            : #endif</a>
<a name="186"><span class="lineNum">     186 </span>            : </a>
<a name="187"><span class="lineNum">     187 </span>            :         !%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</a>
<a name="188"><span class="lineNum">     188 </span>            : #elif   (getIndexDirName_ENABLED || getIndexBaseName_ENABLED) &amp;&amp; PM_ENABLED</a>
<a name="189"><span class="lineNum">     189 </span>            :         !%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</a>
<a name="190"><span class="lineNum">     190 </span>            : </a>
<a name="191"><span class="lineNum">     191 </span><span class="lineCov">        353 :         CHECK_ASSERTION(__LINE__, 0_IK &lt; len(dirsep, IK), MODULE_NAME//SK_&quot;: The input `0 &lt; len(dirsep)` must be a positive number. len(dirsep) = &quot;//getStr(len(dirsep, IK)))</span></a>
<a name="192"><span class="lineNum">     192 </span><span class="lineCov">        353 :         index = scan(path, dirsep, back = .true., kind = IK)</span></a>
<a name="193"><span class="lineNum">     193 </span>            : #if     getIndexBaseName_ENABLED</a>
<a name="194"><span class="lineNum">     194 </span><span class="lineCov">        176 :         index = index + 1_IK</span></a>
<a name="195"><span class="lineNum">     195 </span>            : #elif   !getIndexDirName_ENABLED</a>
<a name="196"><span class="lineNum">     196 </span>            : #error  &quot;Unrecognized interface.&quot;</a>
<a name="197"><span class="lineNum">     197 </span>            : #endif</a>
<a name="198"><span class="lineNum">     198 </span>            : </a>
<a name="199"><span class="lineNum">     199 </span>            :         !%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</a>
<a name="200"><span class="lineNum">     200 </span>            : #elif   (getIndexDirName_ENABLED || getIndexBaseName_ENABLED) &amp;&amp; Def_ENABLED</a>
<a name="201"><span class="lineNum">     201 </span>            :         !%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</a>
<a name="202"><span class="lineNum">     202 </span>            : </a>
<a name="203"><span class="lineNum">     203 </span>            :         integer(IK) :: offset</a>
<a name="204"><span class="lineNum">     204 </span><span class="lineCov">        521 :         CHECK_ASSERTION(__LINE__, 0_IK &lt; len(dirsep, IK), MODULE_NAME//SK_&quot;: The input `0 &lt; len(dirsep)` must be a positive number. len(dirsep) = &quot;//getStr(len(dirsep, IK)))</span></a>
<a name="205"><span class="lineNum">     205 </span>            : #if     getIndexDirName_ENABLED</a>
<a name="206"><span class="lineNum">     206 </span><span class="lineCov">        277 :         if (len(path, IK) &lt; 2_IK) then</span></a>
<a name="207"><span class="lineNum">     207 </span><span class="lineCov">         52 :             index = scan(path, dirsep, back = .true., kind = IK)</span></a>
<a name="208"><span class="lineNum">     208 </span>            :             !index = index + 1_IK</a>
<a name="209"><span class="lineNum">     209 </span><span class="lineCov">         52 :             return</span></a>
<a name="210"><span class="lineNum">     210 </span>            :         end if</a>
<a name="211"><span class="lineNum">     211 </span>            : #endif</a>
<a name="212"><span class="lineNum">     212 </span>            :         ! remove trailing directory separator duplicates.</a>
<a name="213"><span class="lineNum">     213 </span><span class="lineCov">        244 :         offset = len(path, IK)</span></a>
<a name="214"><span class="lineNum">     214 </span><span class="lineCov">        469 :         if (len(dirsep, IK) == 1_IK) then</span></a>
<a name="215"><span class="lineNum">     215 </span><span class="lineCov">         74 :             do</span></a>
<a name="216"><span class="lineNum">     216 </span><span class="lineCov">        407 :                 if (offset &lt; 2_IK) exit</span></a>
<a name="217"><span class="lineNum">     217 </span><span class="lineCov">        347 :                 if (dirsep /= path(offset : offset)) exit</span></a>
<a name="218"><span class="lineNum">     218 </span><span class="lineCov">        347 :                 offset = offset - 1_IK</span></a>
<a name="219"><span class="lineNum">     219 </span>            :             end do</a>
<a name="220"><span class="lineNum">     220 </span>            :         else</a>
<a name="221"><span class="lineNum">     221 </span>            :             block</a>
<a name="222"><span class="lineNum">     222 </span>            :                 intrinsic :: index</a>
<a name="223"><span class="lineNum">     223 </span><span class="lineCov">         44 :                 do</span></a>
<a name="224"><span class="lineNum">     224 </span><span class="lineCov">        180 :                     if (offset &lt; 2_IK) exit</span></a>
<a name="225"><span class="lineNum">     225 </span><span class="lineCov">        156 :                     if (index(dirsep, path(offset : offset), kind = IK) == 0_IK) exit</span></a>
<a name="226"><span class="lineNum">     226 </span><span class="lineCov">        180 :                     offset = offset - 1_IK</span></a>
<a name="227"><span class="lineNum">     227 </span>            :                 end do</a>
<a name="228"><span class="lineNum">     228 </span>            :             end block</a>
<a name="229"><span class="lineNum">     229 </span>            :         end if</a>
<a name="230"><span class="lineNum">     230 </span>            : #if     getIndexDirName_ENABLED</a>
<a name="231"><span class="lineNum">     231 </span>            :         block</a>
<a name="232"><span class="lineNum">     232 </span>            :             intrinsic :: index</a>
<a name="233"><span class="lineNum">     233 </span><span class="lineCov">        225 :             offset = scan(path(1 : offset), dirsep, back = .true., kind = IK)</span></a>
<a name="234"><span class="lineNum">     234 </span>            :             do</a>
<a name="235"><span class="lineNum">     235 </span><span class="lineCov">        253 :                 if (offset &lt; 2_IK) exit</span></a>
<a name="236"><span class="lineNum">     236 </span><span class="lineCov">         98 :                 offset = offset - 1_IK</span></a>
<a name="237"><span class="lineNum">     237 </span><span class="lineCov">        253 :                 if (index(dirsep, path(offset : offset), kind = IK) == 0_IK) exit</span></a>
<a name="238"><span class="lineNum">     238 </span>            :             end do</a>
<a name="239"><span class="lineNum">     239 </span><span class="lineCov">        225 :             if (offset == 2_IK) then ! `$(dirname &quot;../&quot;)` on POSIX command line yields `&quot;.&quot;`</span></a>
<a name="240"><span class="lineNum">     240 </span><span class="lineNoCov">          0 :                 if (path(1:2) == SKC_&quot;..&quot;) offset = 1_IK</span></a>
<a name="241"><span class="lineNum">     241 </span>            :             end if</a>
<a name="242"><span class="lineNum">     242 </span>            :         end block</a>
<a name="243"><span class="lineNum">     243 </span>            :         index = offset</a>
<a name="244"><span class="lineNum">     244 </span>            : #elif   getIndexBaseName_ENABLED</a>
<a name="245"><span class="lineNum">     245 </span><span class="lineCov">        244 :         index = scan(path(1 : offset - 1), dirsep, back = .true., kind = IK) + 1_IK</span></a>
<a name="246"><span class="lineNum">     246 </span>            : #else</a>
<a name="247"><span class="lineNum">     247 </span>            : #error  &quot;Unrecognized interface.&quot;</a>
<a name="248"><span class="lineNum">     248 </span>            : #endif</a>
<a name="249"><span class="lineNum">     249 </span>            : </a>
<a name="250"><span class="lineNum">     250 </span>            :         !%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</a>
<a name="251"><span class="lineNum">     251 </span>            : #elif   getDirSep_ENABLED || getDirSeps_ENABLED || getPathSep_ENABLED</a>
<a name="252"><span class="lineNum">     252 </span>            :         !%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</a>
<a name="253"><span class="lineNum">     253 </span>            : </a>
<a name="254"><span class="lineNum">     254 </span>            :         ! \warning</a>
<a name="255"><span class="lineNum">     255 </span>            :         ! We cannot use FPP macros because this is dependent on the runtime shell.</a>
<a name="256"><span class="lineNum">     256 </span><span class="lineCov">        178 :         type(shell_type) :: shell</span></a>
<a name="257"><span class="lineNum">     257 </span><span class="lineCov">        178 :         if (present(failed) .and. present(errmsg)) then</span></a>
<a name="258"><span class="lineNum">     258 </span><span class="lineCov">         82 :             shell = shell_type(failed, errmsg)</span></a>
<a name="259"><span class="lineNum">     259 </span><span class="lineCov">         96 :         elseif (present(failed)) then</span></a>
<a name="260"><span class="lineNum">     260 </span><span class="lineCov">         24 :             shell = shell_type(failed)</span></a>
<a name="261"><span class="lineNum">     261 </span>            :         else</a>
<a name="262"><span class="lineNum">     262 </span><span class="lineCov">         72 :             shell = shell_type()</span></a>
<a name="263"><span class="lineNum">     263 </span>            :         end if</a>
<a name="264"><span class="lineNum">     264 </span>            : #if     getDirSep_ENABLED</a>
<a name="265"><span class="lineNum">     265 </span><span class="lineCov">         57 :         dirsep = shell%dirsep</span></a>
<a name="266"><span class="lineNum">     266 </span>            : #elif   getDirSeps_ENABLED</a>
<a name="267"><span class="lineNum">     267 </span><span class="lineCov">         29 :         dirseps = shell%dirseps</span></a>
<a name="268"><span class="lineNum">     268 </span>            : #elif   getPathSep_ENABLED</a>
<a name="269"><span class="lineNum">     269 </span><span class="lineCov">         92 :         pathsep = shell%pathsep</span></a>
<a name="270"><span class="lineNum">     270 </span>            : #else</a>
<a name="271"><span class="lineNum">     271 </span>            : #error  &quot;Unrecognized interface.&quot;</a>
<a name="272"><span class="lineNum">     272 </span>            : #endif</a>
<a name="273"><span class="lineNum">     273 </span>            : </a>
<a name="274"><span class="lineNum">     274 </span>            :         !%%%%%%%%%%%%%%%%%%%%%%%%%</a>
<a name="275"><span class="lineNum">     275 </span>            : #elif   getPathVerbatimCMD_ENABLED</a>
<a name="276"><span class="lineNum">     276 </span>            :         !%%%%%%%%%%%%%%%%%%%%%%%%%</a>
<a name="277"><span class="lineNum">     277 </span>            : </a>
<a name="278"><span class="lineNum">     278 </span><span class="lineCov">         12 :         pathVerbatim = SKC_'&quot;'//getRemoved(path, SKC_'&quot;')//SKC_'&quot;'</span></a>
<a name="279"><span class="lineNum">     279 </span>            : </a>
<a name="280"><span class="lineNum">     280 </span>            :         !%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</a>
<a name="281"><span class="lineNum">     281 </span>            : #elif   getPathVerbatimPowerShell_ENABLED</a>
<a name="282"><span class="lineNum">     282 </span>            :         !%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</a>
<a name="283"><span class="lineNum">     283 </span>            : </a>
<a name="284"><span class="lineNum">     284 </span><span class="lineCov">         12 :         pathVerbatim = SKC_&quot;'&quot;//getReplaced(path, SKC_&quot;'&quot;, SKC_&quot;''&quot;)//SKC_&quot;'&quot;</span></a>
<a name="285"><span class="lineNum">     285 </span>            : </a>
<a name="286"><span class="lineNum">     286 </span>            :         !%%%%%%%%%%%%%%%%%%%%%%%%%%%</a>
<a name="287"><span class="lineNum">     287 </span>            : #elif   getPathVerbatimPosix_ENABLED</a>
<a name="288"><span class="lineNum">     288 </span>            :         !%%%%%%%%%%%%%%%%%%%%%%%%%%%</a>
<a name="289"><span class="lineNum">     289 </span>            : </a>
<a name="290"><span class="lineNum">     290 </span><span class="lineCov">        638 :         pathVerbatim = SKC_&quot;'&quot;//getReplaced(path, SKC_&quot;'&quot;, SKC_&quot;'\''&quot;)//SKC_&quot;'&quot;</span></a>
<a name="291"><span class="lineNum">     291 </span>            : </a>
<a name="292"><span class="lineNum">     292 </span>            :         !%%%%%%%%%%%%%%%%%%%%%%%%%%</a>
<a name="293"><span class="lineNum">     293 </span>            : #elif   getPathVerbatimFish_ENABLED</a>
<a name="294"><span class="lineNum">     294 </span>            :         !%%%%%%%%%%%%%%%%%%%%%%%%%%%</a>
<a name="295"><span class="lineNum">     295 </span>            : </a>
<a name="296"><span class="lineNum">     296 </span><span class="lineCov">         20 :         pathVerbatim = SKC_&quot;'&quot;//getReplaced(getReplaced(path, SKC_&quot;\&quot;, SKC_&quot;\\&quot;), SKC_&quot;'&quot;, SKC_&quot;\'&quot;)//SKC_&quot;'&quot;</span></a>
<a name="297"><span class="lineNum">     297 </span>            : </a>
<a name="298"><span class="lineNum">     298 </span>            :         !%%%%%%%%%%%%%%%%%%%%%%%%%%</a>
<a name="299"><span class="lineNum">     299 </span>            : #elif   getPathPosixEscaped_ENABLED</a>
<a name="300"><span class="lineNum">     300 </span>            :         !%%%%%%%%%%%%%%%%%%%%%%%%%%</a>
<a name="301"><span class="lineNum">     301 </span>            : </a>
<a name="302"><span class="lineNum">     302 </span>            :         call setPathPosixEscaped(pathEscaped, path)</a>
<a name="303"><span class="lineNum">     303 </span>            : </a>
<a name="304"><span class="lineNum">     304 </span>            :         !%%%%%%%%%%%%%%%%%%%%%%%%%%</a>
<a name="305"><span class="lineNum">     305 </span>            : #elif   setPathPosixEscaped_ENABLED</a>
<a name="306"><span class="lineNum">     306 </span>            :         !%%%%%%%%%%%%%%%%%%%%%%%%%%</a>
<a name="307"><span class="lineNum">     307 </span>            : </a>
<a name="308"><span class="lineNum">     308 </span>            :         character(1,SKC), parameter :: POSIX_RESERVED_CHR_SKC(*) = POSIX_RESERVED_CHR</a>
<a name="309"><span class="lineNum">     309 </span><span class="lineCov">        112 :         integer(IK) :: i, j, counter, lenPath, Loc(len(path, IK))</span></a>
<a name="310"><span class="lineNum">     310 </span>            :         lenPath = len(path, IK)</a>
<a name="311"><span class="lineNum">     311 </span><span class="lineCov">         56 :         if (lenPath == 0_IK) then</span></a>
<a name="312"><span class="lineNum">     312 </span><span class="lineCov">          8 :             pathEscaped = path</span></a>
<a name="313"><span class="lineNum">     313 </span>            :         else</a>
<a name="314"><span class="lineNum">     314 </span>            :             counter = 0_IK</a>
<a name="315"><span class="lineNum">     315 </span><span class="lineCov">        520 :             do i = 1_IK, lenPath</span></a>
<a name="316"><span class="lineNum">     316 </span><span class="lineCov">      23000 :                 loopOverShellEscapeChars: do j = 1_IK, size(POSIX_RESERVED_CHR_SKC, 1, IK)</span></a>
<a name="317"><span class="lineNum">     317 </span><span class="lineCov">      22952 :                     if (path(i:i) == POSIX_RESERVED_CHR_SKC(j)) then</span></a>
<a name="318"><span class="lineNum">     318 </span><span class="lineCov">         96 :                         counter = counter + 1_IK</span></a>
<a name="319"><span class="lineNum">     319 </span><span class="lineCov">         96 :                         Loc(counter) = i</span></a>
<a name="320"><span class="lineNum">     320 </span><span class="lineCov">         96 :                         exit loopOverShellEscapeChars</span></a>
<a name="321"><span class="lineNum">     321 </span>            :                     end if</a>
<a name="322"><span class="lineNum">     322 </span>            :                 end do loopOverShellEscapeChars</a>
<a name="323"><span class="lineNum">     323 </span>            :             end do</a>
<a name="324"><span class="lineNum">     324 </span><span class="lineCov">         48 :             allocate(character(lenPath + counter, SKC) :: pathEscaped)</span></a>
<a name="325"><span class="lineNum">     325 </span><span class="lineCov">         48 :             call setInserted(pathEscaped, path, SKC_&quot;\&quot;, Loc(1:counter))</span></a>
<a name="326"><span class="lineNum">     326 </span>            :         end if</a>
<a name="327"><span class="lineNum">     327 </span>            : </a>
<a name="328"><span class="lineNum">     328 </span>            :         !%%%%%%%%%%%%%%%%%%%</a>
<a name="329"><span class="lineNum">     329 </span>            : #elif   getPathPosix_ENABLED</a>
<a name="330"><span class="lineNum">     330 </span>            :         !%%%%%%%%%%%%%%%%%%%</a>
<a name="331"><span class="lineNum">     331 </span>            : </a>
<a name="332"><span class="lineNum">     332 </span><span class="lineCov">         28 :         pathPosix = path</span></a>
<a name="333"><span class="lineNum">     333 </span><span class="lineCov">         76 :         call setPathPosix(pathPosix, ignore)</span></a>
<a name="334"><span class="lineNum">     334 </span>            : </a>
<a name="335"><span class="lineNum">     335 </span>            :         !%%%%%%%%%%%%%%%%%%%%%</a>
<a name="336"><span class="lineNum">     336 </span>            : #elif   getPathWindows_ENABLED</a>
<a name="337"><span class="lineNum">     337 </span>            :         !%%%%%%%%%%%%%%%%%%%%%</a>
<a name="338"><span class="lineNum">     338 </span>            : </a>
<a name="339"><span class="lineNum">     339 </span><span class="lineCov">         80 :         pathWindows = path</span></a>
<a name="340"><span class="lineNum">     340 </span><span class="lineCov">        232 :         call setPathWindows(pathWindows, ignore)</span></a>
<a name="341"><span class="lineNum">     341 </span>            : </a>
<a name="342"><span class="lineNum">     342 </span>            :         !%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</a>
<a name="343"><span class="lineNum">     343 </span>            : #elif   setPathPosix_ENABLED || setPathWindows_ENABLED</a>
<a name="344"><span class="lineNum">     344 </span>            :         !%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</a>
<a name="345"><span class="lineNum">     345 </span>            : </a>
<a name="346"><span class="lineNum">     346 </span>            :         character(:,SKC), allocatable   :: pathNew</a>
<a name="347"><span class="lineNum">     347 </span>            :         character(*,SKC), parameter     :: PSA = DIR_SEP_ALL ! Path Separators All</a>
<a name="348"><span class="lineNum">     348 </span>            : #if     setPathPosix_ENABLED</a>
<a name="349"><span class="lineNum">     349 </span>            :         character(1,SKC), parameter     :: PSN = DIR_SEP_POSIX ! Path Separator Native</a>
<a name="350"><span class="lineNum">     350 </span>            : #elif   setPathWindows_ENABLED</a>
<a name="351"><span class="lineNum">     351 </span>            :         character(1,SKC), parameter     :: PSN = DIR_SEP_WINDOWS ! Path Separator Native</a>
<a name="352"><span class="lineNum">     352 </span>            : #endif</a>
<a name="353"><span class="lineNum">     353 </span>            :         integer(IK)                     :: i, j, lenPath, lenPathMin, lenIgnore, lenPathNew!, lenSeg, istart</a>
<a name="354"><span class="lineNum">     354 </span>            :        !logical(LK)                     :: isDot ! is pattern `PSN//&quot;.&quot;//PSN`.</a>
<a name="355"><span class="lineNum">     355 </span>            :         logical(LK)                     :: isSPS ! is significant slash (meaning that it is not preceded by a slash).</a>
<a name="356"><span class="lineNum">     356 </span>            : </a>
<a name="357"><span class="lineNum">     357 </span>            :         !   \warning</a>
<a name="358"><span class="lineNum">     358 </span>            :         !   The following code assumes that the Windows and posix directory separators will not change for the foreseeable future.</a>
<a name="359"><span class="lineNum">     359 </span>            :         !   As a layer of safety, the following code checks for the length DSWA to be 2 and its contents to have the posix directory separator.</a>
<a name="360"><span class="lineNum">     360 </span>            :         !error_stop_if(len(DSWA) /= 2, SK_&quot;@setPathPosix()/setPathWindows(): Internal library error occurred. The condition `len(DSWA) == 2` must hold.&quot;)</a>
<a name="361"><span class="lineNum">     361 </span>            :         !error_stop_if(len(DSWA) /= 2, SK_&quot;@setPathPosix()/setPathWindows(): Internal library error occurred. The condition `len(DSWA) == 2` must hold.&quot;)</a>
<a name="362"><span class="lineNum">     362 </span>            :         !error_stop_if(index(DSWA,PSN) == 0, SK_&quot;@setPathPosix()/setPathWindows(): Internal library error occurred. The condition `index(DSWA,PSN) &gt; 0` must hold.&quot;)</a>
<a name="363"><span class="lineNum">     363 </span>            : </a>
<a name="364"><span class="lineNum">     364 </span><span class="lineCov">        248 :         if (present(ignore)) then</span></a>
<a name="365"><span class="lineNum">     365 </span>            :             lenIgnore = len(ignore, IK)</a>
<a name="366"><span class="lineNum">     366 </span>            :         else</a>
<a name="367"><span class="lineNum">     367 </span>            :             lenIgnore = 0_IK</a>
<a name="368"><span class="lineNum">     368 </span>            :         end if</a>
<a name="369"><span class="lineNum">     369 </span>            : </a>
<a name="370"><span class="lineNum">     370 </span><span class="lineCov">        248 :         lenPath = len(path, IK)</span></a>
<a name="371"><span class="lineNum">     371 </span><span class="lineCov">        248 :         if (lenPath == 0_IK) return</span></a>
<a name="372"><span class="lineNum">     372 </span>            : </a>
<a name="373"><span class="lineNum">     373 </span>            :         !   Note that multiple `\` characters in sequence in Linux or Windows reduce to a single `\`. Therefore, ignore all `\` characters.</a>
<a name="374"><span class="lineNum">     374 </span>            :         !   Here we are assuming that the input path is convertible to a valid Windows path, meaning that no Windows reserved character appears in the path.</a>
<a name="375"><span class="lineNum">     375 </span>            :         !   If there are any such illegal characters (for example, double quotation marks) or Windows reserved words, we do not check for them here.</a>
<a name="376"><span class="lineNum">     376 </span>            :         !   Illegal Windows characters (particularly the double quotation mark) can be handled via `getPathVerbatimCMD()` and `getPathVerbatimPowerShell()`.</a>
<a name="377"><span class="lineNum">     377 </span>            : </a>
<a name="378"><span class="lineNum">     378 </span><span class="lineCov">        232 :         allocate(character(lenPath,SKC) :: pathNew)</span></a>
<a name="379"><span class="lineNum">     379 </span>            : </a>
<a name="380"><span class="lineNum">     380 </span>            :         ! Skip any UNC path root.</a>
<a name="381"><span class="lineNum">     381 </span>            : </a>
<a name="382"><span class="lineNum">     382 </span><span class="lineCov">        232 :         lenPathNew = getPathHostNameIndex(path, PSA)</span></a>
<a name="383"><span class="lineNum">     383 </span><span class="lineCov">        232 :         if (lenPathNew &gt; 0_IK) then</span></a>
<a name="384"><span class="lineNum">     384 </span><span class="lineCov">         24 :             if (lenIgnore == 0_IK) then</span></a>
<a name="385"><span class="lineNum">     385 </span><span class="lineCov">         24 :                 pathNew(1:2) = PSN//PSN</span></a>
<a name="386"><span class="lineNum">     386 </span><span class="lineNoCov">          0 :             elseif (lenIgnore == 2_IK .and. pathNew(1:2) == ignore) then</span></a>
<a name="387"><span class="lineNum">     387 </span><span class="lineNoCov">          0 :                 pathNew(1:2) = ignore</span></a>
<a name="388"><span class="lineNum">     388 </span>            :             else</a>
<a name="389"><span class="lineNum">     389 </span><span class="lineNoCov">          0 :                 pathNew(1:2) = PSN//PSN</span></a>
<a name="390"><span class="lineNum">     390 </span>            :             end if</a>
<a name="391"><span class="lineNum">     391 </span><span class="lineCov">         24 :             pathNew(3:lenPathNew) = path(3:lenPathNew)</span></a>
<a name="392"><span class="lineNum">     392 </span>            :         end if</a>
<a name="393"><span class="lineNum">     393 </span>            : </a>
<a name="394"><span class="lineNum">     394 </span>            :         ! Construct the normalized path.</a>
<a name="395"><span class="lineNum">     395 </span>            : </a>
<a name="396"><span class="lineNum">     396 </span>            :         isSPS = .true._LK</a>
<a name="397"><span class="lineNum">     397 </span>            :        !isSPS = .false._LK</a>
<a name="398"><span class="lineNum">     398 </span>            :        !isDot = .false._LK</a>
<a name="399"><span class="lineNum">     399 </span>            :        !istart = lenPathNew + 1_IK</a>
<a name="400"><span class="lineNum">     400 </span>            :        !i = istart</a>
<a name="401"><span class="lineNum">     401 </span><span class="lineCov">        232 :         i = lenPathNew + 1_IK</span></a>
<a name="402"><span class="lineNum">     402 </span>            :         lenPathMin = max(1_IK, lenPathNew)</a>
<a name="403"><span class="lineNum">     403 </span><span class="lineCov">        232 :         if (lenIgnore == 0_IK) then</span></a>
<a name="404"><span class="lineNum">     404 </span>            :             ! Remove trailing directory separators.</a>
<a name="405"><span class="lineNum">     405 </span>            :             !do</a>
<a name="406"><span class="lineNum">     406 </span>            :             !    if (lenPath == lenPathMin) exit</a>
<a name="407"><span class="lineNum">     407 </span>            :             !    if (scan(PSA, path(lenPath:lenPath), kind = IK) == 0_IK) exit</a>
<a name="408"><span class="lineNum">     408 </span>            :             !    lenPath = lenPath - 1_IK</a>
<a name="409"><span class="lineNum">     409 </span>            :             !end do</a>
<a name="410"><span class="lineNum">     410 </span><span class="lineCov">       1844 :             do</span></a>
<a name="411"><span class="lineNum">     411 </span><span class="lineCov">       2056 :                 if (i &gt; lenPath) exit</span></a>
<a name="412"><span class="lineNum">     412 </span>            : !#define         INCREMENT_PATH_NEW \</a>
<a name="413"><span class="lineNum">     413 </span>            : !                if (scan(PSA, path(i:i), kind = IK) == 0_IK) then; \</a>
<a name="414"><span class="lineNum">     414 </span>            : !                    lenPathNew = lenPathNew + 1_IK; \</a>
<a name="415"><span class="lineNum">     415 </span>            : !                    !isDot = path(i:i) == SKC_&quot;.&quot; .and. .not. isSPS; \</a>
<a name="416"><span class="lineNum">     416 </span>            : !                    pathNew(lenPathNew:lenPathNew) = path(i:i); \</a>
<a name="417"><span class="lineNum">     417 </span>            : !                    isSPS = .true._LK; \</a>
<a name="418"><span class="lineNum">     418 </span>            : !                elseif (isSPS) then; \</a>
<a name="419"><span class="lineNum">     419 </span>            : !               !elseif (isSPS .or. i == istart) then; \</a>
<a name="420"><span class="lineNum">     420 </span>            : !                    !if (isDot .and. lenPath &gt; 2_IK) then; \</a>
<a name="421"><span class="lineNum">     421 </span>            : !                    !    lenPathNew = lenPathNew - 1_IK; \</a>
<a name="422"><span class="lineNum">     422 </span>            : !                    !else; \</a>
<a name="423"><span class="lineNum">     423 </span>            : !                        lenPathNew = lenPathNew + 1_IK; \</a>
<a name="424"><span class="lineNum">     424 </span>            : !                        pathNew(lenPathNew:lenPathNew) = PSN; \</a>
<a name="425"><span class="lineNum">     425 </span>            : !                    !end if; \</a>
<a name="426"><span class="lineNum">     426 </span>            : !                    isSPS = .false._LK; \</a>
<a name="427"><span class="lineNum">     427 </span>            : !                end if; \</a>
<a name="428"><span class="lineNum">     428 </span>            : !                i = i + 1_IK;</a>
<a name="429"><span class="lineNum">     429 </span>            : #define         INCREMENT_PATH_NEW \</a>
<a name="430"><span class="lineNum">     430 </span>            :                 if (scan(PSA, path(i:i), kind = IK) == 0_IK) then; \</a>
<a name="431"><span class="lineNum">     431 </span>            :                     lenPathNew = lenPathNew + 1_IK; \</a>
<a name="432"><span class="lineNum">     432 </span>            :                     pathNew(lenPathNew:lenPathNew) = path(i:i); \</a>
<a name="433"><span class="lineNum">     433 </span>            :                     isSPS = .true._LK; \</a>
<a name="434"><span class="lineNum">     434 </span>            :                 elseif (isSPS) then; \</a>
<a name="435"><span class="lineNum">     435 </span>            :                     lenPathNew = lenPathNew + 1_IK; \</a>
<a name="436"><span class="lineNum">     436 </span>            :                     pathNew(lenPathNew:lenPathNew) = PSN; \</a>
<a name="437"><span class="lineNum">     437 </span>            :                     isSPS = .false._LK; \</a>
<a name="438"><span class="lineNum">     438 </span>            :                 end if; \</a>
<a name="439"><span class="lineNum">     439 </span>            :                 i = i + 1_IK;</a>
<a name="440"><span class="lineNum">     440 </span><span class="lineCov">       1844 :                 INCREMENT_PATH_NEW</span></a>
<a name="441"><span class="lineNum">     441 </span>            :             end do</a>
<a name="442"><span class="lineNum">     442 </span>            :         else</a>
<a name="443"><span class="lineNum">     443 </span>            :             !! first start index.</a>
<a name="444"><span class="lineNum">     444 </span>            :             !j = (lenPath / lenIgnore) * lenIgnore</a>
<a name="445"><span class="lineNum">     445 </span>            :             !if (j == lenPath) then</a>
<a name="446"><span class="lineNum">     446 </span>            :             !    j = lenPath - lenIgnore + 1_IK</a>
<a name="447"><span class="lineNum">     447 </span>            :             !else</a>
<a name="448"><span class="lineNum">     448 </span>            :             !    j = min((lenPath / lenIgnore) * lenIgnore + 1_IK, lenPath)</a>
<a name="449"><span class="lineNum">     449 </span>            :             !end if</a>
<a name="450"><span class="lineNum">     450 </span>            :             !! Trim dirsep from the end.</a>
<a name="451"><span class="lineNum">     451 </span>            :             !do</a>
<a name="452"><span class="lineNum">     452 </span>            :             !    if (lenPath == lenPathMin) exit</a>
<a name="453"><span class="lineNum">     453 </span>            :             !    lenSeg = min(lenPath,j+lenIgnore-1_IK) - j + 1_IK</a>
<a name="454"><span class="lineNum">     454 </span>            :             !    if (lenSeg == lenIgnore .and. path(j:j+lenSeg-1_IK) == ignore) exit</a>
<a name="455"><span class="lineNum">     455 </span>            :             !    if (scan(PSA, path(lenPath:lenPath), kind = IK) == 0_IK) exit</a>
<a name="456"><span class="lineNum">     456 </span>            :             !    lenPath = lenPath - 1_IK</a>
<a name="457"><span class="lineNum">     457 </span>            :             !    j = max(1_IK, j - 1_IK)</a>
<a name="458"><span class="lineNum">     458 </span>            :             !end do</a>
<a name="459"><span class="lineNum">     459 </span>            :             do</a>
<a name="460"><span class="lineNum">     460 </span><span class="lineCov">        284 :                 if (i &gt; lenPath) exit</span></a>
<a name="461"><span class="lineNum">     461 </span><span class="lineCov">        264 :                 j = min(i + lenIgnore - 1_IK, lenPath)</span></a>
<a name="462"><span class="lineNum">     462 </span><span class="lineCov">        284 :                 if (j - i + 1_IK == lenIgnore .and. path(i:j) == ignore) then</span></a>
<a name="463"><span class="lineNum">     463 </span><span class="lineCov">         40 :                     lenPathNew = lenPathNew + 1_IK ! Do not move this.</span></a>
<a name="464"><span class="lineNum">     464 </span><span class="lineCov">         40 :                     pathNew(lenPathNew : lenPathNew + lenIgnore - 1_IK) = ignore</span></a>
<a name="465"><span class="lineNum">     465 </span>            :                     lenPathNew = lenPathNew + lenIgnore - 1_IK</a>
<a name="466"><span class="lineNum">     466 </span>            :                     i = i + lenIgnore</a>
<a name="467"><span class="lineNum">     467 </span>            :                 else</a>
<a name="468"><span class="lineNum">     468 </span><span class="lineCov">        224 :                     INCREMENT_PATH_NEW</span></a>
<a name="469"><span class="lineNum">     469 </span>            :                 !else ! This should happen only occasionally when `j == lenPath` and path(i:j) must be padded for comparison with `ignore`.</a>
<a name="470"><span class="lineNum">     470 </span>            :                 !    lenPathNew = lenPathNew + 1_IK ! Do not move this.</a>
<a name="471"><span class="lineNum">     471 </span>            :                 !    pathNew(lenPathNew : lenPathNew + j - i + 1_IK) = path(i:j)</a>
<a name="472"><span class="lineNum">     472 </span>            :                 !    lenPathNew = lenPathNew + j - i + 1_IK</a>
<a name="473"><span class="lineNum">     473 </span>            :                 !    i = i + j - i + 2_IK</a>
<a name="474"><span class="lineNum">     474 </span>            :                 end if</a>
<a name="475"><span class="lineNum">     475 </span>            :             end do</a>
<a name="476"><span class="lineNum">     476 </span>            :         end if</a>
<a name="477"><span class="lineNum">     477 </span>            :         !#if     setPathPosix_ENABLED</a>
<a name="478"><span class="lineNum">     478 </span>            :         !        if (present(escaped)) then</a>
<a name="479"><span class="lineNum">     479 </span>            :         !            if (escaped) call setPathPosixEscaped(path, pathNew(1:lenPathNew))</a>
<a name="480"><span class="lineNum">     480 </span>            :         !            deallocate(pathNew) ! \bug : required because gfortran automatic deallocation of heap memory fails as of version 12.</a>
<a name="481"><span class="lineNum">     481 </span>            :         !            return</a>
<a name="482"><span class="lineNum">     482 </span>            :         !        end if</a>
<a name="483"><span class="lineNum">     483 </span>            :         !#endif</a>
<a name="484"><span class="lineNum">     484 </span><span class="lineCov">        232 :         if (lenPathNew &gt; 1_IK .and. pathNew(lenPathNew:lenPathNew) == PSN) lenPathNew = lenPathNew - 1_IK</span></a>
<a name="485"><span class="lineNum">     485 </span><span class="lineCov">        232 :         path = pathNew(1:lenPathNew)</span></a>
<a name="486"><span class="lineNum">     486 </span><span class="lineCov">        232 :         deallocate(pathNew) ! \bug : required because gfortran automatic deallocation of heap memory fails as of version 12.</span></a>
<a name="487"><span class="lineNum">     487 </span>            : </a>
<a name="488"><span class="lineNum">     488 </span>            : #undef  INCREMENT_PATH_NEW</a>
<a name="489"><span class="lineNum">     489 </span>            : </a>
<a name="490"><span class="lineNum">     490 </span>            :         !%%%%%%%%%%%%%%%%%%%%%%%%%%%</a>
<a name="491"><span class="lineNum">     491 </span>            : #elif   getPathHostNameIndex_ENABLED</a>
<a name="492"><span class="lineNum">     492 </span>            :         !%%%%%%%%%%%%%%%%%%%%%%%%%%%</a>
<a name="493"><span class="lineNum">     493 </span>            : </a>
<a name="494"><span class="lineNum">     494 </span>            :         integer(IK) :: lenPath</a>
<a name="495"><span class="lineNum">     495 </span>            :         index = 0_IK</a>
<a name="496"><span class="lineNum">     496 </span><span class="lineCov">        344 :         lenPath = len(path, IK)</span></a>
<a name="497"><span class="lineNum">     497 </span><span class="lineCov">        344 :         if (lenPath &lt; 3_IK) return</span></a>
<a name="498"><span class="lineNum">     498 </span><span class="lineCov">        284 :         if (scan(dirsep, path(1:1), kind = IK) == 0_IK) return</span></a>
<a name="499"><span class="lineNum">     499 </span><span class="lineCov">        120 :         if (scan(dirsep, path(2:2), kind = IK) == 0_IK) return</span></a>
<a name="500"><span class="lineNum">     500 </span><span class="lineCov">         96 :         if (scan(dirsep, path(3:3), kind = IK)  &gt; 0_IK) return</span></a>
<a name="501"><span class="lineNum">     501 </span>            :         index = 3_IK</a>
<a name="502"><span class="lineNum">     502 </span>            :         do</a>
<a name="503"><span class="lineNum">     503 </span><span class="lineCov">        376 :             index = index + 1_IK</span></a>
<a name="504"><span class="lineNum">     504 </span><span class="lineCov">        376 :             if (index &gt; lenPath) exit</span></a>
<a name="505"><span class="lineNum">     505 </span><span class="lineCov">        376 :             if (scan(dirsep, path(index:index), kind = IK) &gt; 0_IK) exit</span></a>
<a name="506"><span class="lineNum">     506 </span>            :         end do</a>
<a name="507"><span class="lineNum">     507 </span>            :         index = index - 1_IK</a>
<a name="508"><span class="lineNum">     508 </span>            : </a>
<a name="509"><span class="lineNum">     509 </span>            :         !%%%%%%%%%%%%%%%%%%%%%</a>
<a name="510"><span class="lineNum">     510 </span>            : #elif   hasDriveLetter_ENABLED</a>
<a name="511"><span class="lineNum">     511 </span>            :         !%%%%%%%%%%%%%%%%%%%%%</a>
<a name="512"><span class="lineNum">     512 </span>            : </a>
<a name="513"><span class="lineNum">     513 </span><span class="lineCov">        128 :         if (len(path,IK) &gt; 1_IK) then</span></a>
<a name="514"><span class="lineNum">     514 </span><span class="lineCov">        112 :             pathHasDriveLetter = isCharAlpha(path(1:1)) .and. path(2:2) == SKC_&quot;:&quot;</span></a>
<a name="515"><span class="lineNum">     515 </span>            :         else</a>
<a name="516"><span class="lineNum">     516 </span>            :             pathHasDriveLetter = .false._LK</a>
<a name="517"><span class="lineNum">     517 </span>            :         end if</a>
<a name="518"><span class="lineNum">     518 </span>            : </a>
<a name="519"><span class="lineNum">     519 </span>            :         !%%%%%%%%%%%%%%%%%%%%%%%</a>
<a name="520"><span class="lineNum">     520 </span>            : #elif   isPathAbsWindows_ENABLED</a>
<a name="521"><span class="lineNum">     521 </span>            :         !%%%%%%%%%%%%%%%%%%%%%%%</a>
<a name="522"><span class="lineNum">     522 </span>            : </a>
<a name="523"><span class="lineNum">     523 </span>            :         character(*,SKC), parameter :: DSWA = DIR_SEP_WINDOWS_ALL</a>
<a name="524"><span class="lineNum">     524 </span>            :         ERROR_STOP_IF(len(DSWA) /= 2, MODULE_NAME//SK_&quot;@isPathAbsWindows(): Internal library error occurred. The condition `len(DSWA) == 2` must hold.&quot;)</a>
<a name="525"><span class="lineNum">     525 </span>            : </a>
<a name="526"><span class="lineNum">     526 </span><span class="lineCov">         84 :         if (len(path, IK) &gt; 2_IK) then</span></a>
<a name="527"><span class="lineNum">     527 </span>            :             !pathIsAbs = logical(index(DSWA, path(1:1), kind = IK) &gt; 0_IK, LK)</a>
<a name="528"><span class="lineNum">     528 </span><span class="lineCov">         56 :             pathIsAbs = hasDriveLetter(path) .and. scan(DSWA, path(3:3), kind = IK) &gt; 0_IK ! (path(3:3) == DSWA(1:1) .or. path(3:3) == DSWA(2:2)) ! \bug gfortran 11 bug: Error: Operands of comparison operator '==' at (1) are CHARACTER(*,4)/CHARACTER(1)</span></a>
<a name="529"><span class="lineNum">     529 </span>            :             if (pathIsAbs) return</a>
<a name="530"><span class="lineNum">     530 </span>            :         end if</a>
<a name="531"><span class="lineNum">     531 </span>            : </a>
<a name="532"><span class="lineNum">     532 </span><span class="lineCov">         76 :         if (len(path, IK) &gt; 1_IK) then</span></a>
<a name="533"><span class="lineNum">     533 </span>            :            !pathIsAbs = (path(1:1) == DSWA(1:1) .or. path(1:1) == DSWA(2:2)) .and. (path(2:2) == DSWA(1:1) .or. path(2:2) == DSWA(2:2)) ! \bug gfortran 11 bug: Error: Operands of comparison operator '==' at (1) are CHARACTER(*,4)/CHARACTER(1)</a>
<a name="534"><span class="lineNum">     534 </span><span class="lineCov">         60 :             pathIsAbs = verify(path(1:2), DSWA, kind = IK) == 0_IK</span></a>
<a name="535"><span class="lineNum">     535 </span><span class="lineCov">         60 :             if (pathIsAbs) return</span></a>
<a name="536"><span class="lineNum">     536 </span>            :         end if</a>
<a name="537"><span class="lineNum">     537 </span>            : </a>
<a name="538"><span class="lineNum">     538 </span>            :         pathIsAbs = .false._LK</a>
<a name="539"><span class="lineNum">     539 </span>            : </a>
<a name="540"><span class="lineNum">     540 </span>            :         !%%%%%%%%%%%%%%%%%%%%%</a>
<a name="541"><span class="lineNum">     541 </span>            : #elif   isPathAbsPosix_ENABLED</a>
<a name="542"><span class="lineNum">     542 </span>            :         !%%%%%%%%%%%%%%%%%%%%%</a>
<a name="543"><span class="lineNum">     543 </span>            : </a>
<a name="544"><span class="lineNum">     544 </span>            :         character(*,SKC), parameter :: DSPA = DIR_SEP_POSIX_ALL</a>
<a name="545"><span class="lineNum">     545 </span>            :         ERROR_STOP_IF(len(DSPA) &gt; 1, MODULE_NAME//SK_&quot;@isPathAbsPosix(): Internal error occurred. `len(DSPA) == 1` must hold.&quot;)</a>
<a name="546"><span class="lineNum">     546 </span><span class="lineCov">        155 :         if (len(path, IK) &gt; 0_IK) then</span></a>
<a name="547"><span class="lineNum">     547 </span><span class="lineCov">        151 :             pathIsAbs = logical(path(1:1) == DSPA, LK)</span></a>
<a name="548"><span class="lineNum">     548 </span>            :         else</a>
<a name="549"><span class="lineNum">     549 </span>            :             pathIsAbs = .false._LK</a>
<a name="550"><span class="lineNum">     550 </span>            :         end if</a>
<a name="551"><span class="lineNum">     551 </span>            : </a>
<a name="552"><span class="lineNum">     552 </span>            :         !%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</a>
<a name="553"><span class="lineNum">     553 </span>            : #elif   isFailedGlob_ENABLED &amp;&amp; BSSK_ENABLED</a>
<a name="554"><span class="lineNum">     554 </span>            :         !%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</a>
<a name="555"><span class="lineNum">     555 </span>            : </a>
<a name="556"><span class="lineNum">     556 </span>            :         integer(IK) :: iloc, nloc</a>
<a name="557"><span class="lineNum">     557 </span>            :         integer(IK), allocatable :: index(:,:)</a>
<a name="558"><span class="lineNum">     558 </span><span class="lineCov">         53 :         character(:,SKC), allocatable :: contents</span></a>
<a name="559"><span class="lineNum">     559 </span><span class="lineCov">         53 :         failed = isFailedGlob(pattern, contents, index, errmsg)</span></a>
<a name="560"><span class="lineNum">     560 </span><span class="lineCov">         53 :         nloc = size(index, 2, IK)</span></a>
<a name="561"><span class="lineNum">     561 </span><span class="lineCov">       1209 :         allocate(list(nloc))</span></a>
<a name="562"><span class="lineNum">     562 </span>            :         do concurrent(iloc = 1 : nloc)</a>
<a name="563"><span class="lineNum">     563 </span><span class="lineCov">       1209 :             list(iloc)%val = contents(index(1, iloc) : index(2, iloc))</span></a>
<a name="564"><span class="lineNum">     564 </span>            :         end do</a>
<a name="565"><span class="lineNum">     565 </span>            : </a>
<a name="566"><span class="lineNum">     566 </span>            :         !%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</a>
<a name="567"><span class="lineNum">     567 </span>            : #elif   isFailedGlob_ENABLED &amp;&amp; SK_ENABLED</a>
<a name="568"><span class="lineNum">     568 </span>            :         !%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</a>
<a name="569"><span class="lineNum">     569 </span>            : </a>
<a name="570"><span class="lineNum">     570 </span>            :         character(*, SK), parameter :: NLC = new_line(SKC_&quot;a&quot;)</a>
<a name="571"><span class="lineNum">     571 </span>            :         character(*, SK), parameter :: PROCEDURE_NAME = MODULE_NAME//SK_&quot;@isFailedGlob()&quot;</a>
<a name="572"><span class="lineNum">     572 </span>            :         character(:,SKC), allocatable :: command, errmsg_def</a>
<a name="573"><span class="lineNum">     573 </span>            :         integer(IK) :: exitstat, iell</a>
<a name="574"><span class="lineNum">     574 </span><span class="lineCov">         81 :         type(shell_type) :: shell</span></a>
<a name="575"><span class="lineNum">     575 </span>            : </a>
<a name="576"><span class="lineNum">     576 </span><span class="lineCov">         81 :         if (present(errmsg)) then</span></a>
<a name="577"><span class="lineNum">     577 </span><span class="lineCov">         53 :             allocate(character(len(errmsg, IK), SK) :: errmsg_def)</span></a>
<a name="578"><span class="lineNum">     578 </span>            :         else</a>
<a name="579"><span class="lineNum">     579 </span><span class="lineCov">         28 :             allocate(character(31, SK) :: errmsg_def)</span></a>
<a name="580"><span class="lineNum">     580 </span>            :         end if</a>
<a name="581"><span class="lineNum">     581 </span>            : </a>
<a name="582"><span class="lineNum">     582 </span>            :         ! Infer the runtime shell.</a>
<a name="583"><span class="lineNum">     583 </span>            : </a>
<a name="584"><span class="lineNum">     584 </span><span class="lineCov">         81 :         shell = shell_type(failed, errmsg_def)</span></a>
<a name="585"><span class="lineNum">     585 </span><span class="lineCov">         81 :         if (failed) then</span></a>
<a name="586"><span class="lineNum">     586 </span>            :             if (present(errmsg)) errmsg = PROCEDURE_NAME//SK_&quot;: &quot;//trim(errmsg_def) ! LCOV_EXCL_LINE</a>
<a name="587"><span class="lineNum">     587 </span>            :             return ! LCOV_EXCL_LINE</a>
<a name="588"><span class="lineNum">     588 </span>            :         end if</a>
<a name="589"><span class="lineNum">     589 </span>            : </a>
<a name="590"><span class="lineNum">     590 </span>            :         ! Determine sorting method.</a>
<a name="591"><span class="lineNum">     591 </span>            : </a>
<a name="592"><span class="lineNum">     592 </span><span class="lineCov">         81 :         if (shell%is%powershell .or. shell%is%cmd) then</span></a>
<a name="593"><span class="lineNum">     593 </span><span class="lineNoCov">          0 :             command = SKC_&quot;(Resolve-Path &quot;//getPathVerbatimPowerShell(pattern)//SKC_&quot;).path&quot;</span></a>
<a name="594"><span class="lineNum">     594 </span><span class="lineNoCov">          0 :             if (shell%is%cmd) command = SKC_&quot;powershell -command &quot;//command</span></a>
<a name="595"><span class="lineNum">     595 </span><span class="lineCov">         81 :         elseif (shell%is%bash .or. shell%is%ksh .or. shell%is%zsh) then</span></a>
<a name="596"><span class="lineNum">     596 </span><span class="lineNoCov">          0 :             command = getCommandBashStyle(pattern)</span></a>
<a name="597"><span class="lineNum">     597 </span>            :         else</a>
<a name="598"><span class="lineNum">     598 </span>            :             ! check if bash exists on the system.</a>
<a name="599"><span class="lineNum">     599 </span><span class="lineCov">         81 :             failed = isFailedExec(SKC_&quot;bash --version &gt; /dev/null 2&gt;&amp;1&quot;)</span></a>
<a name="600"><span class="lineNum">     600 </span><span class="lineCov">         81 :             if (failed) then</span></a>
<a name="601"><span class="lineNum">     601 </span>            :                 if (present(errmsg)) errmsg = PROCEDURE_NAME//SK_&quot;: Unsupported runtime shell: &quot;//shell%name ! LCOV_EXCL_LINE</a>
<a name="602"><span class="lineNum">     602 </span>            :                 return ! LCOV_EXCL_LINE</a>
<a name="603"><span class="lineNum">     603 </span>            :             end if</a>
<a name="604"><span class="lineNum">     604 </span><span class="lineCov">         81 :             command = SKC_&quot;bash -c &quot;//getPathVerbatimPosix(getCommandBashStyle(pattern))</span></a>
<a name="605"><span class="lineNum">     605 </span>            :         end if</a>
<a name="606"><span class="lineNum">     606 </span>            : </a>
<a name="607"><span class="lineNum">     607 </span>            :         ! Fetch the list.</a>
<a name="608"><span class="lineNum">     608 </span>            : </a>
<a name="609"><span class="lineNum">     609 </span><span class="lineCov">         81 :         failed = isFailedGetOutput(command, list, errmsg_def, exitstat = exitstat)</span></a>
<a name="610"><span class="lineNum">     610 </span><span class="lineCov">         81 :         if (failed) then</span></a>
<a name="611"><span class="lineNum">     611 </span>            :             if (present(errmsg)) errmsg = PROCEDURE_NAME//SK_&quot;: &quot;//trim(errmsg_def) ! LCOV_EXCL_LINE</a>
<a name="612"><span class="lineNum">     612 </span>            :             return ! LCOV_EXCL_LINE</a>
<a name="613"><span class="lineNum">     613 </span><span class="lineCov">         81 :         elseif (exitstat /= 0_IK) then</span></a>
<a name="614"><span class="lineNum">     614 </span><span class="lineNoCov">          0 :             index = reshape([integer(IK) ::], [0,0])</span></a>
<a name="615"><span class="lineNum">     615 </span><span class="lineNoCov">          0 :             list = SKC_&quot;&quot;</span></a>
<a name="616"><span class="lineNum">     616 </span><span class="lineNoCov">          0 :             return</span></a>
<a name="617"><span class="lineNum">     617 </span>            :         end if</a>
<a name="618"><span class="lineNum">     618 </span>            : </a>
<a name="619"><span class="lineNum">     619 </span><span class="lineCov">         81 :         exitstat = 0_IK</span></a>
<a name="620"><span class="lineNum">     620 </span><span class="lineCov">         81 :         call setSplit(index, list, NLC)</span></a>
<a name="621"><span class="lineNum">     621 </span><span class="lineCov">       2603 :         do iell = 1, size(index, 2, IK)</span></a>
<a name="622"><span class="lineNum">     622 </span><span class="lineCov">       4849 :             if (.not. isExtant(list(index(1, iell) : index(2, iell)), exitstat, errmsg)) then</span></a>
<a name="623"><span class="lineNum">     623 </span><span class="lineCov">         21 :                 index = reshape([integer(IK) ::], [0, 0])</span></a>
<a name="624"><span class="lineNum">     624 </span><span class="lineCov">         21 :                 list = SKC_&quot;&quot;</span></a>
<a name="625"><span class="lineNum">     625 </span><span class="lineCov">         21 :                 return</span></a>
<a name="626"><span class="lineNum">     626 </span><span class="lineCov">       2360 :             elseif (exitstat /= 0) then</span></a>
<a name="627"><span class="lineNum">     627 </span>            :                 failed = .true._LK ! LCOV_EXCL_LINE</a>
<a name="628"><span class="lineNum">     628 </span>            :                 if (present(errmsg)) errmsg = PROCEDURE_NAME//SK_&quot;: Failed while verifying the existence of &quot;&quot;&quot;// &amp; ! LCOV_EXCL_LINE</a>
<a name="629"><span class="lineNum">     629 </span>            :                 list(index(1, iell) : index(2, iell))//SK_&quot;&quot;&quot;. &quot;//trim(errmsg) ! LCOV_EXCL_LINE</a>
<a name="630"><span class="lineNum">     630 </span>            :                 return ! LCOV_EXCL_LINE</a>
<a name="631"><span class="lineNum">     631 </span>            :             end if</a>
<a name="632"><span class="lineNum">     632 </span>            :         end do</a>
<a name="633"><span class="lineNum">     633 </span>            : </a>
<a name="634"><span class="lineNum">     634 </span>            :     contains</a>
<a name="635"><span class="lineNum">     635 </span>            : </a>
<a name="636"><span class="lineNum">     636 </span><span class="lineCov">         81 :         PURE function getCommandBashStyle(pattern) result(command)</span></a>
<a name="637"><span class="lineNum">     637 </span>            :             character(*,SKC), intent(in) :: pattern</a>
<a name="638"><span class="lineNum">     638 </span>            :             character(:,SKC), allocatable :: command</a>
<a name="639"><span class="lineNum">     639 </span><span class="lineCov">         81 :             command = getReplaced(getReplaced(getPathVerbatimPosix(pattern), SKC_&quot;*&quot;, SKC_&quot;'*'&quot;), SKC_&quot;?&quot;, SKC_&quot;'?'&quot;)</span></a>
<a name="640"><span class="lineNum">     640 </span><span class="lineCov">         81 :             command = SKC_&quot;list=(&quot;//command//SKC_&quot;); for file in &quot;&quot;${list[@]}&quot;&quot;; do echo &quot;&quot;$file&quot;&quot;; done&quot;</span></a>
<a name="641"><span class="lineNum">     641 </span><span class="lineCov">         81 :         end function</span></a>
<a name="642"><span class="lineNum">     642 </span>            : </a>
<a name="643"><span class="lineNum">     643 </span>            :         !%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</a>
<a name="644"><span class="lineNum">     644 </span>            : #elif   isFailedList_ENABLED &amp;&amp; BSSK_ENABLED</a>
<a name="645"><span class="lineNum">     645 </span>            :         !%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</a>
<a name="646"><span class="lineNum">     646 </span>            : </a>
<a name="647"><span class="lineNum">     647 </span>            :         integer(IK) :: iloc, nloc</a>
<a name="648"><span class="lineNum">     648 </span>            :         integer(IK), allocatable :: index(:,:)</a>
<a name="649"><span class="lineNum">     649 </span><span class="lineCov">        260 :         character(:,SKC), allocatable :: contents</span></a>
<a name="650"><span class="lineNum">     650 </span><span class="lineCov">        780 :         failed = isFailedList(path, contents, index, sort, showdir, showfile, showhidden, reversed, errmsg)</span></a>
<a name="651"><span class="lineNum">     651 </span><span class="lineCov">        260 :         nloc = size(index, 2, IK)</span></a>
<a name="652"><span class="lineNum">     652 </span><span class="lineCov">       1468 :         allocate(list(nloc))</span></a>
<a name="653"><span class="lineNum">     653 </span>            :         do concurrent(iloc = 1 : nloc)</a>
<a name="654"><span class="lineNum">     654 </span><span class="lineCov">       1468 :             list(iloc)%val = contents(index(1, iloc) : index(2, iloc))</span></a>
<a name="655"><span class="lineNum">     655 </span>            :         end do</a>
<a name="656"><span class="lineNum">     656 </span>            : </a>
<a name="657"><span class="lineNum">     657 </span>            :         !%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</a>
<a name="658"><span class="lineNum">     658 </span>            : #elif   isFailedList_ENABLED &amp;&amp; SK_ENABLED</a>
<a name="659"><span class="lineNum">     659 </span>            :         !%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</a>
<a name="660"><span class="lineNum">     660 </span>            : </a>
<a name="661"><span class="lineNum">     661 </span>            :         character(*, SK), parameter :: NLC = new_line(SKC_&quot;a&quot;)</a>
<a name="662"><span class="lineNum">     662 </span>            :         character(*, SK), parameter :: PROCEDURE_NAME = MODULE_NAME//SK_&quot;@isFailedList()&quot;</a>
<a name="663"><span class="lineNum">     663 </span><span class="lineCov">        268 :         character(:,SKC), allocatable :: command, dirlist, filelist, errmsg_def</span></a>
<a name="664"><span class="lineNum">     664 </span>            :         integer(IK) , allocatable :: dirIndex(:,:), fileIndex(:,:)</a>
<a name="665"><span class="lineNum">     665 </span>            :         integer(IK) :: lenList, istart, endloc, i, exitstat</a>
<a name="666"><span class="lineNum">     666 </span>            :         logical(LK) :: showhidden_def</a>
<a name="667"><span class="lineNum">     667 </span>            :         logical(LK) :: reversed_def</a>
<a name="668"><span class="lineNum">     668 </span>            :         logical(LK) :: showfile_def</a>
<a name="669"><span class="lineNum">     669 </span>            :         logical(LK) :: showdir_def</a>
<a name="670"><span class="lineNum">     670 </span><span class="lineCov">        268 :         type(shell_type) :: shell</span></a>
<a name="671"><span class="lineNum">     671 </span>            : </a>
<a name="672"><span class="lineNum">     672 </span><span class="lineCov">        268 :         if (present(errmsg)) then</span></a>
<a name="673"><span class="lineNum">     673 </span><span class="lineCov">        260 :             allocate(character(len(errmsg,IK), SK) :: errmsg_def)</span></a>
<a name="674"><span class="lineNum">     674 </span>            :         else</a>
<a name="675"><span class="lineNum">     675 </span><span class="lineCov">          8 :             allocate(character(31, SK) :: errmsg_def)</span></a>
<a name="676"><span class="lineNum">     676 </span>            :         end if</a>
<a name="677"><span class="lineNum">     677 </span>            : </a>
<a name="678"><span class="lineNum">     678 </span><span class="lineCov">        268 :         if (present(reversed)) then</span></a>
<a name="679"><span class="lineNum">     679 </span><span class="lineNoCov">          0 :             reversed_def = reversed</span></a>
<a name="680"><span class="lineNum">     680 </span>            :         else</a>
<a name="681"><span class="lineNum">     681 </span>            :             reversed_def = .false._LK</a>
<a name="682"><span class="lineNum">     682 </span>            :         end if</a>
<a name="683"><span class="lineNum">     683 </span>            : </a>
<a name="684"><span class="lineNum">     684 </span><span class="lineCov">        268 :         if (present(showdir)) then</span></a>
<a name="685"><span class="lineNum">     685 </span><span class="lineNoCov">          0 :             showdir_def = showdir</span></a>
<a name="686"><span class="lineNum">     686 </span>            :         else</a>
<a name="687"><span class="lineNum">     687 </span>            :             showdir_def = .true._LK</a>
<a name="688"><span class="lineNum">     688 </span>            :         end if</a>
<a name="689"><span class="lineNum">     689 </span>            : </a>
<a name="690"><span class="lineNum">     690 </span><span class="lineCov">        268 :         if (present(showfile)) then</span></a>
<a name="691"><span class="lineNum">     691 </span><span class="lineNoCov">          0 :             showfile_def = showfile</span></a>
<a name="692"><span class="lineNum">     692 </span>            :         else</a>
<a name="693"><span class="lineNum">     693 </span>            :             showfile_def = .true._LK</a>
<a name="694"><span class="lineNum">     694 </span>            :         end if</a>
<a name="695"><span class="lineNum">     695 </span>            : </a>
<a name="696"><span class="lineNum">     696 </span><span class="lineCov">        268 :         if (present(showhidden)) then</span></a>
<a name="697"><span class="lineNum">     697 </span><span class="lineNoCov">          0 :             showhidden_def = showhidden</span></a>
<a name="698"><span class="lineNum">     698 </span>            :         else</a>
<a name="699"><span class="lineNum">     699 </span>            :             showhidden_def = .true._LK</a>
<a name="700"><span class="lineNum">     700 </span>            :         end if</a>
<a name="701"><span class="lineNum">     701 </span>            : </a>
<a name="702"><span class="lineNum">     702 </span>            :         ! Infer the runtime shell.</a>
<a name="703"><span class="lineNum">     703 </span>            : </a>
<a name="704"><span class="lineNum">     704 </span><span class="lineCov">        268 :         shell = shell_type(failed, errmsg_def)</span></a>
<a name="705"><span class="lineNum">     705 </span><span class="lineCov">        268 :         if (failed) then</span></a>
<a name="706"><span class="lineNum">     706 </span>            :             if (present(errmsg)) errmsg = PROCEDURE_NAME//SK_&quot;: &quot;//trim(errmsg_def) ! LCOV_EXCL_LINE</a>
<a name="707"><span class="lineNum">     707 </span>            :             return ! LCOV_EXCL_LINE</a>
<a name="708"><span class="lineNum">     708 </span>            :         end if</a>
<a name="709"><span class="lineNum">     709 </span>            : </a>
<a name="710"><span class="lineNum">     710 </span>            :         ! Determine sorting method.</a>
<a name="711"><span class="lineNum">     711 </span>            : </a>
<a name="712"><span class="lineNum">     712 </span><span class="lineCov">        360 :         if (shell%is%posix .or. shell%is%fish) then</span></a>
<a name="713"><span class="lineNum">     713 </span>            : </a>
<a name="714"><span class="lineNum">     714 </span>            :             !   `ls` flags:</a>
<a name="715"><span class="lineNum">     715 </span>            :             !   -a, --all                   :   do not ignore entries starting with `.`.</a>
<a name="716"><span class="lineNum">     716 </span>            :             !   -Q, --quote-name            :   enclose entry names in double quotes.</a>
<a name="717"><span class="lineNum">     717 </span>            :             !   -A, --almost-all            :   do not list implied `.` and `..`.</a>
<a name="718"><span class="lineNum">     718 </span>            :             !   -b, --escape                :   print C-style escapes for nongraphic characters.</a>
<a name="719"><span class="lineNum">     719 </span>            :             !   -c with -lt                 :   sort by, and show, ctime (time of last modification of file status information); with -l: show ctime and sort by name; otherwise: sort by ctime, newest first.</a>
<a name="720"><span class="lineNum">     720 </span>            :             !   -F, --classify              :   append indicator (one of */=&gt;@|) to entries. Display</a>
<a name="721"><span class="lineNum">     721 </span>            :             !                                       -#  a slash (/) immediately after each pathname that is a directory,</a>
<a name="722"><span class="lineNum">     722 </span>            :             !                                       -#  an asterisk (`*') after each that is executable,</a>
<a name="723"><span class="lineNum">     723 </span>            :             !                                       -#  an at sign (`@') after each symbolic link,</a>
<a name="724"><span class="lineNum">     724 </span>            :             !                                       -#  a percent sign (`%') after each whiteout,</a>
<a name="725"><span class="lineNum">     725 </span>            :             !                                       -#  an equal sign (`=') after each socket,</a>
<a name="726"><span class="lineNum">     726 </span>            :             !                                       -#  avertical bar (`|') after each that is a FIFO.</a>
<a name="727"><span class="lineNum">     727 </span>            :             !   --group-directories-first   :   group directories before files; can be augmented with a `--sort` option, but any use of `--sort=none` (`-U`) disables grouping.</a>
<a name="728"><span class="lineNum">     728 </span>            :             !   -G, --no-group              :   in a long listing, don't print group names</a>
<a name="729"><span class="lineNum">     729 </span>            :             !   -h, --human-readable        :   with -l and -s, print sizes like 1K 234M 2G etc.</a>
<a name="730"><span class="lineNum">     730 </span>            :             !   -H                          :   Evaluate the file information and file type for symbolic links specified on the command line to be those of the file referenced by the link, and not the link itself;</a>
<a name="731"><span class="lineNum">     731 </span>            :             !                                   however, ls shall write the name of the link itself and not the file referenced by the link.</a>
<a name="732"><span class="lineNum">     732 </span>            :             !   -L                          :   Evaluate the file information and file type for all symbolic links (whether named on the command line or encountered in a file hierarchy)</a>
<a name="733"><span class="lineNum">     733 </span>            :             !                                   to be those of the file referenced by the link, and not the link itself; however, ls shall write the name of the link itself and not the file referenced by the link.</a>
<a name="734"><span class="lineNum">     734 </span>            :             !                                   When -L is used with -l, write the contents of symbolic links in the long format (see the STDOUT section).</a>
<a name="735"><span class="lineNum">     735 </span>            :             !   -k, --kibibytes             :   default to 1024-byte blocks for disk usage; used only with `-s` and per directory totals.</a>
<a name="736"><span class="lineNum">     736 </span>            :             !   -m                          :   fill width with a comma separated list of entries.</a>
<a name="737"><span class="lineNum">     737 </span>            :             !   -p, --indicator-style=slash :   append / indicator to directories.</a>
<a name="738"><span class="lineNum">     738 </span>            :             !   -Q, --quote-name            :   enclose entry names in double quotes.</a>
<a name="739"><span class="lineNum">     739 </span>            :             !   --quoting-style=WORD        :   use quoting style WORD for entry names: `literal`, `locale`, `shell`, `shell-always`, `shell-escape`, `shell-escape-always`, `c`, `escape` (overrides QUOTING_STYLE environment variable).</a>
<a name="740"><span class="lineNum">     740 </span>            :             !   -r, --reverse               :   reverse order while sorting.</a>
<a name="741"><span class="lineNum">     741 </span>            :             !   -S                          :   sort by file size, largest first.</a>
<a name="742"><span class="lineNum">     742 </span>            :             !   --sort=WORD                 :   sort by WORD instead of name: none (-U), size (-S), time (-t), version (-v), extension (-X).</a>
<a name="743"><span class="lineNum">     743 </span>            :             !   -X                          :   sort alphabetically by entry extension.</a>
<a name="744"><span class="lineNum">     744 </span>            :             !   -t                          :   sort by time, newest first.</a>
<a name="745"><span class="lineNum">     745 </span>            :             !   -1                          :   list one file per line.  Avoid '\n' with -q or -b.</a>
<a name="746"><span class="lineNum">     746 </span>            :             !   -u                          :   Use time of last access instead of last modification of the file for sorting (-t) or writing (-l).</a>
<a name="747"><span class="lineNum">     747 </span>            :             !</a>
<a name="748"><span class="lineNum">     748 </span>            :             !   \see</a>
<a name="749"><span class="lineNum">     749 </span>            :             !   https://pubs.opengroup.org/onlinepubs/9699919799/utilities/ls.html</a>
<a name="750"><span class="lineNum">     750 </span>            :             !</a>
<a name="751"><span class="lineNum">     751 </span>            :             !   \warning</a>
<a name="752"><span class="lineNum">     752 </span>            :             !   Grouping directories first in the command below is crucial for the proper functioning</a>
<a name="753"><span class="lineNum">     753 </span>            :             !   of the rest of the code below (when either `showdir` or `showfile` is `.false.`).</a>
<a name="754"><span class="lineNum">     754 </span><span class="lineCov">        268 :             command = SKC_&quot;ls --group-directories-first -bpG&quot;</span></a>
<a name="755"><span class="lineNum">     755 </span><span class="lineCov">        268 :             if (showhidden_def) command = command//SKC_&quot;A&quot;</span></a>
<a name="756"><span class="lineNum">     756 </span><span class="lineCov">        268 :             if (present(sort)) then</span></a>
<a name="757"><span class="lineNum">     757 </span><span class="lineNoCov">          0 :                 if (sort /= SK_&quot;name&quot;) then</span></a>
<a name="758"><span class="lineNum">     758 </span><span class="lineNoCov">          0 :                     if (reversed_def) command = command//SKC_&quot;r&quot;</span></a>
<a name="759"><span class="lineNum">     759 </span><span class="lineNoCov">          0 :                 elseif (sort == SK_&quot;tmod&quot;) then</span></a>
<a name="760"><span class="lineNum">     760 </span><span class="lineNoCov">          0 :                     if (reversed_def) then</span></a>
<a name="761"><span class="lineNum">     761 </span><span class="lineNoCov">          0 :                         command = command//SKC_&quot;t&quot;</span></a>
<a name="762"><span class="lineNum">     762 </span>            :                     else</a>
<a name="763"><span class="lineNum">     763 </span><span class="lineNoCov">          0 :                         command = command//SKC_&quot;tr&quot;</span></a>
<a name="764"><span class="lineNum">     764 </span>            :                     end if</a>
<a name="765"><span class="lineNum">     765 </span><span class="lineNoCov">          0 :                 elseif (sort == SK_&quot;tacc&quot;) then</span></a>
<a name="766"><span class="lineNum">     766 </span><span class="lineNoCov">          0 :                     if (reversed_def) then</span></a>
<a name="767"><span class="lineNum">     767 </span><span class="lineNoCov">          0 :                         command = command//SKC_&quot;u&quot;</span></a>
<a name="768"><span class="lineNum">     768 </span>            :                     else</a>
<a name="769"><span class="lineNum">     769 </span><span class="lineNoCov">          0 :                         command = command//SKC_&quot;ur&quot;</span></a>
<a name="770"><span class="lineNum">     770 </span>            :                     end if</a>
<a name="771"><span class="lineNum">     771 </span><span class="lineNoCov">          0 :                 elseif (sort == SK_&quot;size&quot;) then</span></a>
<a name="772"><span class="lineNum">     772 </span><span class="lineNoCov">          0 :                     if (reversed_def) then</span></a>
<a name="773"><span class="lineNum">     773 </span><span class="lineNoCov">          0 :                         command = command//SKC_&quot;S&quot;</span></a>
<a name="774"><span class="lineNum">     774 </span>            :                     else</a>
<a name="775"><span class="lineNum">     775 </span><span class="lineNoCov">          0 :                         command = command//SKC_&quot;Sr&quot;</span></a>
<a name="776"><span class="lineNum">     776 </span>            :                     end if</a>
<a name="777"><span class="lineNum">     777 </span><span class="lineNoCov">          0 :                 elseif (sort == SK_&quot;fext&quot;) then</span></a>
<a name="778"><span class="lineNum">     778 </span><span class="lineNoCov">          0 :                     if (reversed_def) then</span></a>
<a name="779"><span class="lineNum">     779 </span><span class="lineNoCov">          0 :                         command = command//SKC_&quot;Xr&quot;</span></a>
<a name="780"><span class="lineNum">     780 </span>            :                     else</a>
<a name="781"><span class="lineNum">     781 </span><span class="lineNoCov">          0 :                         command = command//SKC_&quot;X&quot;</span></a>
<a name="782"><span class="lineNum">     782 </span>            :                     end if</a>
<a name="783"><span class="lineNum">     783 </span>            :                 else</a>
<a name="784"><span class="lineNum">     784 </span><span class="lineNoCov">          0 :                     if (present(errmsg)) errmsg = PROCEDURE_NAME//SK_&quot;: Unrecognized value for the `sort` input argument: &quot;//sort</span></a>
<a name="785"><span class="lineNum">     785 </span><span class="lineNoCov">          0 :                     failed = .true._LK</span></a>
<a name="786"><span class="lineNum">     786 </span><span class="lineNoCov">          0 :                     return</span></a>
<a name="787"><span class="lineNum">     787 </span>            :                 end if</a>
<a name="788"><span class="lineNum">     788 </span>            :             else</a>
<a name="789"><span class="lineNum">     789 </span><span class="lineCov">        268 :                 if (reversed_def) command = command//SKC_&quot; -r&quot;</span></a>
<a name="790"><span class="lineNum">     790 </span>            :             end if</a>
<a name="791"><span class="lineNum">     791 </span>            : </a>
<a name="792"><span class="lineNum">     792 </span>            :             ! Fetch the list.</a>
<a name="793"><span class="lineNum">     793 </span><span class="lineCov">        268 :             failed = isFailedGetOutput(command//SKC_&quot; &quot;//getPathVerbatimPosix(path), list, errmsg_def, exitstat = exitstat)</span></a>
<a name="794"><span class="lineNum">     794 </span><span class="lineCov">        268 :             if (failed) then</span></a>
<a name="795"><span class="lineNum">     795 </span>            :                 if (present(errmsg)) errmsg = PROCEDURE_NAME//SK_&quot;: &quot;//trim(errmsg_def) ! LCOV_EXCL_LINE</a>
<a name="796"><span class="lineNum">     796 </span>            :                 return ! LCOV_EXCL_LINE</a>
<a name="797"><span class="lineNum">     797 </span><span class="lineCov">        268 :             elseif (exitstat /= 0_IK) then</span></a>
<a name="798"><span class="lineNum">     798 </span><span class="lineCov">        176 :                 index = reshape([integer(IK) ::], [0,0])</span></a>
<a name="799"><span class="lineNum">     799 </span><span class="lineCov">        176 :                 list = SKC_&quot;&quot;</span></a>
<a name="800"><span class="lineNum">     800 </span><span class="lineCov">        176 :                 return</span></a>
<a name="801"><span class="lineNum">     801 </span>            :             end if</a>
<a name="802"><span class="lineNum">     802 </span>            : #define     UNESCAPE_REINDEX_LIST call setAsciiFromEscaped(list(index(1, i) : index(2, i)), endloc); index(2, i) = index(1, i) + endloc - 1_IK;</a>
<a name="803"><span class="lineNum">     803 </span><span class="lineCov">         92 :             call setSplit(index, list, NLC)</span></a>
<a name="804"><span class="lineNum">     804 </span><span class="lineCov">         92 :             lenList = size(index, 2, IK)</span></a>
<a name="805"><span class="lineNum">     805 </span>            :             ! Unescape the C-style escape sequences.</a>
<a name="806"><span class="lineNum">     806 </span><span class="lineCov">         92 :             if (showdir_def .and. showfile_def) then</span></a>
<a name="807"><span class="lineNum">     807 </span><span class="lineCov">       1532 :                 do i = 1_IK, lenList</span></a>
<a name="808"><span class="lineNum">     808 </span><span class="lineCov">       1532 :                     UNESCAPE_REINDEX_LIST</span></a>
<a name="809"><span class="lineNum">     809 </span>            :                     !if (list(index(2, i) : index(2, i)) == shell%dirsep) index(2, i) = index(2, i) - 1_IK</a>
<a name="810"><span class="lineNum">     810 </span>            :                 end do</a>
<a name="811"><span class="lineNum">     811 </span><span class="lineNoCov">          0 :             elseif (showfile_def) then</span></a>
<a name="812"><span class="lineNum">     812 </span><span class="lineNoCov">          0 :                 do istart = 1_IK, lenList</span></a>
<a name="813"><span class="lineNum">     813 </span><span class="lineNoCov">          0 :                     if (list(index(2, i) : index(2, i)) /= shell%dirsep) exit</span></a>
<a name="814"><span class="lineNum">     814 </span>            :                 end do</a>
<a name="815"><span class="lineNum">     815 </span><span class="lineNoCov">          0 :                 do i = istart, lenList</span></a>
<a name="816"><span class="lineNum">     816 </span><span class="lineNoCov">          0 :                     UNESCAPE_REINDEX_LIST</span></a>
<a name="817"><span class="lineNum">     817 </span>            :                 end do</a>
<a name="818"><span class="lineNum">     818 </span><span class="lineNoCov">          0 :                 index = index(:, istart : lenList)</span></a>
<a name="819"><span class="lineNum">     819 </span><span class="lineNoCov">          0 :             elseif (showdir_def) then</span></a>
<a name="820"><span class="lineNum">     820 </span><span class="lineNoCov">          0 :                 do istart = 1_IK, lenList</span></a>
<a name="821"><span class="lineNum">     821 </span><span class="lineNoCov">          0 :                     if (list(index(2, i) : index(2, i)) /= shell%dirsep) exit</span></a>
<a name="822"><span class="lineNum">     822 </span><span class="lineNoCov">          0 :                     UNESCAPE_REINDEX_LIST</span></a>
<a name="823"><span class="lineNum">     823 </span>            :                     !if (list(index(2, i) : index(2, i)) == shell%dirsep) index(2, i) = index(2, i) - 1_IK</a>
<a name="824"><span class="lineNum">     824 </span>            :                 end do</a>
<a name="825"><span class="lineNum">     825 </span><span class="lineNoCov">          0 :                 index = index(:, 1 : istart)</span></a>
<a name="826"><span class="lineNum">     826 </span>            :             else</a>
<a name="827"><span class="lineNum">     827 </span><span class="lineNoCov">          0 :                 index = reshape([integer(IK) ::], [0,0])</span></a>
<a name="828"><span class="lineNum">     828 </span><span class="lineNoCov">          0 :                 list = SKC_&quot;&quot;</span></a>
<a name="829"><span class="lineNum">     829 </span><span class="lineNoCov">          0 :                 return</span></a>
<a name="830"><span class="lineNum">     830 </span>            :             end if</a>
<a name="831"><span class="lineNum">     831 </span>            : #undef      UNESCAPE_REINDEX_LIST</a>
<a name="832"><span class="lineNum">     832 </span>            : </a>
<a name="833"><span class="lineNum">     833 </span><span class="lineNoCov">          0 :         elseif (shell%is%windows .and. shell%is%cmd) then</span></a>
<a name="834"><span class="lineNum">     834 </span>            : </a>
<a name="835"><span class="lineNum">     835 </span>            :             ! see: https://www.computerhope.com/dirhlp.htm</a>
<a name="836"><span class="lineNum">     836 </span>            :             !   /p                  Displays one screen of the listing at a time. To see the next screen, press any key.</a>
<a name="837"><span class="lineNum">     837 </span>            :             !   /q                  Displays file ownership information.</a>
<a name="838"><span class="lineNum">     838 </span>            :             !   /w                  Displays the listing in wide format, with as many as five file names or directory names on each line.</a>
<a name="839"><span class="lineNum">     839 </span>            :             !   /d                  Displays the listing in the same format as /w, but the files are sorted by column.</a>
<a name="840"><span class="lineNum">     840 </span>            :             !   /a[[:]&lt;attributes&gt;] Displays only the names of those directories and files with your specified attributes. If you don't use this parameter, the command displays the names of all files except hidden and system files. If you use this parameter without specifying any attributes, the command displays the names of all files, including hidden and system files. The list of possible attributes values are:</a>
<a name="841"><span class="lineNum">     841 </span>            :             !                       d - Directories</a>
<a name="842"><span class="lineNum">     842 </span>            :             !                       h - Hidden files</a>
<a name="843"><span class="lineNum">     843 </span>            :             !                       s - System files</a>
<a name="844"><span class="lineNum">     844 </span>            :             !                       l - Reparse points</a>
<a name="845"><span class="lineNum">     845 </span>            :             !                       r - Read-only files</a>
<a name="846"><span class="lineNum">     846 </span>            :             !                       a - Files ready for archiving</a>
<a name="847"><span class="lineNum">     847 </span>            :             !                       i - Not content indexed files</a>
<a name="848"><span class="lineNum">     848 </span>            :             !                       You can use any combination of these values, but do not separate your values using spaces.</a>
<a name="849"><span class="lineNum">     849 </span>            :             !                       Optionally you can use a colon (:) separator, or you can use a hyphen (-) as a prefix to mean, &quot;not&quot;.</a>
<a name="850"><span class="lineNum">     850 </span>            :             !                       For example, using the -s attribute will not show the system files.</a>
<a name="851"><span class="lineNum">     851 </span>            :             !   /o[[:]&lt;sortorder&gt;]  Sorts the output according to sortorder, which can be any combination of the following values:</a>
<a name="852"><span class="lineNum">     852 </span>            :             !                       n - Alphabetically by name</a>
<a name="853"><span class="lineNum">     853 </span>            :             !                       e - Alphabetically by extension</a>
<a name="854"><span class="lineNum">     854 </span>            :             !                       g - Group directories first</a>
<a name="855"><span class="lineNum">     855 </span>            :             !                       s - By size, smallest first</a>
<a name="856"><span class="lineNum">     856 </span>            :             !                       d - By date/time, oldest first</a>
<a name="857"><span class="lineNum">     857 </span>            :             !                       Use the - prefix to reverse the sort order</a>
<a name="858"><span class="lineNum">     858 </span>            :             !                       Multiple values are processed in the order in which you list them. Do not separate multiple values with spaces, but you can optionally use a colon (:).</a>
<a name="859"><span class="lineNum">     859 </span>            :             !                       If sortorder is not specified, dir /o lists the directories alphabetically, followed by the files, which are also sorted alphabetically.</a>
<a name="860"><span class="lineNum">     860 </span>            :             !   /t[[:]&lt;timefield&gt;]  Specifies which time field to display or to use for sorting. The available timefield values are:</a>
<a name="861"><span class="lineNum">     861 </span>            :             !                       c - Creation</a>
<a name="862"><span class="lineNum">     862 </span>            :             !                       a - Last accessed</a>
<a name="863"><span class="lineNum">     863 </span>            :             !                       w - Last modified</a>
<a name="864"><span class="lineNum">     864 </span>            :             !   /s                  Lists every occurrence of the specified file name within the specified directory and all subdirectories.</a>
<a name="865"><span class="lineNum">     865 </span>            :             !   /b                  Displays a bare list of directories and files, with no additional information. The /b parameter overrides /w.</a>
<a name="866"><span class="lineNum">     866 </span>            :             !   /l                  Displays unsorted directory names and file names, using lowercase.</a>
<a name="867"><span class="lineNum">     867 </span>            :             !   /n                  Displays a long list format with file names on the far right of the screen.</a>
<a name="868"><span class="lineNum">     868 </span>            :             !   /x                  Displays the short names generated for non-8dot3 file names. The display is the same as the display for /n, but the short name is inserted before the long name.</a>
<a name="869"><span class="lineNum">     869 </span>            :             !   /c                  Displays the thousand separator in file sizes. This is the default behavior. Use /-c to hide separators.</a>
<a name="870"><span class="lineNum">     870 </span>            :             !   /4                  Displays years in four-digit format.</a>
<a name="871"><span class="lineNum">     871 </span>            :             !   /r                  Display alternate data streams of the file.</a>
<a name="872"><span class="lineNum">     872 </span>            :             !   /?                  Displays help at the command prompt.</a>
<a name="873"><span class="lineNum">     873 </span>            :             !</a>
<a name="874"><span class="lineNum">     874 </span>            :             !   \see</a>
<a name="875"><span class="lineNum">     875 </span>            :             !   https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/dir</a>
<a name="876"><span class="lineNum">     876 </span>            :             !</a>
<a name="877"><span class="lineNum">     877 </span><span class="lineNoCov">          0 :             command = SKC_&quot;dir /b /o:g&quot;</span></a>
<a name="878"><span class="lineNum">     878 </span><span class="lineNoCov">          0 :             if (showhidden_def) then</span></a>
<a name="879"><span class="lineNum">     879 </span><span class="lineNoCov">          0 :                 command = command//SKC_&quot; /a:h&quot;</span></a>
<a name="880"><span class="lineNum">     880 </span>            :             else</a>
<a name="881"><span class="lineNum">     881 </span><span class="lineNoCov">          0 :                 command = command//SKC_&quot; /a:-h&quot;</span></a>
<a name="882"><span class="lineNum">     882 </span>            :             end if</a>
<a name="883"><span class="lineNum">     883 </span><span class="lineNoCov">          0 :             if (present(sort)) then</span></a>
<a name="884"><span class="lineNum">     884 </span><span class="lineNoCov">          0 :                 if (sort /= SK_&quot;name&quot;) then</span></a>
<a name="885"><span class="lineNum">     885 </span><span class="lineNoCov">          0 :                     if (reversed_def) then</span></a>
<a name="886"><span class="lineNum">     886 </span><span class="lineNoCov">          0 :                         command = command//SKC_&quot; /o:-n&quot;</span></a>
<a name="887"><span class="lineNum">     887 </span>            :                     else</a>
<a name="888"><span class="lineNum">     888 </span><span class="lineNoCov">          0 :                         command = command//SKC_&quot; /o:n&quot;</span></a>
<a name="889"><span class="lineNum">     889 </span>            :                     end if</a>
<a name="890"><span class="lineNum">     890 </span><span class="lineNoCov">          0 :                 elseif (sort == SK_&quot;tmod&quot;) then</span></a>
<a name="891"><span class="lineNum">     891 </span><span class="lineNoCov">          0 :                     if (reversed_def) then</span></a>
<a name="892"><span class="lineNum">     892 </span><span class="lineNoCov">          0 :                         command = command//SKC_&quot; /o:-d /t:w&quot;</span></a>
<a name="893"><span class="lineNum">     893 </span>            :                     else</a>
<a name="894"><span class="lineNum">     894 </span><span class="lineNoCov">          0 :                         command = command//SKC_&quot; /o:d /t:w&quot;</span></a>
<a name="895"><span class="lineNum">     895 </span>            :                     end if</a>
<a name="896"><span class="lineNum">     896 </span><span class="lineNoCov">          0 :                 elseif (sort == SK_&quot;tacc&quot;) then</span></a>
<a name="897"><span class="lineNum">     897 </span><span class="lineNoCov">          0 :                     if (reversed_def) then</span></a>
<a name="898"><span class="lineNum">     898 </span><span class="lineNoCov">          0 :                         command = command//SKC_&quot; /o:-d /t:a&quot;</span></a>
<a name="899"><span class="lineNum">     899 </span>            :                     else</a>
<a name="900"><span class="lineNum">     900 </span><span class="lineNoCov">          0 :                         command = command//SKC_&quot; /o:d /t:a&quot;</span></a>
<a name="901"><span class="lineNum">     901 </span>            :                     end if</a>
<a name="902"><span class="lineNum">     902 </span><span class="lineNoCov">          0 :                 elseif (sort == SK_&quot;size&quot;) then</span></a>
<a name="903"><span class="lineNum">     903 </span><span class="lineNoCov">          0 :                     if (reversed_def) then</span></a>
<a name="904"><span class="lineNum">     904 </span><span class="lineNoCov">          0 :                         command = command//SKC_&quot; /o:-s&quot;</span></a>
<a name="905"><span class="lineNum">     905 </span>            :                     else</a>
<a name="906"><span class="lineNum">     906 </span><span class="lineNoCov">          0 :                         command = command//SKC_&quot; /o:s&quot;</span></a>
<a name="907"><span class="lineNum">     907 </span>            :                     end if</a>
<a name="908"><span class="lineNum">     908 </span><span class="lineNoCov">          0 :                 elseif (sort == SK_&quot;fext&quot;) then</span></a>
<a name="909"><span class="lineNum">     909 </span><span class="lineNoCov">          0 :                     if (reversed_def) then</span></a>
<a name="910"><span class="lineNum">     910 </span><span class="lineNoCov">          0 :                         command = command//SKC_&quot; /o:-e&quot;</span></a>
<a name="911"><span class="lineNum">     911 </span>            :                     else</a>
<a name="912"><span class="lineNum">     912 </span><span class="lineNoCov">          0 :                         command = command//SKC_&quot; /o:e&quot;</span></a>
<a name="913"><span class="lineNum">     913 </span>            :                     end if</a>
<a name="914"><span class="lineNum">     914 </span>            :                 else</a>
<a name="915"><span class="lineNum">     915 </span><span class="lineNoCov">          0 :                     if (present(errmsg)) errmsg = PROCEDURE_NAME//SK_&quot;: Unrecognized value for the `sort` input argument: &quot;//sort</span></a>
<a name="916"><span class="lineNum">     916 </span><span class="lineNoCov">          0 :                     failed = .true._LK</span></a>
<a name="917"><span class="lineNum">     917 </span><span class="lineNoCov">          0 :                     return</span></a>
<a name="918"><span class="lineNum">     918 </span>            :                 end if</a>
<a name="919"><span class="lineNum">     919 </span>            :             else</a>
<a name="920"><span class="lineNum">     920 </span><span class="lineNoCov">          0 :                 if (reversed_def) then</span></a>
<a name="921"><span class="lineNum">     921 </span><span class="lineNoCov">          0 :                     command = command//SKC_&quot; /o:-n&quot;</span></a>
<a name="922"><span class="lineNum">     922 </span>            :                 else</a>
<a name="923"><span class="lineNum">     923 </span><span class="lineNoCov">          0 :                     command = command//SKC_&quot; /o:n&quot;</span></a>
<a name="924"><span class="lineNum">     924 </span>            :                 end if</a>
<a name="925"><span class="lineNum">     925 </span>            :             end if</a>
<a name="926"><span class="lineNum">     926 </span>            :             !if (len(exclude)&gt;0 ) command = command // &quot; | findstr /v /i &quot; // exclude</a>
<a name="927"><span class="lineNum">     927 </span>            : </a>
<a name="928"><span class="lineNum">     928 </span><span class="lineNoCov">          0 :             if (showdir_def) then</span></a>
<a name="929"><span class="lineNum">     929 </span><span class="lineNoCov">          0 :                 if (isFailedGetOutput(command//SKC_&quot; /a:d&quot;//getPathVerbatimCMD(path), dirlist, errmsg_def, exitstat = exitstat)) then</span></a>
<a name="930"><span class="lineNum">     930 </span>            :                     dirIndex = reshape([integer(IK) ::], [0,0]) ! LCOV_EXCL_LINE</a>
<a name="931"><span class="lineNum">     931 </span>            :                     dirlist = SKC_&quot;&quot; ! LCOV_EXCL_LINE</a>
<a name="932"><span class="lineNum">     932 </span><span class="lineNoCov">          0 :                 elseif (exitstat /= 0_IK) then</span></a>
<a name="933"><span class="lineNum">     933 </span><span class="lineNoCov">          0 :                     index = reshape([integer(IK) ::], [0,0])</span></a>
<a name="934"><span class="lineNum">     934 </span><span class="lineNoCov">          0 :                     list = SKC_&quot;&quot;</span></a>
<a name="935"><span class="lineNum">     935 </span><span class="lineNoCov">          0 :                     return</span></a>
<a name="936"><span class="lineNum">     936 </span>            :                 else</a>
<a name="937"><span class="lineNum">     937 </span><span class="lineNoCov">          0 :                     call setSplit(dirIndex, dirlist, NLC)</span></a>
<a name="938"><span class="lineNum">     938 </span>            :                     !do i = 1_IK, size(dirIndex,2,IK) - 1_IK</a>
<a name="939"><span class="lineNum">     939 </span>            :                     !    dirIndex(2, i) = dirIndex(2, i) + 1_IK</a>
<a name="940"><span class="lineNum">     940 </span>            :                     !    dirlist(dirIndex(2, i) : dirIndex(2, i)) = shell%dirsep</a>
<a name="941"><span class="lineNum">     941 </span>            :                     !end do</a>
<a name="942"><span class="lineNum">     942 </span>            :                     !dirIndex(2, i) = dirIndex(2, i) + 1_IK</a>
<a name="943"><span class="lineNum">     943 </span>            :                     !dirlist = dirlist//shell%dirsep</a>
<a name="944"><span class="lineNum">     944 </span>            :                 end if</a>
<a name="945"><span class="lineNum">     945 </span>            :             end if</a>
<a name="946"><span class="lineNum">     946 </span>            : </a>
<a name="947"><span class="lineNum">     947 </span><span class="lineNoCov">          0 :             if (showfile_def) then</span></a>
<a name="948"><span class="lineNum">     948 </span><span class="lineNoCov">          0 :                 if (isFailedGetOutput(command//SKC_&quot; /a:-d&quot;//getPathVerbatimCMD(path), filelist, errmsg_def, exitstat = exitstat)) then</span></a>
<a name="949"><span class="lineNum">     949 </span>            :                     fileIndex = reshape([integer(IK) ::], [0,0]) ! LCOV_EXCL_LINE</a>
<a name="950"><span class="lineNum">     950 </span>            :                     filelist = SKC_&quot;&quot; ! LCOV_EXCL_LINE</a>
<a name="951"><span class="lineNum">     951 </span><span class="lineNoCov">          0 :                 elseif (exitstat /= 0_IK) then</span></a>
<a name="952"><span class="lineNum">     952 </span><span class="lineNoCov">          0 :                     index = reshape([integer(IK) ::], [0,0])</span></a>
<a name="953"><span class="lineNum">     953 </span><span class="lineNoCov">          0 :                     list = SKC_&quot;&quot;</span></a>
<a name="954"><span class="lineNum">     954 </span><span class="lineNoCov">          0 :                     return</span></a>
<a name="955"><span class="lineNum">     955 </span>            :                 else</a>
<a name="956"><span class="lineNum">     956 </span><span class="lineNoCov">          0 :                     call setSplit(fileIndex, filelist, NLC)</span></a>
<a name="957"><span class="lineNum">     957 </span>            :                 end if</a>
<a name="958"><span class="lineNum">     958 </span>            :             end if</a>
<a name="959"><span class="lineNum">     959 </span>            : </a>
<a name="960"><span class="lineNum">     960 </span><span class="lineNoCov">          0 :             if (len(dirlist, IK) &gt; 0_IK) then</span></a>
<a name="961"><span class="lineNum">     961 </span><span class="lineNoCov">          0 :                 lenList = len(dirlist,IK) + 1_IK + len(filelist,IK) ! 1_IK takes care of the additional backslash for the last folder.</span></a>
<a name="962"><span class="lineNum">     962 </span>            :             else</a>
<a name="963"><span class="lineNum">     963 </span><span class="lineNoCov">          0 :                 lenList = len(dirlist,IK) + len(filelist,IK)</span></a>
<a name="964"><span class="lineNum">     964 </span>            :             end if</a>
<a name="965"><span class="lineNum">     965 </span>            : </a>
<a name="966"><span class="lineNum">     966 </span><span class="lineNoCov">          0 :             allocate(character(lenList,SKC) :: list)</span></a>
<a name="967"><span class="lineNum">     967 </span><span class="lineNoCov">          0 :             allocate(index(2,lenList))</span></a>
<a name="968"><span class="lineNum">     968 </span><span class="lineNoCov">          0 :             do i = 1_IK, size(dirIndex,2,IK)</span></a>
<a name="969"><span class="lineNum">     969 </span><span class="lineNoCov">          0 :                 index(1, i) = dirIndex(1, i)</span></a>
<a name="970"><span class="lineNum">     970 </span><span class="lineNoCov">          0 :                 index(2, i) = dirIndex(2, i) + 1_IK</span></a>
<a name="971"><span class="lineNum">     971 </span><span class="lineNoCov">          0 :                 list(dirIndex(1, i) : dirIndex(2, i)) = dirlist(dirIndex(1, i) : dirIndex(2, i))</span></a>
<a name="972"><span class="lineNum">     972 </span><span class="lineNoCov">          0 :                 list(index(2, i) : index(2, i)) = shell%dirsep</span></a>
<a name="973"><span class="lineNum">     973 </span>            :             end do</a>
<a name="974"><span class="lineNum">     974 </span>            : </a>
<a name="975"><span class="lineNum">     975 </span><span class="lineNoCov">          0 :             istart = index(2, i)</span></a>
<a name="976"><span class="lineNum">     976 </span><span class="lineNoCov">          0 :             do i = 1_IK, size(fileIndex,2,IK)</span></a>
<a name="977"><span class="lineNum">     977 </span><span class="lineNoCov">          0 :                 index(1,istart+i) = fileIndex(1, i)</span></a>
<a name="978"><span class="lineNum">     978 </span><span class="lineNoCov">          0 :                 index(2,istart+i) = fileIndex(2, i)</span></a>
<a name="979"><span class="lineNum">     979 </span><span class="lineNoCov">          0 :                 list(index(1,istart) + fileIndex(1, i) : index(1,istart) + fileIndex(2, i)) = filelist(fileIndex(1, i) : fileIndex(2, i))</span></a>
<a name="980"><span class="lineNum">     980 </span>            :             end do</a>
<a name="981"><span class="lineNum">     981 </span>            : </a>
<a name="982"><span class="lineNum">     982 </span><span class="lineNoCov">          0 :         elseif (shell%is%windows .and. shell%is%powershell) then</span></a>
<a name="983"><span class="lineNum">     983 </span>            : </a>
<a name="984"><span class="lineNum">     984 </span>            :             if (present(errmsg)) errmsg = PROCEDURE_NAME//SK_&quot;: PowerShell is currently unsupported.&quot; ! LCOV_EXCL_LINE</a>
<a name="985"><span class="lineNum">     985 </span>            :             failed = .true._LK ! LCOV_EXCL_LINE</a>
<a name="986"><span class="lineNum">     986 </span>            :             return ! LCOV_EXCL_LINE</a>
<a name="987"><span class="lineNum">     987 </span>            : </a>
<a name="988"><span class="lineNum">     988 </span>            :         else</a>
<a name="989"><span class="lineNum">     989 </span>            : </a>
<a name="990"><span class="lineNum">     990 </span>            :             if (present(errmsg)) errmsg = PROCEDURE_NAME//SK_&quot;: Unrecognized runtime shell.&quot; ! LCOV_EXCL_LINE</a>
<a name="991"><span class="lineNum">     991 </span>            :             failed = .true._LK ! LCOV_EXCL_LINE</a>
<a name="992"><span class="lineNum">     992 </span>            :             return ! LCOV_EXCL_LINE</a>
<a name="993"><span class="lineNum">     993 </span>            : </a>
<a name="994"><span class="lineNum">     994 </span>            :         end if</a>
<a name="995"><span class="lineNum">     995 </span>            : </a>
<a name="996"><span class="lineNum">     996 </span>            :         !%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</a>
<a name="997"><span class="lineNum">     997 </span>            : #elif   isFailedCopy_ENABLED || isFailedMove_ENABLED</a>
<a name="998"><span class="lineNum">     998 </span>            :         !%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</a>
<a name="999"><span class="lineNum">     999 </span>            : </a>
<a name="1000"><span class="lineNum">    1000 </span>            :         character(*,SKC), parameter     :: DSP = DIR_SEP_POSIX</a>
<a name="1001"><span class="lineNum">    1001 </span>            :         character(*,SKC), parameter     :: DSW = DIR_SEP_WINDOWS</a>
<a name="1002"><span class="lineNum">    1002 </span>            :         character(*,SKC), parameter     :: DSPA = DIR_SEP_POSIX_ALL</a>
<a name="1003"><span class="lineNum">    1003 </span>            :         character(*,SKC), parameter     :: DSWA = DIR_SEP_WINDOWS_ALL</a>
<a name="1004"><span class="lineNum">    1004 </span>            :         character(*,SKC), parameter     :: LF = new_line(SKC_&quot;a&quot;)</a>
<a name="1005"><span class="lineNum">    1005 </span>            :         character(:,SKC), allocatable   :: paths</a>
<a name="1006"><span class="lineNum">    1006 </span>            :         character(:,SKC), allocatable   :: dirname</a>
<a name="1007"><span class="lineNum">    1007 </span>            :         character(:,SKC), allocatable   :: command</a>
<a name="1008"><span class="lineNum">    1008 </span>            :         logical(LK)                     :: wait_def</a>
<a name="1009"><span class="lineNum">    1009 </span>            :         logical(LK)                     :: forced_def</a>
<a name="1010"><span class="lineNum">    1010 </span>            :         integer(IK)                     :: ntry_def</a>
<a name="1011"><span class="lineNum">    1011 </span>            :         integer(IK)                     :: itry</a>
<a name="1012"><span class="lineNum">    1012 </span>            :         type(shellis_type)              :: shellis</a>
<a name="1013"><span class="lineNum">    1013 </span>            : #if     isFailedMove_ENABLED</a>
<a name="1014"><span class="lineNum">    1014 </span>            :         character(*,SKC), parameter     :: PROCEDURE_NAME = MODULE_NAME//SK_&quot;@isFailedMove()&quot;</a>
<a name="1015"><span class="lineNum">    1015 </span>            : #elif   isFailedCopy_ENABLED</a>
<a name="1016"><span class="lineNum">    1016 </span>            :         character(*,SKC), parameter     :: PROCEDURE_NAME = MODULE_NAME//SK_&quot;@isFailedCopy()&quot;</a>
<a name="1017"><span class="lineNum">    1017 </span>            :         logical(LK)                     :: recursive_def</a>
<a name="1018"><span class="lineNum">    1018 </span><span class="lineCov">         20 :         if (present(recursive)) then</span></a>
<a name="1019"><span class="lineNum">    1019 </span><span class="lineCov">          4 :             recursive_def = recursive</span></a>
<a name="1020"><span class="lineNum">    1020 </span>            :         else</a>
<a name="1021"><span class="lineNum">    1021 </span>            :             recursive_def = .false._LK</a>
<a name="1022"><span class="lineNum">    1022 </span>            :         end if</a>
<a name="1023"><span class="lineNum">    1023 </span>            : #endif</a>
<a name="1024"><span class="lineNum">    1024 </span>            : </a>
<a name="1025"><span class="lineNum">    1025 </span>            :         ERROR_STOP_IF(len(DSWA) /= 2, PROCEDURE_NAME//SK_&quot;: Internal library error occurred. The condition `len(DSWA) == 2` must hold.&quot;)</a>
<a name="1026"><span class="lineNum">    1026 </span>            : </a>
<a name="1027"><span class="lineNum">    1027 </span>            :         ! The input source and destination cannnot be empty.</a>
<a name="1028"><span class="lineNum">    1028 </span>            : </a>
<a name="1029"><span class="lineNum">    1029 </span><span class="lineCov">         35 :         failed = logical(from == SKC_&quot;&quot; .or. to == SKC_&quot;&quot;, LK)</span></a>
<a name="1030"><span class="lineNum">    1030 </span><span class="lineCov">         35 :         if (failed) then</span></a>
<a name="1031"><span class="lineNum">    1031 </span><span class="lineNoCov">          0 :             if (present(errmsg)) errmsg = PROCEDURE_NAME//SK_&quot;: The input path `from` is empty.&quot;</span></a>
<a name="1032"><span class="lineNum">    1032 </span><span class="lineNoCov">          0 :             return</span></a>
<a name="1033"><span class="lineNum">    1033 </span>            :         end if</a>
<a name="1034"><span class="lineNum">    1034 </span>            : </a>
<a name="1035"><span class="lineNum">    1035 </span><span class="lineCov">         35 :         if (present(forced)) then</span></a>
<a name="1036"><span class="lineNum">    1036 </span><span class="lineCov">          4 :             forced_def = forced</span></a>
<a name="1037"><span class="lineNum">    1037 </span>            :         else</a>
<a name="1038"><span class="lineNum">    1038 </span>            :             forced_def = .false._LK</a>
<a name="1039"><span class="lineNum">    1039 </span>            :         end if</a>
<a name="1040"><span class="lineNum">    1040 </span>            : </a>
<a name="1041"><span class="lineNum">    1041 </span><span class="lineCov">         35 :         shellis = shellis_type(failed)</span></a>
<a name="1042"><span class="lineNum">    1042 </span>            : </a>
<a name="1043"><span class="lineNum">    1043 </span>            :         ! Define the copy/move command</a>
<a name="1044"><span class="lineNum">    1044 </span>            : </a>
<a name="1045"><span class="lineNum">    1045 </span><span class="lineCov">         35 :         blockDefineCommand: if (shellis%posix .or. shellis%fish) then</span></a>
<a name="1046"><span class="lineNum">    1046 </span>            : </a>
<a name="1047"><span class="lineNum">    1047 </span>            :             ! Create the destination nested directory if needed.</a>
<a name="1048"><span class="lineNum">    1048 </span>            : </a>
<a name="1049"><span class="lineNum">    1049 </span><span class="lineCov">         35 :             if (isDir(from)) then</span></a>
<a name="1050"><span class="lineNum">    1050 </span>            :                 ! `to` must be also a directory. If it does not exist, create it.</a>
<a name="1051"><span class="lineNum">    1051 </span><span class="lineCov">         13 :                 if (isFile(to)) then</span></a>
<a name="1052"><span class="lineNum">    1052 </span>            :                     if (present(errmsg)) errmsg = PROCEDURE_NAME//SK_&quot;: The input destination `to` must be a directory when the source `from` is a directory. to: &quot;&quot;&quot;//getStr(to)//SK_&quot;&quot;&quot;&quot; ! LCOV_EXCL_LINE</a>
<a name="1053"><span class="lineNum">    1053 </span>            :                     failed = .true._LK ! LCOV_EXCL_LINE</a>
<a name="1054"><span class="lineNum">    1054 </span>            :                     return ! LCOV_EXCL_LINE</a>
<a name="1055"><span class="lineNum">    1055 </span><span class="lineCov">         13 :                 elseif (.not. isDir(to)) then</span></a>
<a name="1056"><span class="lineNum">    1056 </span><span class="lineCov">         13 :                     dirname = getDirName(to, DSPA)</span></a>
<a name="1057"><span class="lineNum">    1057 </span><span class="lineCov">         13 :                     if (.not. isDir(dirname)) then ! it is a nonexistent dirname.</span></a>
<a name="1058"><span class="lineNum">    1058 </span><span class="lineCov">          6 :                         failed = isFailedMakeDir(dirname, errmsg = errmsg)</span></a>
<a name="1059"><span class="lineNum">    1059 </span>            :                         if (failed) then; if (present(errmsg)) errmsg = PROCEDURE_NAME//SK_&quot;: &quot;//trim(errmsg); return; end if ! LCOV_EXCL_LINE</a>
<a name="1060"><span class="lineNum">    1060 </span>            :                     end if</a>
<a name="1061"><span class="lineNum">    1061 </span>            :                 end if</a>
<a name="1062"><span class="lineNum">    1062 </span>            :             else! `to` may still be a directory. If it is a directory, ensure it exists before copying the file.</a>
<a name="1063"><span class="lineNum">    1063 </span><span class="lineCov">         22 :                 if (to(len(to):len(to)) == DSPA) then ! it must be a dir.</span></a>
<a name="1064"><span class="lineNum">    1064 </span><span class="lineCov">          6 :                     if (.not. isDir(to)) then ! it is a nonexistent (potentially nested) dir. Create it.</span></a>
<a name="1065"><span class="lineNum">    1065 </span><span class="lineCov">         18 :                         failed = isFailedMakeDir(to, errmsg = errmsg)</span></a>
<a name="1066"><span class="lineNum">    1066 </span>            :                         if (failed) then; if (present(errmsg)) errmsg = PROCEDURE_NAME//SK_&quot;: &quot;//trim(errmsg); return; end if ! LCOV_EXCL_LINE</a>
<a name="1067"><span class="lineNum">    1067 </span>            :                     end if</a>
<a name="1068"><span class="lineNum">    1068 </span>            :                 else ! `to` must be a file. So make sure its (potentially nested) dirname exists.</a>
<a name="1069"><span class="lineNum">    1069 </span><span class="lineCov">         16 :                     dirname = getDirName(to, DSPA)</span></a>
<a name="1070"><span class="lineNum">    1070 </span><span class="lineCov">         16 :                     if (.not. isDir(dirname)) then ! it is a nonexistent dirname.</span></a>
<a name="1071"><span class="lineNum">    1071 </span><span class="lineCov">         12 :                         failed = isFailedMakeDir(dirname, errmsg = errmsg)</span></a>
<a name="1072"><span class="lineNum">    1072 </span>            :                         if (failed) then; if (present(errmsg)) errmsg = PROCEDURE_NAME//SK_&quot;: &quot;//trim(errmsg); return; end if ! LCOV_EXCL_LINE</a>
<a name="1073"><span class="lineNum">    1073 </span>            :                     end if</a>
<a name="1074"><span class="lineNum">    1074 </span>            :                 end if</a>
<a name="1075"><span class="lineNum">    1075 </span>            :             end if</a>
<a name="1076"><span class="lineNum">    1076 </span>            : </a>
<a name="1077"><span class="lineNum">    1077 </span>            :             ! quote the paths.</a>
<a name="1078"><span class="lineNum">    1078 </span>            : </a>
<a name="1079"><span class="lineNum">    1079 </span><span class="lineCov">         35 :             if (shellis%powershell) then</span></a>
<a name="1080"><span class="lineNum">    1080 </span><span class="lineNoCov">          0 :                 paths = getPathVerbatimPowerShell(from)//SKC_&quot; &quot;//getPathVerbatimPowerShell(to)</span></a>
<a name="1081"><span class="lineNum">    1081 </span>            :             else</a>
<a name="1082"><span class="lineNum">    1082 </span><span class="lineCov">         35 :                 paths = getPathVerbatimPosix(from)//SKC_&quot; &quot;//getPathVerbatimPosix(to)</span></a>
<a name="1083"><span class="lineNum">    1083 </span>            :             end if</a>
<a name="1084"><span class="lineNum">    1084 </span>            : </a>
<a name="1085"><span class="lineNum">    1085 </span>            :             ! copy/move path to destination.</a>
<a name="1086"><span class="lineNum">    1086 </span>            : </a>
<a name="1087"><span class="lineNum">    1087 </span>            : #if         isFailedMove_ENABLED</a>
<a name="1088"><span class="lineNum">    1088 </span>            :             !   -n, --no-clobber    : do not overwrite an existing file.</a>
<a name="1089"><span class="lineNum">    1089 </span>            :             !   -f, --force         : if an existing destination file cannot be opened, remove it and try again (this option is ignored when the -n option is also used).</a>
<a name="1090"><span class="lineNum">    1090 </span><span class="lineCov">         15 :             if (forced_def) then</span></a>
<a name="1091"><span class="lineNum">    1091 </span><span class="lineNoCov">          0 :                 command = SKC_&quot;mv -f &quot;//paths</span></a>
<a name="1092"><span class="lineNum">    1092 </span>            :             else</a>
<a name="1093"><span class="lineNum">    1093 </span><span class="lineCov">         15 :                 command = SKC_&quot;mv -n &quot;//paths</span></a>
<a name="1094"><span class="lineNum">    1094 </span>            :             end if</a>
<a name="1095"><span class="lineNum">    1095 </span>            : #elif       isFailedCopy_ENABLED</a>
<a name="1096"><span class="lineNum">    1096 </span>            :             !   -a, --archive       : same as -dR --preserve=all.</a>
<a name="1097"><span class="lineNum">    1097 </span>            :             !   -d                  : same as --no-dereference --preserve=links</a>
<a name="1098"><span class="lineNum">    1098 </span>            :             !   -f, --force         : if an existing destination file cannot be opened, remove it and try again (this option is ignored when the -n option is also used).</a>
<a name="1099"><span class="lineNum">    1099 </span>            :             !   -n, --no-clobber    : do not overwrite an existing file.</a>
<a name="1100"><span class="lineNum">    1100 </span>            :             !   -R, -r, --recursive : copy directories recursively.</a>
<a name="1101"><span class="lineNum">    1101 </span><span class="lineCov">         20 :             if (forced_def .and. recursive_def) then</span></a>
<a name="1102"><span class="lineNum">    1102 </span><span class="lineNoCov">          0 :                 command = SKC_&quot;cp -arf &quot;//paths</span></a>
<a name="1103"><span class="lineNum">    1103 </span><span class="lineCov">         20 :             elseif (recursive_def) then</span></a>
<a name="1104"><span class="lineNum">    1104 </span><span class="lineCov">          4 :                 command = SKC_&quot;cp -arn &quot;//paths</span></a>
<a name="1105"><span class="lineNum">    1105 </span><span class="lineCov">         16 :             elseif (forced_def) then</span></a>
<a name="1106"><span class="lineNum">    1106 </span><span class="lineCov">          4 :                 command = SKC_&quot;cp -f &quot;//paths</span></a>
<a name="1107"><span class="lineNum">    1107 </span>            :             else</a>
<a name="1108"><span class="lineNum">    1108 </span><span class="lineCov">         12 :                 command = SKC_&quot;cp &quot;//paths</span></a>
<a name="1109"><span class="lineNum">    1109 </span>            :             end if</a>
<a name="1110"><span class="lineNum">    1110 </span>            : #endif</a>
<a name="1111"><span class="lineNum">    1111 </span>            : </a>
<a name="1112"><span class="lineNum">    1112 </span><span class="lineNoCov">          0 :         elseif (shellis%windows) then blockDefineCommand ! either CMD or PowerShell: robocopy automatically generates new directories if needed.</span></a>
<a name="1113"><span class="lineNum">    1113 </span>            : </a>
<a name="1114"><span class="lineNum">    1114 </span>            :             ! LCOV_EXCL_START</a>
<a name="1115"><span class="lineNum">    1115 </span>            :             if (isDir(from)) then ! use robocopy.</a>
<a name="1116"><span class="lineNum">    1116 </span>            : </a>
<a name="1117"><span class="lineNum">    1117 </span>            :                 ! To get the linux `cp` behavior on Windows when `to` is an existing directory, we should create a new directory in `to` with the basename of `from`.</a>
<a name="1118"><span class="lineNum">    1118 </span>            :                 if (isDir(to)) then</a>
<a name="1119"><span class="lineNum">    1119 </span>            :                     paths = getPathVerbatimCMD(from)//SKC_&quot; &quot;//getPathVerbatimCMD(to//DSW//getBaseName(from, DSWA))</a>
<a name="1120"><span class="lineNum">    1120 </span>            :                 else</a>
<a name="1121"><span class="lineNum">    1121 </span>            :                     paths = getPathVerbatimCMD(from)//SKC_&quot; &quot;//getPathVerbatimCMD(to)</a>
<a name="1122"><span class="lineNum">    1122 </span>            :                 end if</a>
<a name="1123"><span class="lineNum">    1123 </span>            : </a>
<a name="1124"><span class="lineNum">    1124 </span>            :                 !   Robocopy flags:</a>
<a name="1125"><span class="lineNum">    1125 </span>            :                 !   /e          :   Copies subdirectories. This option automatically includes empty directories.</a>
<a name="1126"><span class="lineNum">    1126 </span>            :                 !   /r:&lt;n&gt;      :   Specifies the number of retries on failed copies. The default value of n is 1,000,000 (one million retries).</a>
<a name="1127"><span class="lineNum">    1127 </span>            :                 !   /w:&lt;n&gt;      :   Specifies the wait time between retries, in seconds. The default value of n is 30 (wait time 30 seconds).</a>
<a name="1128"><span class="lineNum">    1128 </span>            :                 !   /xc         :   Excludes changed files.</a>
<a name="1129"><span class="lineNum">    1129 </span>            :                 !   /xn         :   Excludes newer files.</a>
<a name="1130"><span class="lineNum">    1130 </span>            :                 !   /xo         :   Excludes older files.</a>
<a name="1131"><span class="lineNum">    1131 </span>            :                 !   /xc /xn /xo :   Does not overwrite existing files.</a>
<a name="1132"><span class="lineNum">    1132 </span>            :                 !   /is         :   Includes the same files. Same files are identical in name, size, times, and all attributes.</a>
<a name="1133"><span class="lineNum">    1133 </span>            :                 !   /move       :   Moves files and directories, and deletes them from the source after they are copied.</a>
<a name="1134"><span class="lineNum">    1134 </span>            : #if             isFailedMove_ENABLED</a>
<a name="1135"><span class="lineNum">    1135 </span>            :                 if (forced_def) then</a>
<a name="1136"><span class="lineNum">    1136 </span>            :                     command = SKC_&quot;robocopy &quot;//paths//SKC_&quot; /r:1 /w:1 /move /is         /e&quot;//SKC_&quot; &gt; nul&quot;</a>
<a name="1137"><span class="lineNum">    1137 </span>            :                 else</a>
<a name="1138"><span class="lineNum">    1138 </span>            :                     command = SKC_&quot;robocopy &quot;//paths//SKC_&quot; /r:1 /w:1 /move /xc /xn /xo /e&quot;//SKC_&quot; &gt; nul&quot;</a>
<a name="1139"><span class="lineNum">    1139 </span>            :                 end if</a>
<a name="1140"><span class="lineNum">    1140 </span>            : #elif           isFailedCopy_ENABLED</a>
<a name="1141"><span class="lineNum">    1141 </span>            :                 if (forced_def .and. recursive_def) then</a>
<a name="1142"><span class="lineNum">    1142 </span>            :                     command = SKC_&quot;robocopy &quot;//paths//SKC_&quot; /r:1 /w:1 /is         /e&quot;//SKC_&quot; &gt; nul&quot;</a>
<a name="1143"><span class="lineNum">    1143 </span>            :                 elseif (recursive_def) then</a>
<a name="1144"><span class="lineNum">    1144 </span>            :                     command = SKC_&quot;robocopy &quot;//paths//SKC_&quot; /r:1 /w:1 /xc /xn /xo /e&quot;//SKC_&quot; &gt; nul&quot;</a>
<a name="1145"><span class="lineNum">    1145 </span>            :                 elseif (forced_def) then</a>
<a name="1146"><span class="lineNum">    1146 </span>            :                     command = SKC_&quot;robocopy &quot;//paths//SKC_&quot; /r:1 /w:1 /is           &quot;//SKC_&quot; &gt; nul&quot;</a>
<a name="1147"><span class="lineNum">    1147 </span>            :                 else</a>
<a name="1148"><span class="lineNum">    1148 </span>            :                     command = SKC_&quot;robocopy &quot;//paths//SKC_&quot; /r:1 /w:1 /xc /xn /xo   &quot;//SKC_&quot; &gt; nul&quot;</a>
<a name="1149"><span class="lineNum">    1149 </span>            :                 end if</a>
<a name="1150"><span class="lineNum">    1150 </span>            : #endif</a>
<a name="1151"><span class="lineNum">    1151 </span>            : </a>
<a name="1152"><span class="lineNum">    1152 </span>            :             else! `from` must be a file. Use xcopy/move, which can handle files with nested destinations.</a>
<a name="1153"><span class="lineNum">    1153 </span>            : </a>
<a name="1154"><span class="lineNum">    1154 </span>            :                 if (.not. forced_def) then</a>
<a name="1155"><span class="lineNum">    1155 </span>            :                     if (isFile(to)) then</a>
<a name="1156"><span class="lineNum">    1156 </span>            :                         return ! Attempting to overwrite a single existing file. Nothing to do. Return.</a>
<a name="1157"><span class="lineNum">    1157 </span>            :                     elseif (isDir(to)) then</a>
<a name="1158"><span class="lineNum">    1158 </span>            :                         if (isFile(to//DSW//getBaseName(from, DSWA))) return ! Attempting to overwrite a single existing file whose directory is `to`. Nothing to do. Return.</a>
<a name="1159"><span class="lineNum">    1159 </span>            :                     end if</a>
<a name="1160"><span class="lineNum">    1160 </span>            :                 end if</a>
<a name="1161"><span class="lineNum">    1161 </span>            : </a>
<a name="1162"><span class="lineNum">    1162 </span>            :                 ! Rest assured; `to` is not an existing file. However, `to` may still be intended as a (potentially non-existing) directory if it ends with a directory separator.</a>
<a name="1163"><span class="lineNum">    1163 </span>            :                 ! If so, pipe D to xcopy/move indicate it is a directory.</a>
<a name="1164"><span class="lineNum">    1164 </span>            : </a>
<a name="1165"><span class="lineNum">    1165 </span>            :                 ! copy or xcopy flags:</a>
<a name="1166"><span class="lineNum">    1166 </span>            :                 ! /e Copies all (even empty) subdirectories.</a>
<a name="1167"><span class="lineNum">    1167 </span>            :                 ! /q Suppresses the display of xcopy messages.</a>
<a name="1168"><span class="lineNum">    1168 </span>            :                 ! /y Suppresses prompting to confirm that you want to overwrite an existing destination file (as if `forced = .true.`).</a>
<a name="1169"><span class="lineNum">    1169 </span>            :                 ! /s Copies directories and subdirectories, unless they are empty. If one omits /s, xcopy works within a single directory.</a>
<a name="1170"><span class="lineNum">    1170 </span>            :                 ! command = SKC_&quot;xcopy /e /q /s /Y &quot;//getPathVerbatimCMD(from)//SKC_&quot; &quot;//getPathVerbatimCMD(to)//SKC_&quot; &gt; nul&quot;</a>
<a name="1171"><span class="lineNum">    1171 </span>            : </a>
<a name="1172"><span class="lineNum">    1172 </span>            :                 itry = len(to, IK)</a>
<a name="1173"><span class="lineNum">    1173 </span>            :                 if (index(DSWA, to(itry:itry), kind = IK) &gt; 0_IK) then ! it must be a dir.</a>
<a name="1174"><span class="lineNum">    1174 </span>            :                     ! \warning</a>
<a name="1175"><span class="lineNum">    1175 </span>            :                     ! `xcopy` cannot automatically create (nested) folders that end with a forward slash (no problem with backward slash.</a>
<a name="1176"><span class="lineNum">    1176 </span>            :                     ! Therefore, a safer and faster way of creating the directory is to let xcopy do it, while ignoring the last character (which is a directory separator).</a>
<a name="1177"><span class="lineNum">    1177 </span>            :                     ! `echo D` pipes the response `directory` to the question of how to interpret `to` if there is ambiquity (e.g., if `to` does not end with directory separator).</a>
<a name="1178"><span class="lineNum">    1178 </span>            : #if                 isFailedMove_ENABLED</a>
<a name="1179"><span class="lineNum">    1179 </span>            :                     ! move can neither realize `to` is a directory (on powershell) nor create a (potentially nested) `to` folder (in either cmd or powershell). So create it.</a>
<a name="1180"><span class="lineNum">    1180 </span>            :                     failed = isFailedMakeDir(to, errmsg = errmsg)</a>
<a name="1181"><span class="lineNum">    1181 </span>            :                     if (failed) then; if (present(errmsg)) errmsg = PROCEDURE_NAME//SK_&quot;: &quot;//trim(errmsg); return; end if ! LCOV_EXCL_LINE</a>
<a name="1182"><span class="lineNum">    1182 </span>            : #elif               isFailedCopy_ENABLED</a>
<a name="1183"><span class="lineNum">    1183 </span>            :                     command = SKC_&quot;echo D | xcopy /q /y &quot;//getPathVerbatimCMD(from)//SKC_&quot; &quot;//getPathVerbatimCMD(to(1:itry-1))//SKC_&quot; &gt; nul&quot;</a>
<a name="1184"><span class="lineNum">    1184 </span>            :                 else</a>
<a name="1185"><span class="lineNum">    1185 </span>            :                     ! `to` must be a file. So no problemino.</a>
<a name="1186"><span class="lineNum">    1186 </span>            :                     ! `echo F` pipes the response `file` to the question of how to interpret `to` if there is ambiquity (e.g., if `to` does not end with directory separator).</a>
<a name="1187"><span class="lineNum">    1187 </span>            :                     command = SKC_&quot;echo F | xcopy /q /y &quot;//getPathVerbatimCMD(from)//SKC_&quot; &quot;//getPathVerbatimCMD(to)//SKC_&quot; &gt; nul&quot;</a>
<a name="1188"><span class="lineNum">    1188 </span>            : #endif</a>
<a name="1189"><span class="lineNum">    1189 </span>            :                 end if</a>
<a name="1190"><span class="lineNum">    1190 </span>            : </a>
<a name="1191"><span class="lineNum">    1191 </span>            : #if             isFailedMove_ENABLED</a>
<a name="1192"><span class="lineNum">    1192 </span>            :                 if (shellis%cmd) then</a>
<a name="1193"><span class="lineNum">    1193 </span>            :                     command = SKC_&quot;move /y &quot;//getPathVerbatimCMD(from)//SKC_&quot; &quot;//getPathVerbatimCMD(to)//SKC_&quot; &gt; nul&quot;</a>
<a name="1194"><span class="lineNum">    1194 </span>            :                 elseif (shellis%powershell) then</a>
<a name="1195"><span class="lineNum">    1195 </span>            :                     command = SKC_&quot;move &quot;//getPathVerbatimCMD(from)//SKC_&quot; &quot;//getPathVerbatimCMD(to)//SKC_&quot; -Force &gt; nul&quot;</a>
<a name="1196"><span class="lineNum">    1196 </span>            :                 end if</a>
<a name="1197"><span class="lineNum">    1197 </span>            : #endif</a>
<a name="1198"><span class="lineNum">    1198 </span>            :             end if</a>
<a name="1199"><span class="lineNum">    1199 </span>            :             ! LCOV_EXCL_STOP</a>
<a name="1200"><span class="lineNum">    1200 </span>            : </a>
<a name="1201"><span class="lineNum">    1201 </span>            :         else blockDefineCommand</a>
<a name="1202"><span class="lineNum">    1202 </span>            : </a>
<a name="1203"><span class="lineNum">    1203 </span>            :             if (present(errmsg)) errmsg = PROCEDURE_NAME//SK_&quot;: Failed to fetch the runtime shell type.&quot;//LF//trim(errmsg) ! LCOV_EXCL_LINE</a>
<a name="1204"><span class="lineNum">    1204 </span>            :             failed = .true._LK ! LCOV_EXCL_LINE</a>
<a name="1205"><span class="lineNum">    1205 </span>            :             return ! LCOV_EXCL_LINE</a>
<a name="1206"><span class="lineNum">    1206 </span>            : </a>
<a name="1207"><span class="lineNum">    1207 </span>            :         end if blockDefineCommand</a>
<a name="1208"><span class="lineNum">    1208 </span>            : </a>
<a name="1209"><span class="lineNum">    1209 </span>            :         ! Attempt repeatedly to copy/move the file.</a>
<a name="1210"><span class="lineNum">    1210 </span>            : </a>
<a name="1211"><span class="lineNum">    1211 </span><span class="lineCov">         35 :         if (present(ntry)) then</span></a>
<a name="1212"><span class="lineNum">    1212 </span><span class="lineNoCov">          0 :             CHECK_ASSERTION(__LINE__, 0_IK &lt; ntry, PROCEDURE_NAME//SK_&quot;: The condition `0 &lt; ntry` must hold. ntry = &quot;//getStr(ntry))</span></a>
<a name="1213"><span class="lineNum">    1213 </span><span class="lineNoCov">          0 :             ntry_def = ntry</span></a>
<a name="1214"><span class="lineNum">    1214 </span>            :         else</a>
<a name="1215"><span class="lineNum">    1215 </span><span class="lineCov">         35 :             ntry_def = 1_IK</span></a>
<a name="1216"><span class="lineNum">    1216 </span>            :         end if</a>
<a name="1217"><span class="lineNum">    1217 </span>            : </a>
<a name="1218"><span class="lineNum">    1218 </span><span class="lineCov">         35 :         if (present(wait)) then</span></a>
<a name="1219"><span class="lineNum">    1219 </span><span class="lineNoCov">          0 :             wait_def = wait</span></a>
<a name="1220"><span class="lineNum">    1220 </span>            :         else</a>
<a name="1221"><span class="lineNum">    1221 </span><span class="lineCov">         35 :             wait_def = .true._LK</span></a>
<a name="1222"><span class="lineNum">    1222 </span>            :         end if</a>
<a name="1223"><span class="lineNum">    1223 </span>            : </a>
<a name="1224"><span class="lineNum">    1224 </span><span class="lineCov">         35 :         do itry = 1_IK, ntry_def</span></a>
<a name="1225"><span class="lineNum">    1225 </span><span class="lineCov">        105 :             failed = isFailedExec(command, wait = wait_def, cmdmsg = errmsg)</span></a>
<a name="1226"><span class="lineNum">    1226 </span>            :             !failed = wait_def .and. .not. isExtant(to)</a>
<a name="1227"><span class="lineNum">    1227 </span><span class="lineCov">         35 :             if (.not. failed) exit</span></a>
<a name="1228"><span class="lineNum">    1228 </span>            :         end do</a>
<a name="1229"><span class="lineNum">    1229 </span>            : </a>
<a name="1230"><span class="lineNum">    1230 </span><span class="lineCov">         35 :         if (failed .and. present(errmsg)) errmsg = PROCEDURE_NAME//SK_&quot;: Failed to accomplish task file after &quot;//getStr(ntry_def)//SK_&quot; attempts.&quot;//LF//trim(errmsg)</span></a>
<a name="1231"><span class="lineNum">    1231 </span>            : </a>
<a name="1232"><span class="lineNum">    1232 </span>            :         !   \warning do NOT remove.</a>
<a name="1233"><span class="lineNum">    1233 </span>            :         !   \bug gfortran with heap memory allocations fails to automatically deallocate on exit.</a>
<a name="1234"><span class="lineNum">    1234 </span><span class="lineCov">         35 :         deallocate(command)</span></a>
<a name="1235"><span class="lineNum">    1235 </span>            : </a>
<a name="1236"><span class="lineNum">    1236 </span>            :         !%%%%%%%%%%%%%%%%%%%%%</a>
<a name="1237"><span class="lineNum">    1237 </span>            : #elif   isFailedRemove_ENABLED</a>
<a name="1238"><span class="lineNum">    1238 </span>            :         !%%%%%%%%%%%%%%%%%%%%%</a>
<a name="1239"><span class="lineNum">    1239 </span>            : </a>
<a name="1240"><span class="lineNum">    1240 </span>            :         character(*, SK), parameter :: PROCEDURE_NAME = MODULE_NAME//&quot;@isFailedRemove()&quot;</a>
<a name="1241"><span class="lineNum">    1241 </span>            :         character(*,SKC), parameter :: LF = new_line(SKC_&quot;a&quot;)</a>
<a name="1242"><span class="lineNum">    1242 </span>            :         logical(LK) :: forced_def, recursive_def, wait_def</a>
<a name="1243"><span class="lineNum">    1243 </span>            :         character(:,SKC), allocatable :: command, cmdfull</a>
<a name="1244"><span class="lineNum">    1244 </span>            :         character(511, SK) :: errmsg_def</a>
<a name="1245"><span class="lineNum">    1245 </span>            :         integer(IK) :: i, itry, ntry_def</a>
<a name="1246"><span class="lineNum">    1246 </span>            :         integer(IK) :: iostat</a>
<a name="1247"><span class="lineNum">    1247 </span>            : </a>
<a name="1248"><span class="lineNum">    1248 </span><span class="lineCov">         74 :         errmsg_def = &quot;&quot;</span></a>
<a name="1249"><span class="lineNum">    1249 </span><span class="lineCov">         74 :         failed = .false.</span></a>
<a name="1250"><span class="lineNum">    1250 </span><span class="lineCov">         74 :         ntry_def = 1_IK</span></a>
<a name="1251"><span class="lineNum">    1251 </span><span class="lineCov">         74 :         wait_def = .true._LK</span></a>
<a name="1252"><span class="lineNum">    1252 </span>            :         forced_def = .false._LK</a>
<a name="1253"><span class="lineNum">    1253 </span>            :         recursive_def = .false._LK</a>
<a name="1254"><span class="lineNum">    1254 </span><span class="lineCov">         74 :         if (present(ntry)) ntry_def = ntry</span></a>
<a name="1255"><span class="lineNum">    1255 </span><span class="lineCov">         74 :         if (present(wait)) wait_def = wait</span></a>
<a name="1256"><span class="lineNum">    1256 </span><span class="lineCov">         74 :         if (present(forced)) forced_def = forced</span></a>
<a name="1257"><span class="lineNum">    1257 </span><span class="lineCov">         74 :         if (present(recursive)) recursive_def = recursive</span></a>
<a name="1258"><span class="lineNum">    1258 </span><span class="lineCov">         74 :         CHECK_ASSERTION(__LINE__, 0_IK &lt; ntry_def, PROCEDURE_NAME//SK_&quot;: The condition `0 &lt; ntry` must hold. ntry = &quot;//getStr(ntry_def))</span></a>
<a name="1259"><span class="lineNum">    1259 </span>            : </a>
<a name="1260"><span class="lineNum">    1260 </span>            :         ! non-existence is okay only if `forced` is `.true.`.</a>
<a name="1261"><span class="lineNum">    1261 </span>            : </a>
<a name="1262"><span class="lineNum">    1262 </span><span class="lineCov">         74 :         if (isFile(path)) then</span></a>
<a name="1263"><span class="lineNum">    1263 </span>            :             fileRemoval: block</a>
<a name="1264"><span class="lineNum">    1264 </span>            :                 logical(LK) :: opened</a>
<a name="1265"><span class="lineNum">    1265 </span>            :                 integer(IK) :: unit</a>
<a name="1266"><span class="lineNum">    1266 </span><span class="lineCov">         54 :                 inquire(file = path, opened = opened, number = unit, iostat = iostat, iomsg = errmsg_def)</span></a>
<a name="1267"><span class="lineNum">    1267 </span><span class="lineCov">         54 :                 if (iostat /= 0_IK) exit fileRemoval</span></a>
<a name="1268"><span class="lineNum">    1268 </span><span class="lineCov">         54 :                 if (.not. opened) then</span></a>
<a name="1269"><span class="lineNum">    1269 </span><span class="lineCov">         54 :                     open(newunit = unit, file = path, status = &quot;replace&quot;, iostat = iostat, iomsg = errmsg_def SHARED)</span></a>
<a name="1270"><span class="lineNum">    1270 </span><span class="lineCov">         54 :                     if (iostat /= 0_IK) exit fileRemoval</span></a>
<a name="1271"><span class="lineNum">    1271 </span>            :                 end if</a>
<a name="1272"><span class="lineNum">    1272 </span><span class="lineCov">         54 :                 do itry = 1, ntry_def</span></a>
<a name="1273"><span class="lineNum">    1273 </span><span class="lineCov">         54 :                     close(unit, status = &quot;delete&quot;, iostat = iostat, iomsg = errmsg_def)</span></a>
<a name="1274"><span class="lineNum">    1274 </span><span class="lineCov">         54 :                     if (iostat /= 0_IK) then</span></a>
<a name="1275"><span class="lineNum">    1275 </span><span class="lineNoCov">          0 :                         errmsg_def = SK_&quot;The `close(unit,status='delete')` statement failed. &quot;//trim(errmsg_def)</span></a>
<a name="1276"><span class="lineNum">    1276 </span><span class="lineNoCov">          0 :                         exit fileRemoval</span></a>
<a name="1277"><span class="lineNum">    1277 </span>            :                     end if</a>
<a name="1278"><span class="lineNum">    1278 </span><span class="lineCov">         54 :                     inquire(file = path, exist = failed, iostat = iostat, iomsg = errmsg_def)</span></a>
<a name="1279"><span class="lineNum">    1279 </span><span class="lineCov">         54 :                     if (iostat /= 0_IK) exit fileRemoval</span></a>
<a name="1280"><span class="lineNum">    1280 </span><span class="lineCov">         54 :                     failed = wait_def .and. failed</span></a>
<a name="1281"><span class="lineNum">    1281 </span><span class="lineCov">         54 :                     if (.not. failed) return</span></a>
<a name="1282"><span class="lineNum">    1282 </span>            :                 end do</a>
<a name="1283"><span class="lineNum">    1283 </span><span class="lineNoCov">          0 :                 errmsg_def = SK_&quot;: Failed to accomplish task file after &quot;//getStr(ntry_def)//SK_&quot; attempts.&quot;</span></a>
<a name="1284"><span class="lineNum">    1284 </span>            :             end block fileRemoval</a>
<a name="1285"><span class="lineNum">    1285 </span><span class="lineNoCov">          0 :             failed = .true._LK</span></a>
<a name="1286"><span class="lineNum">    1286 </span><span class="lineNoCov">          0 :             if (present(errmsg)) errmsg = PROCEDURE_NAME//SK_&quot;: &quot;//trim(errmsg_def)</span></a>
<a name="1287"><span class="lineNum">    1287 </span><span class="lineNoCov">          0 :             return</span></a>
<a name="1288"><span class="lineNum">    1288 </span>            :         end if</a>
<a name="1289"><span class="lineNum">    1289 </span>            : </a>
<a name="1290"><span class="lineNum">    1290 </span>            :         ! Remove possibly a directory or a pattern.</a>
<a name="1291"><span class="lineNum">    1291 </span>            :         ! Note that some commands like Windows CMD `rd` do not digest wildcards.</a>
<a name="1292"><span class="lineNum">    1292 </span>            :         ! As such a list of paths corresponding to the specified wildcards must be created first.</a>
<a name="1293"><span class="lineNum">    1293 </span>            : </a>
<a name="1294"><span class="lineNum">    1294 </span>            :         recursiveRemoval: block</a>
<a name="1295"><span class="lineNum">    1295 </span>            : </a>
<a name="1296"><span class="lineNum">    1296 </span>            :             type(shellis_type) :: shellis</a>
<a name="1297"><span class="lineNum">    1297 </span><span class="lineCov">         20 :             type(css_type), allocatable :: list(:), verbatim(:)</span></a>
<a name="1298"><span class="lineNum">    1298 </span>            : </a>
<a name="1299"><span class="lineNum">    1299 </span><span class="lineCov">         20 :             if (isDir(path)) then</span></a>
<a name="1300"><span class="lineNum">    1300 </span><span class="lineCov">         16 :                 list = [css_type(path)]</span></a>
<a name="1301"><span class="lineNum">    1301 </span>            :             else</a>
<a name="1302"><span class="lineNum">    1302 </span><span class="lineCov">         16 :                 failed = isFailedGlob(path, list, errmsg_def)</span></a>
<a name="1303"><span class="lineNum">    1303 </span><span class="lineCov">         16 :                 if (failed) exit recursiveRemoval</span></a>
<a name="1304"><span class="lineNum">    1304 </span><span class="lineCov">         16 :                 if (size(list, 1, IK) == 0_IK) then</span></a>
<a name="1305"><span class="lineNum">    1305 </span><span class="lineCov">          8 :                     failed = .not. forced_def</span></a>
<a name="1306"><span class="lineNum">    1306 </span><span class="lineCov">          8 :                     if (failed) then</span></a>
<a name="1307"><span class="lineNum">    1307 </span><span class="lineCov">          4 :                         errmsg_def = SK_&quot;The specified path does not match any file or directory. Set `forced = .true.` to gracefully ignore non-existing paths.&quot;</span></a>
<a name="1308"><span class="lineNum">    1308 </span><span class="lineCov">          4 :                         exit recursiveRemoval</span></a>
<a name="1309"><span class="lineNum">    1309 </span>            :                     else</a>
<a name="1310"><span class="lineNum">    1310 </span>            :                         return</a>
<a name="1311"><span class="lineNum">    1311 </span>            :                     end if</a>
<a name="1312"><span class="lineNum">    1312 </span>            :                 end if</a>
<a name="1313"><span class="lineNum">    1313 </span>            :             end if</a>
<a name="1314"><span class="lineNum">    1314 </span>            : </a>
<a name="1315"><span class="lineNum">    1315 </span>            :             ! Removing non-file paths requires `recursive` option to be `.true.`.</a>
<a name="1316"><span class="lineNum">    1316 </span>            : </a>
<a name="1317"><span class="lineNum">    1317 </span><span class="lineCov">         12 :             if (0_IK &lt; size(list, 1, IK) .and. .not. recursive_def) then</span></a>
<a name="1318"><span class="lineNum">    1318 </span><span class="lineNoCov">          0 :                 if (present(errmsg)) errmsg = PROCEDURE_NAME//SK_&quot;: Removing a directory or a set of paths matching a pattern requires setting the input argument `recursive = .true.`.&quot;</span></a>
<a name="1319"><span class="lineNum">    1319 </span><span class="lineNoCov">          0 :                 failed = .true._LK</span></a>
<a name="1320"><span class="lineNum">    1320 </span><span class="lineNoCov">          0 :                 return</span></a>
<a name="1321"><span class="lineNum">    1321 </span>            :             end if</a>
<a name="1322"><span class="lineNum">    1322 </span>            : </a>
<a name="1323"><span class="lineNum">    1323 </span><span class="lineCov">         12 :             shellis = shellis_type(failed, errmsg_def)</span></a>
<a name="1324"><span class="lineNum">    1324 </span><span class="lineCov">         12 :             call setResized(verbatim, size(list, 1, IK))</span></a>
<a name="1325"><span class="lineNum">    1325 </span>            : </a>
<a name="1326"><span class="lineNum">    1326 </span><span class="lineCov">         12 :             blockDefineCommand: if (shellis%posix .or. shellis%fish) then</span></a>
<a name="1327"><span class="lineNum">    1327 </span>            : </a>
<a name="1328"><span class="lineNum">    1328 </span><span class="lineCov">         28 :                 do i = 1, size(list, 1, IK)</span></a>
<a name="1329"><span class="lineNum">    1329 </span><span class="lineCov">         28 :                     if (shellis%powershell) then</span></a>
<a name="1330"><span class="lineNum">    1330 </span><span class="lineNoCov">          0 :                         verbatim(i)%val = getPathVerbatimPowerShell(list(i)%val)</span></a>
<a name="1331"><span class="lineNum">    1331 </span>            :                     else</a>
<a name="1332"><span class="lineNum">    1332 </span><span class="lineCov">         16 :                         verbatim(i)%val = getPathVerbatimPosix(list(i)%val)</span></a>
<a name="1333"><span class="lineNum">    1333 </span>            :                     end if</a>
<a name="1334"><span class="lineNum">    1334 </span>            :                 end do</a>
<a name="1335"><span class="lineNum">    1335 </span>            :                 !   -f, --force         :   ignore nonexistent files and arguments, never prompt.</a>
<a name="1336"><span class="lineNum">    1336 </span>            :                 !   -r, -R, --recursive :   remove directories and their contents recursively.</a>
<a name="1337"><span class="lineNum">    1337 </span><span class="lineCov">         12 :                 command = SKC_&quot;rm &quot;</span></a>
<a name="1338"><span class="lineNum">    1338 </span><span class="lineCov">         12 :                 if (forced_def) command = command//SKC_&quot;-f &quot;</span></a>
<a name="1339"><span class="lineNum">    1339 </span><span class="lineCov">         12 :                 if (recursive_def) command = command//SKC_&quot;-r &quot;</span></a>
<a name="1340"><span class="lineNum">    1340 </span>            : </a>
<a name="1341"><span class="lineNum">    1341 </span><span class="lineNoCov">          0 :             elseif (shellis%windows .and. shellis%cmd) then blockDefineCommand</span></a>
<a name="1342"><span class="lineNum">    1342 </span>            : </a>
<a name="1343"><span class="lineNum">    1343 </span><span class="lineNoCov">          0 :                 do i = 1, size(list, 1, IK)</span></a>
<a name="1344"><span class="lineNum">    1344 </span><span class="lineNoCov">          0 :                     verbatim(i)%val = getPathVerbatimCMD(list(i)%val)</span></a>
<a name="1345"><span class="lineNum">    1345 </span>            :                 end do</a>
<a name="1346"><span class="lineNum">    1346 </span>            :                 !   /Q  :   Quiet mode, do not ask if ok to remove a directory tree with /S.</a>
<a name="1347"><span class="lineNum">    1347 </span>            :                 !   /S  :   Removes all directories and files in the specified directory in addition to the directory itself. Used to remove a directory tree.</a>
<a name="1348"><span class="lineNum">    1348 </span><span class="lineNoCov">          0 :                 command = SKC_&quot;rd &quot;</span></a>
<a name="1349"><span class="lineNum">    1349 </span><span class="lineNoCov">          0 :                 if (forced_def) command = command//SKC_&quot;/Q &quot;</span></a>
<a name="1350"><span class="lineNum">    1350 </span><span class="lineNoCov">          0 :                 if (recursive_def) command = command//SKC_&quot;/S &quot;</span></a>
<a name="1351"><span class="lineNum">    1351 </span>            : </a>
<a name="1352"><span class="lineNum">    1352 </span><span class="lineNoCov">          0 :             elseif (shellis%windows .and. shellis%powershell) then blockDefineCommand</span></a>
<a name="1353"><span class="lineNum">    1353 </span>            : </a>
<a name="1354"><span class="lineNum">    1354 </span><span class="lineNoCov">          0 :                 do i = 1, size(list, 1, IK)</span></a>
<a name="1355"><span class="lineNum">    1355 </span><span class="lineNoCov">          0 :                     verbatim(i)%val = getPathVerbatimPowerShell(list(i)%val)</span></a>
<a name="1356"><span class="lineNum">    1356 </span>            :                 end do</a>
<a name="1357"><span class="lineNum">    1357 </span>            :                 !   -Force      :   Forces the cmdlet to remove items that can't otherwise be changed, such as hidden or read-only files or read-only aliases or variables.</a>
<a name="1358"><span class="lineNum">    1358 </span>            :                 !   -Recurse    :   Indicates that this cmdlet deletes the items in the specified locations and in all child items of the locations.</a>
<a name="1359"><span class="lineNum">    1359 </span>            :                 !                   The Recurse parameter might not delete all subfolders or all child items. This is a known issue.</a>
<a name="1360"><span class="lineNum">    1360 </span><span class="lineNoCov">          0 :                 command = SKC_&quot;Remove-Item &quot;</span></a>
<a name="1361"><span class="lineNum">    1361 </span><span class="lineNoCov">          0 :                 if (forced_def) command = command//SKC_&quot;-Force &quot;</span></a>
<a name="1362"><span class="lineNum">    1362 </span><span class="lineNoCov">          0 :                 if (recursive_def) command = command//SKC_&quot;-Recurse &quot;</span></a>
<a name="1363"><span class="lineNum">    1363 </span>            : </a>
<a name="1364"><span class="lineNum">    1364 </span>            :             else blockDefineCommand</a>
<a name="1365"><span class="lineNum">    1365 </span>            : </a>
<a name="1366"><span class="lineNum">    1366 </span>            :                 errmsg_def = SK_&quot;: Failed to fetch the runtime shell type.&quot;//LF//trim(errmsg) ! LCOV_EXCL_LINE</a>
<a name="1367"><span class="lineNum">    1367 </span><span class="lineNoCov">          0 :                 exit recursiveRemoval</span></a>
<a name="1368"><span class="lineNum">    1368 </span>            : </a>
<a name="1369"><span class="lineNum">    1369 </span>            :             end if blockDefineCommand</a>
<a name="1370"><span class="lineNum">    1370 </span>            : </a>
<a name="1371"><span class="lineNum">    1371 </span>            :             ! Remove paths recursively.</a>
<a name="1372"><span class="lineNum">    1372 </span>            : </a>
<a name="1373"><span class="lineNum">    1373 </span><span class="lineCov">         28 :             loopOverPath: do i = 1, size(list, 1, IK)</span></a>
<a name="1374"><span class="lineNum">    1374 </span><span class="lineCov">         16 :                 cmdfull = command//verbatim(i)%val</span></a>
<a name="1375"><span class="lineNum">    1375 </span><span class="lineCov">         16 :                 do itry = 1, ntry_def</span></a>
<a name="1376"><span class="lineNum">    1376 </span><span class="lineCov">         16 :                     failed = isFailedExec(cmdfull, wait = wait_def, cmdmsg = errmsg_def)</span></a>
<a name="1377"><span class="lineNum">    1377 </span><span class="lineCov">         16 :                     inquire(file = list(i)%val, exist = failed, iostat = iostat, iomsg = errmsg_def)</span></a>
<a name="1378"><span class="lineNum">    1378 </span><span class="lineCov">         16 :                     if (iostat /= 0_IK) exit recursiveRemoval</span></a>
<a name="1379"><span class="lineNum">    1379 </span><span class="lineCov">         16 :                     failed = wait_def .and. failed</span></a>
<a name="1380"><span class="lineNum">    1380 </span><span class="lineCov">         16 :                     if (.not. failed) cycle loopOverPath</span></a>
<a name="1381"><span class="lineNum">    1381 </span>            :                 end do</a>
<a name="1382"><span class="lineNum">    1382 </span><span class="lineNoCov">          0 :                 errmsg_def = SK_&quot;: Failed to accomplish remove path '&quot;//list(i)%val//SK_&quot;' after &quot;//getStr(ntry_def)//SK_&quot; attempts.&quot;</span></a>
<a name="1383"><span class="lineNum">    1383 </span><span class="lineCov">         28 :                 exit recursiveRemoval</span></a>
<a name="1384"><span class="lineNum">    1384 </span>            :             end do loopOverPath</a>
<a name="1385"><span class="lineNum">    1385 </span>            : </a>
<a name="1386"><span class="lineNum">    1386 </span><span class="lineCov">         52 :             return</span></a>
<a name="1387"><span class="lineNum">    1387 </span>            : </a>
<a name="1388"><span class="lineNum">    1388 </span>            :         end block recursiveRemoval</a>
<a name="1389"><span class="lineNum">    1389 </span>            : </a>
<a name="1390"><span class="lineNum">    1390 </span><span class="lineCov">          4 :         if (present(errmsg)) errmsg = PROCEDURE_NAME//SK_&quot;: &quot;//trim(errmsg_def)</span></a>
<a name="1391"><span class="lineNum">    1391 </span>            :         failed = .true._LK</a>
<a name="1392"><span class="lineNum">    1392 </span>            : </a>
<a name="1393"><span class="lineNum">    1393 </span>            :         !%%%%%%%%%%%%%%%%%%%</a>
<a name="1394"><span class="lineNum">    1394 </span>            : #elif   getPathMatch_ENABLED</a>
<a name="1395"><span class="lineNum">    1395 </span>            :         !%%%%%%%%%%%%%%%%%%%</a>
<a name="1396"><span class="lineNum">    1396 </span>            : </a>
<a name="1397"><span class="lineNum">    1397 </span>            :         use pm_err, only: getFine</a>
<a name="1398"><span class="lineNum">    1398 </span>            :         integer(IK) :: lenList</a>
<a name="1399"><span class="lineNum">    1399 </span>            :         logical(LK) :: failed_def</a>
<a name="1400"><span class="lineNum">    1400 </span>            :         character(:,SKC), allocatable :: key_def, inc_def, sep_def, paths</a>
<a name="1401"><span class="lineNum">    1401 </span><span class="lineCov">         32 :         if (present(failed)) failed = .false._LK</span></a>
<a name="1402"><span class="lineNum">    1402 </span><span class="lineCov">         32 :         if (present(key)) then</span></a>
<a name="1403"><span class="lineNum">    1403 </span><span class="lineCov">         28 :             key_def = key</span></a>
<a name="1404"><span class="lineNum">    1404 </span>            :         else</a>
<a name="1405"><span class="lineNum">    1405 </span><span class="lineCov">          4 :             key_def = &quot;&quot;</span></a>
<a name="1406"><span class="lineNum">    1406 </span>            :         endif</a>
<a name="1407"><span class="lineNum">    1407 </span><span class="lineCov">         32 :         if (present(inc)) then</span></a>
<a name="1408"><span class="lineNum">    1408 </span><span class="lineCov">          8 :             inc_def = inc</span></a>
<a name="1409"><span class="lineNum">    1409 </span>            :         else</a>
<a name="1410"><span class="lineNum">    1410 </span><span class="lineCov">         24 :             inc_def = &quot;&quot;</span></a>
<a name="1411"><span class="lineNum">    1411 </span>            :         endif</a>
<a name="1412"><span class="lineNum">    1412 </span><span class="lineCov">         32 :         if (present(sep)) then</span></a>
<a name="1413"><span class="lineNum">    1413 </span><span class="lineCov">         20 :             sep_def = sep</span></a>
<a name="1414"><span class="lineNum">    1414 </span>            :         else</a>
<a name="1415"><span class="lineNum">    1415 </span><span class="lineCov">         36 :             sep_def = getPathSep(failed = failed_def, errmsg = errmsg)</span></a>
<a name="1416"><span class="lineNum">    1416 </span><span class="lineCov">         12 :             if (failed_def) then</span></a>
<a name="1417"><span class="lineNum">    1417 </span><span class="lineNoCov">          0 :                 if (present(failed)) then</span></a>
<a name="1418"><span class="lineNum">    1418 </span><span class="lineNoCov">          0 :                     if (present(errmsg)) errmsg = getFine(__FILE__, __LINE__)//MODULE_NAME//&quot;@getPathMatch(): Failed to infer the path separator character. &quot;//trim(errmsg)</span></a>
<a name="1419"><span class="lineNum">    1419 </span><span class="lineNoCov">          0 :                     call setResized(list, 0_IK)</span></a>
<a name="1420"><span class="lineNum">    1420 </span><span class="lineNoCov">          0 :                     failed = failed_def</span></a>
<a name="1421"><span class="lineNum">    1421 </span><span class="lineNoCov">          0 :                     return</span></a>
<a name="1422"><span class="lineNum">    1422 </span>            :                 else</a>
<a name="1423"><span class="lineNum">    1423 </span><span class="lineNoCov">          0 :                     error stop getFine(__FILE__, __LINE__)//MODULE_NAME//&quot;@getPathMatch(): Failed to infer the path separator character. &quot;//trim(errmsg)</span></a>
<a name="1424"><span class="lineNum">    1424 </span>            :                 end if</a>
<a name="1425"><span class="lineNum">    1425 </span>            :             end if</a>
<a name="1426"><span class="lineNum">    1426 </span>            :         endif</a>
<a name="1427"><span class="lineNum">    1427 </span><span class="lineCov">         32 :         lenList = 4095_IK</span></a>
<a name="1428"><span class="lineNum">    1428 </span><span class="lineNoCov">          0 :         do</span></a>
<a name="1429"><span class="lineNum">    1429 </span><span class="lineCov">     131072 :             paths = repeat(&quot; &quot;, lenList)</span></a>
<a name="1430"><span class="lineNum">    1430 </span><span class="lineCov">         32 :             call setPathMatch(key_def, inc_def, sep_def, paths, lenList)</span></a>
<a name="1431"><span class="lineNum">    1431 </span><span class="lineCov">         32 :             if (len(paths, IK) &lt; abs(lenList)) then</span></a>
<a name="1432"><span class="lineNum">    1432 </span><span class="lineNoCov">          0 :                 lenList = abs(lenList)</span></a>
<a name="1433"><span class="lineNum">    1433 </span>            :                 cycle</a>
<a name="1434"><span class="lineNum">    1434 </span><span class="lineCov">         32 :             elseif (0_IK &lt;= lenList) then</span></a>
<a name="1435"><span class="lineNum">    1435 </span><span class="lineCov">         32 :                 call setSplit(list, paths(1 : lenList), sep_def)</span></a>
<a name="1436"><span class="lineNum">    1436 </span>            :                 exit</a>
<a name="1437"><span class="lineNum">    1437 </span><span class="lineNoCov">          0 :             elseif (present(failed)) then</span></a>
<a name="1438"><span class="lineNum">    1438 </span><span class="lineNoCov">          0 :                 if (present(errmsg)) errmsg = getFine(__FILE__, __LINE__)//MODULE_NAME//&quot;@getPathMatch(): Failed to detect paths. &quot;//trim(errmsg)</span></a>
<a name="1439"><span class="lineNum">    1439 </span><span class="lineNoCov">          0 :                 call setResized(list, 0_IK)</span></a>
<a name="1440"><span class="lineNum">    1440 </span><span class="lineNoCov">          0 :                 failed = .true._LK</span></a>
<a name="1441"><span class="lineNum">    1441 </span><span class="lineNoCov">          0 :                 return</span></a>
<a name="1442"><span class="lineNum">    1442 </span>            :             else</a>
<a name="1443"><span class="lineNum">    1443 </span><span class="lineNoCov">          0 :                 error stop getFine(__FILE__, __LINE__)//MODULE_NAME//&quot;@getPathMatch(): Failed to infer the path separator character. &quot;//trim(errmsg)</span></a>
<a name="1444"><span class="lineNum">    1444 </span>            :             end if</a>
<a name="1445"><span class="lineNum">    1445 </span>            :         end do</a>
<a name="1446"><span class="lineNum">    1446 </span>            : </a>
<a name="1447"><span class="lineNum">    1447 </span>            :         !%%%%%%%%%%%%%%%%%%%</a>
<a name="1448"><span class="lineNum">    1448 </span>            : #elif   setPathMatch_ENABLED</a>
<a name="1449"><span class="lineNum">    1449 </span>            :         !%%%%%%%%%%%%%%%%%%%</a>
<a name="1450"><span class="lineNum">    1450 </span>            : </a>
<a name="1451"><span class="lineNum">    1451 </span>            :         integer(IK) :: ipath, lenkey, leninc, item, lenout, lenListInput, istart</a>
<a name="1452"><span class="lineNum">    1452 </span>            :         logical(LK) :: isall, found, failed</a>
<a name="1453"><span class="lineNum">    1453 </span>            :         character(255,SKC) :: errmsg</a>
<a name="1454"><span class="lineNum">    1454 </span>            :         character(1,SKC) :: pathsep</a>
<a name="1455"><span class="lineNum">    1455 </span>            :         !integer(IK), allocatable :: cindex(:,:)</a>
<a name="1456"><span class="lineNum">    1456 </span>            :         !integer(IK), allocatable :: kindex(:,:)</a>
<a name="1457"><span class="lineNum">    1457 </span><span class="lineCov">         44 :         type(css_type), allocatable :: csskey(:)</span></a>
<a name="1458"><span class="lineNum">    1458 </span><span class="lineCov">         44 :         type(css_type), allocatable :: inclist(:)</span></a>
<a name="1459"><span class="lineNum">    1459 </span><span class="lineCov">         44 :         type(css_type), allocatable :: csspath(:)</span></a>
<a name="1460"><span class="lineNum">    1460 </span><span class="lineCov">         44 :         character(:,SKC), allocatable :: contents, lower, inclow</span></a>
<a name="1461"><span class="lineNum">    1461 </span><span class="lineCov">         44 :         CHECK_ASSERTION(__LINE__, 0_IK &lt; lenList, SK_&quot;@setPathMatch(): The condition `0 &lt; lenList` must hold. lenList = &quot;//getStr(lenList))</span></a>
<a name="1462"><span class="lineNum">    1462 </span><span class="lineCov">         44 :         CHECK_ASSERTION(__LINE__, 0_IK &lt; len_trim(sep), SK_&quot;@setPathMatch(): The condition `0 &lt; len_trim(sep)` must hold. len_trim(sep) = &quot;//getStr(len_trim(sep)))</span></a>
<a name="1463"><span class="lineNum">    1463 </span><span class="lineCov">         44 :         lenListInput = lenList ! Keep a copy of the input value.</span></a>
<a name="1464"><span class="lineNum">    1464 </span><span class="lineCov">         44 :         errmsg = &quot;&quot;</span></a>
<a name="1465"><span class="lineNum">    1465 </span>            : </a>
<a name="1466"><span class="lineNum">    1466 </span>            :         ! First search the PATH env variable.</a>
<a name="1467"><span class="lineNum">    1467 </span>            : </a>
<a name="1468"><span class="lineNum">    1468 </span>            :         success: block</a>
<a name="1469"><span class="lineNum">    1469 </span><span class="lineCov">         44 :             failed = isFailedGetEnvVar(&quot;PATH&quot;, contents, errmsg)</span></a>
<a name="1470"><span class="lineNum">    1470 </span><span class="lineCov">         44 :             if (failed) exit success</span></a>
<a name="1471"><span class="lineNum">    1471 </span><span class="lineCov">         44 :             pathsep = getPathSep(failed, errmsg)</span></a>
<a name="1472"><span class="lineNum">    1472 </span><span class="lineCov">         44 :             if (.not. failed) then</span></a>
<a name="1473"><span class="lineNum">    1473 </span>            : #if             FORTRAN_ENABLED</a>
<a name="1474"><span class="lineNum">    1474 </span><span class="lineCov">         44 :                 leninc = len(inc, IK)</span></a>
<a name="1475"><span class="lineNum">    1475 </span><span class="lineCov">         44 :                 lenkey = len(key, IK)</span></a>
<a name="1476"><span class="lineNum">    1476 </span>            : #else</a>
<a name="1477"><span class="lineNum">    1477 </span>            :                 lenkey = 1_IK</a>
<a name="1478"><span class="lineNum">    1478 </span>            :                 do</a>
<a name="1479"><span class="lineNum">    1479 </span>            :                     if (key(lenkey : lenkey) == c_null_char) exit</a>
<a name="1480"><span class="lineNum">    1480 </span>            :                     lenkey = lenkey + 1_IK</a>
<a name="1481"><span class="lineNum">    1481 </span>            :                 end do</a>
<a name="1482"><span class="lineNum">    1482 </span>            :                 lenkey = lenkey - 1_IK</a>
<a name="1483"><span class="lineNum">    1483 </span>            :                 leninc = 1_IK</a>
<a name="1484"><span class="lineNum">    1484 </span>            :                 do</a>
<a name="1485"><span class="lineNum">    1485 </span>            :                     if (inc(leninc : leninc) == c_null_char) exit</a>
<a name="1486"><span class="lineNum">    1486 </span>            :                     leninc = leninc + 1_IK</a>
<a name="1487"><span class="lineNum">    1487 </span>            :                 end do</a>
<a name="1488"><span class="lineNum">    1488 </span>            :                 leninc = leninc - 1_IK</a>
<a name="1489"><span class="lineNum">    1489 </span>            : #endif</a>
<a name="1490"><span class="lineNum">    1490 </span><span class="lineCov">         44 :                 lenList = 0_IK</span></a>
<a name="1491"><span class="lineNum">    1491 </span><span class="lineCov">         44 :                 if (0_IK &lt; leninc) inclow = getStrLower(inc(1 : leninc))</span></a>
<a name="1492"><span class="lineNum">    1492 </span><span class="lineCov">         44 :                 call setSplit(csskey, getStrLower(key(1 : lenkey)), sep)</span></a>
<a name="1493"><span class="lineNum">    1493 </span><span class="lineCov">         44 :                 isall = 0_IK == size(csskey, 1, IK)</span></a>
<a name="1494"><span class="lineNum">    1494 </span><span class="lineCov">         44 :                 if (.not. isall) then</span></a>
<a name="1495"><span class="lineNum">    1495 </span><span class="lineCov">         44 :                     call setSplit(csspath, contents, pathsep)</span></a>
<a name="1496"><span class="lineNum">    1496 </span><span class="lineCov">         44 :                     isall = 0_IK == size(csspath, 1, IK)</span></a>
<a name="1497"><span class="lineNum">    1497 </span><span class="lineCov">       2728 :                     do ipath = 1, size(csspath, 1, IK)</span></a>
<a name="1498"><span class="lineNum">    1498 </span><span class="lineCov">       2684 :                         lower = getStrLower(csspath(ipath)%val)</span></a>
<a name="1499"><span class="lineNum">    1499 </span>            :                         found = .true._LK</a>
<a name="1500"><span class="lineNum">    1500 </span><span class="lineCov">       4692 :                         do item = 1, size(csskey, 1, IK)</span></a>
<a name="1501"><span class="lineNum">    1501 </span><span class="lineCov">       3496 :                             found = 0 &lt; index(lower, csskey(item)%val)</span></a>
<a name="1502"><span class="lineNum">    1502 </span><span class="lineCov">       4692 :                             if (.not. found) exit</span></a>
<a name="1503"><span class="lineNum">    1503 </span>            :                         end do</a>
<a name="1504"><span class="lineNum">    1504 </span><span class="lineCov">       2728 :                         if (found) then</span></a>
<a name="1505"><span class="lineNum">    1505 </span>            :                             ! Add the path only if the `inc` is also present.</a>
<a name="1506"><span class="lineNum">    1506 </span><span class="lineCov">       1196 :                             found = 0_IK == leninc</span></a>
<a name="1507"><span class="lineNum">    1507 </span><span class="lineCov">       1196 :                             if (.not. found) then</span></a>
<a name="1508"><span class="lineNum">    1508 </span><span class="lineCov">       1096 :                                 failed = isFailedList(csspath(ipath)%val, inclist, errmsg = errmsg)</span></a>
<a name="1509"><span class="lineNum">    1509 </span><span class="lineCov">        232 :                                 if (failed) exit success</span></a>
<a name="1510"><span class="lineNum">    1510 </span><span class="lineCov">       1072 :                                 do item = 1, size(inclist, 1, IK)</span></a>
<a name="1511"><span class="lineNum">    1511 </span><span class="lineCov">        856 :                                     found = 0 &lt; index(getStrLower(inclist(item)%val), inclow)</span></a>
<a name="1512"><span class="lineNum">    1512 </span><span class="lineCov">       1072 :                                     if (found) exit</span></a>
<a name="1513"><span class="lineNum">    1513 </span>            :                                 end do</a>
<a name="1514"><span class="lineNum">    1514 </span>            :                             end if</a>
<a name="1515"><span class="lineNum">    1515 </span><span class="lineCov">       1196 :                             if (found) then</span></a>
<a name="1516"><span class="lineNum">    1516 </span>            :                                 ! Add the separator.</a>
<a name="1517"><span class="lineNum">    1517 </span><span class="lineCov">        980 :                                 if (0_IK &lt; lenList) then</span></a>
<a name="1518"><span class="lineNum">    1518 </span><span class="lineCov">        948 :                                     if (lenList + 1 &lt;= lenListInput) list(lenList + 1 : lenList + 1) = sep</span></a>
<a name="1519"><span class="lineNum">    1519 </span><span class="lineCov">        948 :                                     lenList = lenList + 1_IK</span></a>
<a name="1520"><span class="lineNum">    1520 </span>            :                                 end if</a>
<a name="1521"><span class="lineNum">    1521 </span>            :                                 ! Add the path.</a>
<a name="1522"><span class="lineNum">    1522 </span><span class="lineCov">        980 :                                 if (lenList + len(lower, IK) &lt;= lenListInput) list(lenList + 1 : lenList + len(lower, IK)) = csspath(ipath)%val</span></a>
<a name="1523"><span class="lineNum">    1523 </span><span class="lineCov">        980 :                                 lenList = lenList + len(lower, IK)</span></a>
<a name="1524"><span class="lineNum">    1524 </span>            :                             end if</a>
<a name="1525"><span class="lineNum">    1525 </span>            :                         end if</a>
<a name="1526"><span class="lineNum">    1526 </span>            :                     end do</a>
<a name="1527"><span class="lineNum">    1527 </span>            :                 end if</a>
<a name="1528"><span class="lineNum">    1528 </span><span class="lineCov">         44 :                 if (isall) then</span></a>
<a name="1529"><span class="lineNum">    1529 </span><span class="lineNoCov">          0 :                     call setReplaced(contents, pathsep, sep)</span></a>
<a name="1530"><span class="lineNum">    1530 </span><span class="lineNoCov">          0 :                     lenout = len_trim(contents)</span></a>
<a name="1531"><span class="lineNum">    1531 </span><span class="lineNoCov">          0 :                     lenList = min(lenout, lenListInput)</span></a>
<a name="1532"><span class="lineNum">    1532 </span><span class="lineNoCov">          0 :                     list(1 : lenList) = contents(1 : lenList)</span></a>
<a name="1533"><span class="lineNum">    1533 </span><span class="lineNoCov">          0 :                     lenList = merge(lenout, lenList, lenListInput &lt; lenout)</span></a>
<a name="1534"><span class="lineNum">    1534 </span>            :                 end if</a>
<a name="1535"><span class="lineNum">    1535 </span>            :             end if</a>
<a name="1536"><span class="lineNum">    1536 </span>            : </a>
<a name="1537"><span class="lineNum">    1537 </span><span class="lineCov">         44 :             if (isDarwin()) then</span></a>
<a name="1538"><span class="lineNum">    1538 </span><span class="lineNoCov">          0 :                 failed = isFailedGetOutput(SK_&quot;system_profiler SPApplicationsDataType&quot;, contents, errmsg)!, exitstat = exitstat)</span></a>
<a name="1539"><span class="lineNum">    1539 </span><span class="lineNoCov">          0 :                 if (failed) exit success</span></a>
<a name="1540"><span class="lineNum">    1540 </span>            :                 ! The following is the typical output of the command:</a>
<a name="1541"><span class="lineNum">    1541 </span>            :                 !</a>
<a name="1542"><span class="lineNum">    1542 </span>            :                 !    MATLAB_R2019a:</a>
<a name="1543"><span class="lineNum">    1543 </span>            :                 !</a>
<a name="1544"><span class="lineNum">    1544 </span>            :                 !          Version: R2019a (9.6.0)</a>
<a name="1545"><span class="lineNum">    1545 </span>            :                 !          Obtained from: Unknown</a>
<a name="1546"><span class="lineNum">    1546 </span>            :                 !          Last Modified: 6/18/21, 2:15 AM</a>
<a name="1547"><span class="lineNum">    1547 </span>            :                 !          Location: /Applications/MATLAB_R2019a.inc</a>
<a name="1548"><span class="lineNum">    1548 </span>            :                 !          Kind: 64-bit</a>
<a name="1549"><span class="lineNum">    1549 </span>            :                 !</a>
<a name="1550"><span class="lineNum">    1550 </span>            :                 ! We search for all instances of lines matching &quot;Location: &quot; and the input keys.</a>
<a name="1551"><span class="lineNum">    1551 </span><span class="lineNoCov">          0 :                 call setSplit(csspath, contents, new_line(SKC_&quot;&quot;))</span></a>
<a name="1552"><span class="lineNum">    1552 </span><span class="lineNoCov">          0 :                 do ipath = 1, size(csspath, 1, IK)</span></a>
<a name="1553"><span class="lineNum">    1553 </span><span class="lineNoCov">          0 :                     istart = index(csspath(ipath)%val, SK_&quot;Location: &quot;, kind = IK)</span></a>
<a name="1554"><span class="lineNum">    1554 </span><span class="lineNoCov">          0 :                     if (0 &lt; istart) then</span></a>
<a name="1555"><span class="lineNum">    1555 </span><span class="lineNoCov">          0 :                         istart = istart + 10_IK</span></a>
<a name="1556"><span class="lineNum">    1556 </span><span class="lineNoCov">          0 :                         lower = getStrLower(csspath(ipath)%val(istart :))</span></a>
<a name="1557"><span class="lineNum">    1557 </span>            :                         found = .true._LK</a>
<a name="1558"><span class="lineNum">    1558 </span><span class="lineNoCov">          0 :                         do item = 1, size(csskey, 1, IK)</span></a>
<a name="1559"><span class="lineNum">    1559 </span><span class="lineNoCov">          0 :                             found = 0 &lt; index(lower, csskey(item)%val)</span></a>
<a name="1560"><span class="lineNum">    1560 </span><span class="lineNoCov">          0 :                             if (.not. found) exit</span></a>
<a name="1561"><span class="lineNum">    1561 </span>            :                         end do</a>
<a name="1562"><span class="lineNum">    1562 </span><span class="lineNoCov">          0 :                         if (found) then</span></a>
<a name="1563"><span class="lineNum">    1563 </span>            :                             ! Add the path only if the `inc` is also present.</a>
<a name="1564"><span class="lineNum">    1564 </span><span class="lineNoCov">          0 :                             found = 0_IK == leninc</span></a>
<a name="1565"><span class="lineNum">    1565 </span><span class="lineNoCov">          0 :                             if (.not. found) then</span></a>
<a name="1566"><span class="lineNum">    1566 </span><span class="lineNoCov">          0 :                                 failed = isFailedList(csspath(ipath)%val(istart :), inclist, errmsg = errmsg)</span></a>
<a name="1567"><span class="lineNum">    1567 </span><span class="lineNoCov">          0 :                                 if (failed) exit success</span></a>
<a name="1568"><span class="lineNum">    1568 </span><span class="lineNoCov">          0 :                                 do item = 1, size(inclist, 1, IK)</span></a>
<a name="1569"><span class="lineNum">    1569 </span><span class="lineNoCov">          0 :                                     found = 0 &lt; index(getStrLower(inclist(item)%val), inclow)</span></a>
<a name="1570"><span class="lineNum">    1570 </span><span class="lineNoCov">          0 :                                     if (found) exit</span></a>
<a name="1571"><span class="lineNum">    1571 </span>            :                                 end do</a>
<a name="1572"><span class="lineNum">    1572 </span>            :                             end if</a>
<a name="1573"><span class="lineNum">    1573 </span><span class="lineNoCov">          0 :                             if (found) then</span></a>
<a name="1574"><span class="lineNum">    1574 </span>            :                                 ! Add the separator.</a>
<a name="1575"><span class="lineNum">    1575 </span><span class="lineNoCov">          0 :                                 if (0_IK &lt; lenList) then</span></a>
<a name="1576"><span class="lineNum">    1576 </span><span class="lineNoCov">          0 :                                     if (lenList + 1 &lt;= lenListInput) list(lenList + 1 : lenList + 1) = sep</span></a>
<a name="1577"><span class="lineNum">    1577 </span><span class="lineNoCov">          0 :                                     lenList = lenList + 1_IK</span></a>
<a name="1578"><span class="lineNum">    1578 </span>            :                                 end if</a>
<a name="1579"><span class="lineNum">    1579 </span>            :                                 ! Add the path.</a>
<a name="1580"><span class="lineNum">    1580 </span><span class="lineNoCov">          0 :                                 if (lenList + len(lower, IK) &lt;= lenListInput) list(lenList + 1 : lenList + len(lower, IK)) = csspath(ipath)%val(istart :)</span></a>
<a name="1581"><span class="lineNum">    1581 </span><span class="lineNoCov">          0 :                                 lenList = lenList + len(lower, IK)</span></a>
<a name="1582"><span class="lineNum">    1582 </span>            :                             end if</a>
<a name="1583"><span class="lineNum">    1583 </span>            :                         end if</a>
<a name="1584"><span class="lineNum">    1584 </span>            :                     end if</a>
<a name="1585"><span class="lineNum">    1585 </span>            :                 end do</a>
<a name="1586"><span class="lineNum">    1586 </span>            :             end if</a>
<a name="1587"><span class="lineNum">    1587 </span>            : </a>
<a name="1588"><span class="lineNum">    1588 </span>            :         end block success</a>
<a name="1589"><span class="lineNum">    1589 </span>            : </a>
<a name="1590"><span class="lineNum">    1590 </span>            :         !if (isWindows() .or. isLinux()) then</a>
<a name="1591"><span class="lineNum">    1591 </span><span class="lineCov">         44 :         if (failed) then</span></a>
<a name="1592"><span class="lineNum">    1592 </span><span class="lineNoCov">          0 :             lenout = len_trim(errmsg)</span></a>
<a name="1593"><span class="lineNum">    1593 </span><span class="lineNoCov">          0 :             lenList = min(lenout, lenListInput)</span></a>
<a name="1594"><span class="lineNum">    1594 </span><span class="lineNoCov">          0 :             list(1 : lenList) = errmsg(1 : lenList)</span></a>
<a name="1595"><span class="lineNum">    1595 </span><span class="lineNoCov">          0 :             list(lenList + 1 : lenListInput) = &quot;&quot;</span></a>
<a name="1596"><span class="lineNum">    1596 </span><span class="lineNoCov">          0 :             lenList = -merge(lenout, lenList, lenListInput &lt; lenout)</span></a>
<a name="1597"><span class="lineNum">    1597 </span>            :         end if</a>
<a name="1598"><span class="lineNum">    1598 </span>            : #else</a>
<a name="1599"><span class="lineNum">    1599 </span>            :         !%%%%%%%%%%%%%%%%%%%%%%%%</a>
<a name="1600"><span class="lineNum">    1600 </span>            : #error  &quot;Unrecognized interface.&quot;</a>
<a name="1601"><span class="lineNum">    1601 </span>            :         !%%%%%%%%%%%%%%%%%%%%%%%%</a>
<a name="1602"><span class="lineNum">    1602 </span>            : #endif</a>
<a name="1603"><span class="lineNum">    1603 </span>            : #undef  SHARED</a>
</pre>
      </td>
    </tr>
  </table>
  <br>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="ruler"><img src="../glass.png" width=3 height=3 alt=""></td></tr>
<tr><td class="versionInfo"><a href="https://www.cdslab.org/paramonte"><b>ParaMonte: Parallel Monte Carlo and Machine Learning Library</b></a>&nbsp;<br><a href="https://www.cdslab.org" target="_blank"><b>The Computational Data Science Lab</b></a><br>&copy; Copyright 2012 - 2024</td></tr>
  </table>
  <br>

</body>
</html>
